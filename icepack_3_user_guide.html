
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>3. User Guide &#8212; CICE-Consortium Icepack 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. Developers Guide" href="icepack_4_developer_guide.html" />
    <link rel="prev" title="2. Science Guide" href="icepack_2_science_guide.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="icepack_4_developer_guide.html" title="4. Developers Guide"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="icepack_2_science_guide.html" title="2. Science Guide"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CICE-Consortium Icepack 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="user-guide">
<h1>3. User Guide<a class="headerlink" href="#user-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="implementation">
<h2>3.1. Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>Icepack is written in FORTRAN90 and runs on platforms using UNIX, LINUX,
and other operating systems. The code is not parallelized. (CHANGE IF OPENMP IS IMPLEMENTED)</p>
<p>Icepack consists of the sea ice column physics code, contained in the
<strong>columnphysics/</strong> directory, and a <strong>configuration/</strong> directory that includes
a driver for testing the column physics and a set of scripts for configuring the tests.
Icepack is designed such that the column physics code may be used by a host sea ice
model without direct reference to the driver or scripts, although these may be consulted for
guidance when coupling the column physics code to the host sea ice model
(<a class="reference external" href="https://github.com/CICE-Consortium/CICE">CICE</a> may also be useful for this.)  Information
about the interface between the column physics and the driver or host sea ice model is
located in the <a class="reference internal" href="#init"><span class="std std-ref">Initialization and Forcing</span></a> section.</p>
<div class="section" id="directory-structure">
<span id="dirstructure"></span><h3>3.1.1. Directory structure<a class="headerlink" href="#directory-structure" title="Permalink to this headline">¶</a></h3>
<p>The present code distribution includes source code for the column physics,
source code for the driver, and the scripts.  Forcing data is available from the ftp site.
The directory structure of Icepack is as follows.  All columnphysics filename have a prefix
of icepack_ and all driver files are prefixed with icedrv_*.</p>
<dl class="docutils">
<dt><strong>LICENSE.pdf</strong></dt>
<dd>license and policy for using and sharing the code</dd>
<dt><strong>DistributionPolicy.pdf</strong></dt>
<dd>license and policy for using and sharing the code</dd>
<dt><strong>README.md</strong></dt>
<dd>basic information and pointers</dd>
<dt><strong>columnphysics/</strong></dt>
<dd>directory for columnphysics source code, see <a class="reference internal" href="icepack_4_developer_guide.html#dev-colphys"><span class="std std-ref">Icepack Column Physics</span></a></dd>
<dt><strong>configuration/scripts/</strong></dt>
<dd>directory of support scripts, see <a class="reference internal" href="icepack_4_developer_guide.html#dev-scripts"><span class="std std-ref">Scripts Implementation</span></a></dd>
<dt><strong>configuration/driver/</strong></dt>
<dd>directory of icepack driver code, see <a class="reference internal" href="icepack_4_developer_guide.html#dev-driver"><span class="std std-ref">Driver Implementation</span></a></dd>
<dt><strong>doc/</strong></dt>
<dd>documentation</dd>
<dt><strong>icepack.create.case</strong></dt>
<dd>main icepack script for creating cases</dd>
</dl>
<p>A case (compile) directory is created upon initial execution of the script
<strong>icepack.create.case</strong> at the user-specified location provided after the -c flag.
Executing the command <code class="docutils literal"><span class="pre">./icepack.create.case</span> <span class="pre">-h</span></code> provides helpful information for
this tool.</p>
</div>
<div class="section" id="grid-and-boundary-conditions">
<span id="grids"></span><h3>3.1.2. Grid and boundary conditions<a class="headerlink" href="#grid-and-boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>The driver configures a collection of grid cells on which the column physics code
will be run. This “horizontal” grid is a vector of length <code class="docutils literal"><span class="pre">nx</span></code>, with a minimum length
of 4.
The grid vector is initialized with different sea ice conditions, such as open
water, a uniform slab of ice, a multi-year ice thickness distribution with snow,
and land. For simplicity, the same forcing values are applied to all grid cells.</p>
<p>Icepack includes two vertical grids.  The basic vertical grid contains
<code class="docutils literal"><span class="pre">nilyr</span></code> equally spaced grid cells.
History variables available for column output are ice and snow
temperature, <code class="docutils literal"><span class="pre">Tinz</span></code> and <code class="docutils literal"><span class="pre">Tsnz</span></code>. These variables also include thickness
category as a fourth dimension.</p>
<p>In addition, there is a bio-grid that
can be more finely resolved and includes additional nodes for boundary conditions.
It is used for solving the brine height variable <span class="math">\(h_b\)</span> and for
discretizing the vertical transport equations of biogeochemical tracers.
The bio-grid is a non-dimensional vertical grid which takes the value
zero at <span class="math">\(h_b\)</span> and one at the ice–ocean interface. The number of
grid levels is specified during compilation by setting
the variable <code class="docutils literal"><span class="pre">NBGCLYR</span></code> equal to an integer (<span class="math">\(n_b\)</span>) .</p>
<p>Ice tracers and microstructural properties defined on the bio-grid are
referenced in two ways: as <code class="docutils literal"><span class="pre">bgrid</span></code> <span class="math">\(=n_b+2\)</span> points and as
igrid<span class="math">\(=n_b+1\)</span> points. For both bgrid and igrid, the first and
last points reference <span class="math">\(h_b\)</span> and the ice–ocean interface,
respectively, and so take the values <span class="math">\(0\)</span> and <span class="math">\(1\)</span>,
respectively. For bgrid, the interior points <span class="math">\([2, n_b+1]\)</span> are
spaced at <span class="math">\(1/n_b\)</span> intervals beginning with <cite>bgrid(2)</cite> =
<span class="math">\(1/(2n_b)\)</span>. The <code class="docutils literal"><span class="pre">igrid</span></code> interior points <span class="math">\([2, n_b]\)</span> are also
equidistant with the same spacing, but physically coincide with points
midway between those of <code class="docutils literal"><span class="pre">bgrid</span></code>.</p>
</div>
<div class="section" id="test-configurations">
<span id="testconfigs"></span><h3>3.1.3. Test configurations<a class="headerlink" href="#test-configurations" title="Permalink to this headline">¶</a></h3>
<p><em>(CHECK) UPDATE with similar, correct information</em></p>
<p>The column is located
near Barrow (71.35N, 156.5W). Options for choosing the column
configuration are given in <strong>comp_ice</strong> (choose <cite>RES col</cite>) and in the
namelist file, <strong>input_templates/col/ice_in</strong>. Here, <code class="docutils literal"><span class="pre">istep0</span></code> and the
initial conditions are set such that the run begins September 1 with no
ice.</p>
</div>
<div class="section" id="initialization-and-forcing">
<span id="init"></span><h3>3.1.4. Initialization and Forcing<a class="headerlink" href="#initialization-and-forcing" title="Permalink to this headline">¶</a></h3>
<p>Icepack’s parameters and variables are initialized in several
steps. Many constants and physical parameters are set in
<strong>icepack_constants.F90</strong>. In the current driver implementation,
a namelist file is read to setup the model.
Namelist values are given default
values in the code, which may then be changed when the input file
<strong>icepack_in</strong> is read. Other physical constants, numerical parameters, and
variables are first set in initialization routines for each ice model
component or module. Then, if the ice model is being restarted from a
previous run, core variables are read and reinitialized in
<em>restartfile</em>, while tracer variables needed for specific configurations
are read in separate restart routines associated with each tracer or
specialized parameterization. Finally, albedo and other quantities
dependent on the initial ice state are set. Some of these parameters
will be described in more detail in the <a class="reference internal" href="#tabnamelist"><span class="std std-ref">Table of namelist inputs</span></a>.</p>
<p>Two namelist variables control model initialization, <code class="docutils literal"><span class="pre">ice_ic</span></code>
and <code class="docutils literal"><span class="pre">restart</span></code>.  Setting <code class="docutils literal"><span class="pre">ice_ic</span></code> = ‘default’ causes the model to run using
initial values set in the code.  To start
from a file <strong>filename</strong>, set
<code class="docutils literal"><span class="pre">restart</span></code> = .true. and <code class="docutils literal"><span class="pre">ice_ic</span></code> = <strong>filename</strong>.  When restarting using the Icepack
driver, for simplicity the tracers are assumed to be set the same way (on/off) as in the
run that created the restart file; i.e. that the restart file contains exactly the
information needed for the new run.  CICE is more flexible in this regard.</p>
<p>For stand-alone runs,
routines in <strong>icedrv_forcing.F90</strong> read and interpolate data from files,
and are intended merely for testing, although they can also provide guidance for
the user to write his or her own routines.</p>
</div>
<div class="section" id="choosing-an-appropriate-time-step">
<span id="parameters"></span><h3>3.1.5. Choosing an appropriate time step<a class="headerlink" href="#choosing-an-appropriate-time-step" title="Permalink to this headline">¶</a></h3>
<p>Transport in thickness space imposes a restraint on the time
step, given by the ice growth/melt rate and the smallest range of
thickness among the categories,
<span class="math">\(\Delta t&lt;\min(\Delta H)/2\max(f)\)</span>, where <span class="math">\(\Delta H\)</span> is the
distance between category boundaries and <span class="math">\(f\)</span> is the thermodynamic
growth rate. For the 5-category ice thickness distribution used as the
default in this distribution, this is not a stringent limitation:
<span class="math">\(\Delta t &lt; 19.4\)</span>&nbsp;hr, assuming <span class="math">\(\max(f) = 40\)</span>&nbsp;cm/day.</p>
</div>
<div class="section" id="model-output">
<span id="history"></span><h3>3.1.6. Model output<a class="headerlink" href="#model-output" title="Permalink to this headline">¶</a></h3>
<p>History output from Icepack is not currently supported in the Icepack driver, except
in restart files.
The sea ice model <a class="reference external" href="https://github.com/CICE-Consortium/CICE">CICE</a> provides extensive
options for model output, including many derived output variables.</p>
<div class="section" id="diagnostic-files">
<h4>3.1.6.1. Diagnostic files<a class="headerlink" href="#diagnostic-files" title="Permalink to this headline">¶</a></h4>
<p>Icepack writes diagnostic information for each grid cell as a separate file,
<strong>ice_diag.*</strong>, identified by the initial ice state of the grid cell (no ice, slab, land, etc).</p>
</div>
<div class="section" id="restart-files">
<h4>3.1.6.2. Restart files<a class="headerlink" href="#restart-files" title="Permalink to this headline">¶</a></h4>
<p>CHECK and CHANGE as needed re netCDF</p>
<p>CICE provides restart data in binary unformatted or netCDF formats, via
the <code class="docutils literal"><span class="pre">IO_TYPE</span></code> flag in <strong>comp_ice</strong> and namelist variable
<code class="docutils literal"><span class="pre">restart_format</span></code>.</p>
<p>The restart files created by the Icepack driver contain all of the variables needed
for a full, exact restart. The filename begins with the character string
‘iced.’, and the restart dump frequency is given by the namelist
variable <code class="docutils literal"><span class="pre">dumpfreq</span></code>. The namelist variable <code class="docutils literal"><span class="pre">ice_ic</span></code> contains the
pointer to the filename from which the restart data is to be read.</p>
</div>
</div>
</div>
<div class="section" id="running-icepack">
<h2>3.2. Running Icepack<a class="headerlink" href="#running-icepack" title="Permalink to this headline">¶</a></h2>
<p>Quick-start instructions are provided in the <a class="reference internal" href="icepack_1_introduction.html#quickstart"><span class="std std-ref">Quick Start</span></a> section.</p>
<div class="section" id="scripts">
<span id="id2"></span><h3>3.2.1. Scripts<a class="headerlink" href="#scripts" title="Permalink to this headline">¶</a></h3>
<p>The icepack scripts are written to allow quick setup of cases and tests.  Once a case is
generated, users can manually modify the namelist and other files to custom configure
the case.  Several settings are available via scripts as well.</p>
<p>Most of the scripts that configure, build and run Icepack are contained in
the directory <strong>configuration/scripts/</strong>, except for <strong>icepack.create.case</strong>, which is
in the main directory.  <strong>icepack.create.case</strong> is the main script that generates a case.</p>
<p>Users may need to port the scripts to their local machine.
Specific instructions for porting are provided in <a class="reference internal" href="#porting"><span class="std std-ref">Porting</span></a>.</p>
<p><code class="docutils literal"><span class="pre">icepack.create.case</span> <span class="pre">-h</span></code> will provide the latest information about how to use the tool.
There are three usage modes,</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-c</span></code> creates individual stand alone cases.</li>
<li><code class="docutils literal"><span class="pre">-t</span></code> creates individual tests.  Tests are just cases that have some extra automation in order to carry out particular tests such as exact restart.</li>
<li><code class="docutils literal"><span class="pre">-ts</span></code> creates a test suite.  Test suites are predefined sets of tests and <code class="docutils literal"><span class="pre">-ts</span></code> provides the ability to quick setup, build, and run a full suite of tests.</li>
</ul>
<p>All modes will require use of <code class="docutils literal"><span class="pre">-m</span></code> to specify the machine and case and test modes
can use <code class="docutils literal"><span class="pre">-s</span></code> to define specific options.  <code class="docutils literal"><span class="pre">-t</span></code> and <code class="docutils literal"><span class="pre">-ts</span></code> will require <code class="docutils literal"><span class="pre">-testid</span></code> to be set
and both of the test modes can use <code class="docutils literal"><span class="pre">-bd</span></code>, <code class="docutils literal"><span class="pre">-bg</span></code>, <code class="docutils literal"><span class="pre">-bc</span></code>, and <code class="docutils literal"><span class="pre">-td</span></code> to compare with other results.
Testing will be described in greater detail in the <a class="reference internal" href="#testing"><span class="std std-ref">Testing Icepack</span></a> section.</p>
<p>Again, <code class="docutils literal"><span class="pre">icepack.create.case</span> <span class="pre">-h</span></code> will show the latest usage information including
the available <code class="docutils literal"><span class="pre">-s</span></code> options, the current ported machines, and the test choices.</p>
<p>To create a case, run <strong>icepack.create.case</strong>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">icepack</span><span class="o">.</span><span class="n">create</span><span class="o">.</span><span class="n">case</span> <span class="o">-</span><span class="n">c</span> <span class="n">mycase</span> <span class="o">-</span><span class="n">m</span> <span class="n">machine</span>
<span class="n">cd</span> <span class="n">mycase</span>
</pre></div>
</div>
<p>Once a case/test is created, several files are placed in the case directory</p>
<ul class="simple">
<li><strong>env.[machine]</strong> defines the environment</li>
<li><strong>icepack.settings</strong> defines many variables associated with building and running the model</li>
<li><strong>makdep.c</strong> is a tool that will automatically generate the make dependencies</li>
<li><strong>Macros.[machine]</strong> defines the Makefile macros</li>
<li><strong>Makefile</strong> is the makefile used to build the model</li>
<li><strong>icepack.build</strong> is a script that builds and compiles the model</li>
<li><strong>icepack_in</strong> is the namelist input file</li>
<li><strong>icepack.run</strong> is a batch run script</li>
<li><strong>icepack.submit</strong> is a simple script that submits the icepack.run script</li>
</ul>
<p>All scripts and namelist are fully resolved in the case.  Users can edit any
of the files in the case directory manually to change the model configuration,
build options, or batch settings.  The file
dependency is indicated in the above list.  For instance, if any of the files before
<strong>icepack.build</strong> in the list are edited, <strong>icepack.build</strong> should be rerun.</p>
<p>The <strong>casescripts/</strong> directory holds scripts used to create the case and can
largely be ignored.  Once a case is created, the <strong>icepack.build</strong> script should be run
interactively and then the case should be submitted by executing the
<strong>icepack.submit</strong> script interactively.  The <strong>icepack.submit</strong> script
simply submits the <strong>icepack.run script</strong>.
You can also submit the <strong>icepack.run</strong> script on the command line.</p>
<p>Some hints:</p>
<ul class="simple">
<li>To change namelist, manually edit the <strong>icepack_in</strong> file</li>
<li>To change batch settings, manually edit the top of the <strong>icepack.run</strong> file</li>
<li>To turn on the debug compiler flags, set <code class="docutils literal"><span class="pre">ICE_BLDDEBUG</span></code> in <strong>icepack.setttings</strong> to true</li>
<li>To change compiler options, manually edit the Macros file</li>
<li>To clean the build before each compile, set <code class="docutils literal"><span class="pre">ICE_CLEANBUILD</span></code> in <strong>icepack.settings</strong> to true
To not clean before the build, set <code class="docutils literal"><span class="pre">ICE_CLEANBUILD</span></code> in <strong>icepack.settings</strong> to false</li>
</ul>
<p>To build and run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">icepack</span><span class="o">.</span><span class="n">build</span>
<span class="o">./</span><span class="n">icepack</span><span class="o">.</span><span class="n">submit</span>
</pre></div>
</div>
<p>The build and run log files will be copied into the logs directory in the case directory.
Other model output will be in the run directory.  The run directory is set in <strong>icepack.settings</strong>
via the <strong>ICE_RUNDIR</strong> variable.  To modify the case setup, changes should be made in the
case directory, NOT the run directory.</p>
</div>
<div class="section" id="porting">
<span id="id3"></span><h3>3.2.2. Porting<a class="headerlink" href="#porting" title="Permalink to this headline">¶</a></h3>
<p>To port, an <strong>env.[machine]</strong> and <strong>Macros.[machine]</strong> file have to be added to the
<strong>configuration/scripts/machines/</strong> directory and the
<strong>configuration/scripts/icepack.run.setup.csh</strong> file needs to be modified.</p>
<ul class="simple">
<li>cd to <strong>configuration/scripts/machines/</strong></li>
<li>Copy an existing env and a Macros file to new names for your new machine</li>
<li>Edit your env and Macros files</li>
<li>cd .. to <strong>configuration/scripts/</strong></li>
<li>Edit the <strong>icepack.run.setup.csh</strong> script to add a section for your machine
with batch settings and job launch settings</li>
<li>Download and untar a forcing dataset to the location defined by
<code class="docutils literal"><span class="pre">ICE_MACHINE_INPUTDATA</span></code> in the env file</li>
</ul>
<p>In fact, this process almost certainly will require some iteration.  The easiest way
to carry this out is to create an initial set of changes as described above, then
create a case and manually modify the <strong>env.[machine]</strong> file and <strong>Macros.[machine]</strong>
file until the case can build and run.  Then copy the files from the case
directory back to <strong>configuration/scripts/machines/</strong> and update
the <strong>configuration/scripts/icepack.run.setup.csh</strong> file, retest,
and then add and commit the updated machine files to the repository.</p>
<div class="section" id="input-data">
<h4>3.2.2.1. Input Data<a class="headerlink" href="#input-data" title="Permalink to this headline">¶</a></h4>
<p>The input data space is defined on a per machine basis by the <code class="docutils literal"><span class="pre">ICE_MACHINE_INPUTDATA</span></code>
variable in the <strong>env.[machine]</strong> file.  That file space is often shared among multiple
users, and it can be desirable to consider using a common file space with group read
and write permissions such that a set of users can update the inputdata area as
new datasets are available.</p>
<p>The latest input data will be available thru the CICE Consortium github wiki.</p>
</div>
<div class="section" id="machine-account-settings">
<h4>3.2.2.2. Machine Account Settings<a class="headerlink" href="#machine-account-settings" title="Permalink to this headline">¶</a></h4>
<p>The machine account default is specified by the variable <code class="docutils literal"><span class="pre">ICE_MACHINE_ACCT</span></code> in
the <strong>env.[machine]</strong> file.  The easiest way to change a user’s default is to
create a file in your home directory called <strong>.cice_proj</strong> and add your
preferred account name to the first line.
There is also an option (<code class="docutils literal"><span class="pre">-a</span></code>) in <strong>icepack.create.case</strong> to define the account number.
The order of precedent is <strong>icepack.create.case</strong> command line option,
<strong>.cice_proj</strong> setting, and then value in the <strong>env.[machine]</strong> file.</p>
</div>
</div>
<div class="section" id="run-directories">
<h3>3.2.3. Run Directories<a class="headerlink" href="#run-directories" title="Permalink to this headline">¶</a></h3>
<p>The <strong>icepack.create.case</strong> script creates a case directory.  However, the model
is actually built and run under the <code class="docutils literal"><span class="pre">ICE_OBJDIR</span></code> and <code class="docutils literal"><span class="pre">ICE_RUNDIR</span></code> directories
as defined in the <strong>icepack.settings</strong> file.</p>
<p>Build and run logs will be copied from the run directory into the case <strong>logs/</strong>
directory when complete.</p>
</div>
<div class="section" id="local-modifications">
<h3>3.2.4. Local modifications<a class="headerlink" href="#local-modifications" title="Permalink to this headline">¶</a></h3>
<p>Scripts and other case settings can be changed manually in the case directory and
used.  Source code can be modified in the main sandbox.  When changes are made, the code
should be rebuilt before being resubmitted.  It is always recommended that users
modify the scripts and input settings in the case directory, NOT the run directory.
In general, files in the run directory are overwritten by versions in the case
directory when the model is built, submitted, and run.</p>
</div>
<div class="section" id="forcing-data">
<h3>3.2.5. Forcing data<a class="headerlink" href="#forcing-data" title="Permalink to this headline">¶</a></h3>
<p>CHECK once we’ve settled on a forcing suite:</p>
<p>The code is currently configured to run in standalone mode on a 4-cell grid using
atmospheric data, available as detailed on the <a class="reference external" href="https://github.com/CICE-Consortium/Icepack/wiki/Testing-Icepack">wiki</a>.
These data files are designed only for testing the code, not for use in production
runs or as observational data.  Please do not publish results based on these data
sets.  Module <strong>configuration/driver/icedrv_forcing.F90</strong>
can be modified to change the forcing data.</p>
</div>
</div>
<div class="section" id="testing-icepack">
<span id="testing"></span><h2>3.3. Testing Icepack<a class="headerlink" href="#testing-icepack" title="Permalink to this headline">¶</a></h2>
<p>The section documents primarily how to use the Icepack scripts to carry
out icepack testing.  Exactly what to test is a separate question and
depends on the kinds of code changes being made.  Prior to merging
changes to the CICE Consortium master, changes will be reviewed and
developers will need to provide a summary of the tests carried out.</p>
<p>There is a base suite of tests provided by default with Icepack and this
may be a good starting point for testing.</p>
<div class="section" id="individual-tests">
<span id="indtests"></span><h3>3.3.1. Individual Tests<a class="headerlink" href="#individual-tests" title="Permalink to this headline">¶</a></h3>
<p>The Icepack scripts support both setup of individual tests as well as test suites.  Individual
tests are run from the command line:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">icepack</span><span class="o">.</span><span class="n">create</span><span class="o">.</span><span class="n">case</span> <span class="o">-</span><span class="n">t</span> <span class="n">smoke</span> <span class="o">-</span><span class="n">m</span> <span class="n">wolf</span> <span class="o">-</span><span class="n">s</span> <span class="n">diag1</span><span class="p">,</span><span class="n">debug</span> <span class="o">-</span><span class="n">testid</span> <span class="n">myid</span>
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">-m</span></code> designates a specific machine and testid is a user defined string that allows
test cases to be uniquely identified.
The format of the case directory name for a test will always be
<code class="docutils literal"><span class="pre">[machine]_[test]_[grid]_[pes]_[soptions].[testid]</span></code></p>
<p>To build and run a test, the process is the same as a case.  cd to the
test directory, run the build script, and run the submit script:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="p">[</span><span class="n">test_case</span><span class="p">]</span>
<span class="o">./</span><span class="n">icepack</span><span class="o">.</span><span class="n">build</span>
<span class="o">./</span><span class="n">icepack</span><span class="o">.</span><span class="n">submit</span>
</pre></div>
</div>
<p>The test results will be copied into a local file called <strong>test_output</strong>.
To check those results:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="n">test_output</span>
</pre></div>
</div>
<p>Tests are defined under <strong>configuration/scripts/tests/</strong>.  The tests currently supported are:</p>
<ul>
<li><dl class="first docutils">
<dt>smoke   - Runs the model for default length.  The length and options can</dt>
<dd><p class="first last">be set with the <code class="docutils literal"><span class="pre">-s</span></code> command line option.  The test passes if the
model completes successfully.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>restart - Runs the model for 14 months, writing a restart file at month 3 and</dt>
<dd><p class="first last">again at the end of the run.  Runs the model a second time starting from the
month 3 restart and writing a restart at month 12 of the model run.
The test passes if both runs complete and
if the restart files at month 12 from both runs are bit-for-bit identical.</p>
</dd>
</dl>
</li>
</ul>
<p>Please run <code class="docutils literal"><span class="pre">./icepack.create.case</span> <span class="pre">-h</span></code> for the latest information.</p>
</div>
<div class="section" id="test-suites">
<span id="testsuites"></span><h3>3.3.2. Test suites<a class="headerlink" href="#test-suites" title="Permalink to this headline">¶</a></h3>
<p>Test suites are multiple tests that are specified via
an input file.  When invoking the test suite option (<code class="docutils literal"><span class="pre">-ts</span></code>) with <strong>icepack.create.case</strong>,
all tests will be created, built, and submitted automatically under
a directory called [suite_name].[testid]:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">icepack</span><span class="o">.</span><span class="n">create</span><span class="o">.</span><span class="n">case</span> <span class="o">-</span><span class="n">ts</span> <span class="n">base_suite</span> <span class="o">-</span><span class="n">m</span> <span class="n">wolf</span> <span class="o">-</span><span class="n">testid</span> <span class="n">myid</span>
</pre></div>
</div>
<p>Like an individual test, the <code class="docutils literal"><span class="pre">-testid</span></code> option must be specified and can be any
string.  Once the tests are complete, results can be checked by running the
results.csh script in the [suite_name].[testid]:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">base_suite</span><span class="o">.</span><span class="p">[</span><span class="n">testid</span><span class="p">]</span>
<span class="o">./</span><span class="n">results</span><span class="o">.</span><span class="n">csh</span>
</pre></div>
</div>
<p>Please run <code class="docutils literal"><span class="pre">./icepack.create.case</span> <span class="pre">-h</span></code> for additional details.</p>
<p>The predefined test suites are defined under <strong>configuration/scripts/tests</strong> and the files defining
the suites
have a suffix of .ts in that directory.  The format for the test suite file is relatively simple.
It is a text file with white space delimited
columns, e.g. <strong>base_suite.ts</strong></p>
<table border="1" class="docutils" id="id11">
<span id="tab-test"></span><caption><span class="caption-text">Table 7</span><a class="headerlink" href="#id11" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="29%" />
<col width="29%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Test</th>
<th class="head">Grid</th>
<th class="head">PEs</th>
<th class="head">Sets</th>
<th class="head">BFB-compare</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>smoke</td>
<td>col</td>
<td>1x1</td>
<td>diag1</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>smoke</td>
<td>col</td>
<td>1x1</td>
<td>diag1,run1year</td>
<td>smoke_col_1x1_diag1_run1year</td>
</tr>
<tr class="row-even"><td>smoke</td>
<td>col</td>
<td>1x1</td>
<td>debug,run1year</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>restart</td>
<td>col</td>
<td>1x1</td>
<td>debug</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>restart</td>
<td>col</td>
<td>1x1</td>
<td>diag1</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>restart</td>
<td>col</td>
<td>1x1</td>
<td>pondcesm</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>restart</td>
<td>col</td>
<td>1x1</td>
<td>pondlvl</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>restart</td>
<td>col</td>
<td>1x1</td>
<td>pondtopo</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<p>The first column is the test name, the second the grid, the third the pe count, the fourth column is
the <code class="docutils literal"><span class="pre">-s</span></code> options and the fifth column is the <code class="docutils literal"><span class="pre">-td</span></code> argument. (The grid and PEs columns are provided
for compatibility with the similar CICE scripts.)  The fourth and fifth columns are optional.
The argument to <code class="docutils literal"><span class="pre">-ts</span></code> defines which filename to choose and that argument can contain a path.
<strong>icepack.create.case</strong>
will look for the filename in the local directory, in <strong>configuration/scripts/tests/</strong>, or in the path defined
by the <code class="docutils literal"><span class="pre">-ts</span></code> option.</p>
</div>
<div class="section" id="regression-testing">
<span id="regtesting"></span><h3>3.3.3. Regression testing<a class="headerlink" href="#regression-testing" title="Permalink to this headline">¶</a></h3>
<p>The <strong>icepack.create.case</strong> options <code class="docutils literal"><span class="pre">-bg</span></code>, <code class="docutils literal"><span class="pre">-bc</span></code>, and <code class="docutils literal"><span class="pre">-bd</span></code> are used for regression testing.
There are several additional options on the <strong>icepack.create.case</strong> command line for testing that
provide the ability to regression test and compare tests to each other.  These options only
work in test (<code class="docutils literal"><span class="pre">-t</span></code>) or test suite (<code class="docutils literal"><span class="pre">-ts</span></code>) mode, not in case (<code class="docutils literal"><span class="pre">-c</span></code>) mode.</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">-bd</span></code> defines a top level directory where tests can be stored for regression testing.  The
default is defined by <code class="docutils literal"><span class="pre">ICE_MACHINE_BASELINE</span></code> defined in <code class="docutils literal"><span class="pre">env.[machine]</span></code>.</p>
<p><code class="docutils literal"><span class="pre">-bg</span></code> defines a directory name where the current tests can be saved for regression testing.
It’s handy for this name to be related to the model version.  This directory will be created
below the directory associated with <code class="docutils literal"><span class="pre">-bd</span></code>.</p>
<p><code class="docutils literal"><span class="pre">-bc</span></code> defines the directory name that the current tests should be compared to for regression
testing.  This directory will be added to the directory associated with <code class="docutils literal"><span class="pre">-bd</span></code>.</p>
</div></blockquote>
<p>To create a baseline, use <code class="docutils literal"><span class="pre">-bg</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>icepack.create.case -ts base_suite -m wolf -testid v1 -bg version1 -bd $SCRATCH/ICEPACK_BASELINES
</pre></div>
</div>
<p>will copy all the results from the test suite to <code class="docutils literal"><span class="pre">$SCRATCH/ICEPACK_BASELINES/version1</span></code>.</p>
<p>To compare to a prior result, use <code class="docutils literal"><span class="pre">-bc</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>icepack.create.case -ts base_suite -m wolf -testid v2 -bc version1 -bd $SCRATCH/ICEPACK_BASELINES
</pre></div>
</div>
<p>will compare all the results from this test suite to results saved before in $SCRATCH/ICEPACK_BASELINES/version1``.</p>
<p>To both create and compare, <code class="docutils literal"><span class="pre">-bc</span></code> and <code class="docutils literal"><span class="pre">-bg</span></code> can be combined:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>icepack.create.case -ts base_suite -m wolf -testid v2 -bg version2 -bc version1 -bd $SCRATCH/ICEPACK_BASELINES
</pre></div>
</div>
<p>will save the current results to <code class="docutils literal"><span class="pre">$SCRATCH/ICEPACK_BASELINES/version2</span></code> and compare the current results to
results save before in <code class="docutils literal"><span class="pre">$SCRATCH/ICEPACK_BASELINES/version1</span></code>.</p>
<p>In summary,</p>
<ul class="simple">
<li>an individual test will have a case name like
<code class="docutils literal"><span class="pre">[machine]_[test]_[grid]_[pes]_[soptions].[testid]</span></code>.</li>
<li>A test suite will generate the individual tests under a directory called <code class="docutils literal"><span class="pre">[suite_name].[testid]</span></code>.</li>
<li><code class="docutils literal"><span class="pre">-bg</span></code> will copy test results to the <code class="docutils literal"><span class="pre">[bd_directory]/[bg_directory]/[test_name]</span></code>.</li>
<li><code class="docutils literal"><span class="pre">-bc</span></code> will compare results from  <code class="docutils literal"><span class="pre">[bd_directory]/[bc_directory]/[test_name]</span></code>.</li>
</ul>
</div>
<div class="section" id="comparison-testing">
<span id="comptesting"></span><h3>3.3.4. Comparison testing<a class="headerlink" href="#comparison-testing" title="Permalink to this headline">¶</a></h3>
<p>This feature is primarily used in test suites and has limited use in icepack, but is being
described for completeness.</p>
<p><code class="docutils literal"><span class="pre">-td</span></code> provides a way to compare tests with each other.  The test is always compared relative to
the current case directory.  For instance:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">icepack</span><span class="o">.</span><span class="n">create</span><span class="o">.</span><span class="n">case</span> <span class="o">-</span><span class="n">t</span> <span class="n">smoke</span> <span class="o">-</span><span class="n">m</span> <span class="n">wolf</span> <span class="o">-</span><span class="n">testid</span> <span class="n">t01</span>
</pre></div>
</div>
<p>creates a test case named wolf_smoke_col_1x1.t01:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">icepack</span><span class="o">.</span><span class="n">create</span><span class="o">.</span><span class="n">case</span> <span class="o">-</span><span class="n">t</span> <span class="n">smoke</span> <span class="o">-</span><span class="n">m</span> <span class="n">wolf</span> <span class="o">-</span><span class="n">s</span> <span class="n">run1year</span> <span class="o">-</span><span class="n">testid</span> <span class="n">t01</span> <span class="o">-</span><span class="n">td</span> <span class="n">smoke_col_1x1</span>
</pre></div>
</div>
<p>will create a test case named wolf_smoke_col_1x1_run1year.t01.
An additional check will be done for the second test (because of the <code class="docutils literal"><span class="pre">-td</span></code> argument), and it will compare
the output from the first test “smoke_col_1x1” to the output from its test “smoke_col_1x1_run1year”
and generate a result for that.  It’s important that the first test complete before the second test is done
and that the tests are created in parallel directories.
The <code class="docutils literal"><span class="pre">-td</span></code> option works only if the testid and the machine are the same for the baseline run and the
current run, a basic feature associated with test suites.</p>
</div>
<div class="section" id="icepack-test-reporting">
<h3>3.3.5. Icepack Test Reporting<a class="headerlink" href="#icepack-test-reporting" title="Permalink to this headline">¶</a></h3>
<p>The Icepack testing scripts have the capability of posting the test results
to an online dashboard, located <a class="reference external" href="http://my.cdash.org/index.php?project=myICEPACK">on CDash</a>.
There are two ways to post Icepack results to CDash, an automated method and
a manual method.</p>
<p>To automatically post test suite results to CDash, add the <code class="docutils literal"><span class="pre">-report</span></code> option to <strong>icepack.create.case</strong>.
The base_suite will attempt to post the test results on CDash when the suite is complete.</p>
<p>To manually post the test results to the Icepack CDash dashboard,
run a standard test suite.  Then once all the tests are complete:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="p">[</span><span class="n">suite_name</span><span class="p">]</span><span class="o">.</span><span class="p">[</span><span class="n">testid</span><span class="p">]</span>
<span class="o">./</span><span class="n">results</span><span class="o">.</span><span class="n">csh</span>
<span class="n">ctest</span> <span class="o">-</span><span class="n">S</span> <span class="n">steer</span><span class="o">.</span><span class="n">cmake</span>
</pre></div>
</div>
</div>
<div class="section" id="examples">
<h3>3.3.6. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<div class="section" id="to-generate-a-baseline-dataset-for-a-test-case">
<h4>3.3.6.1. To generate a baseline dataset for a test case<a class="headerlink" href="#to-generate-a-baseline-dataset-for-a-test-case" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">icepack</span><span class="o">.</span><span class="n">create</span><span class="o">.</span><span class="n">case</span> <span class="o">-</span><span class="n">t</span> <span class="n">smoke</span> <span class="o">-</span><span class="n">m</span> <span class="n">wolf</span> <span class="o">-</span><span class="n">bg</span> <span class="n">icepackv6</span><span class="o">.</span><span class="mf">0.0</span> <span class="o">-</span><span class="n">testid</span> <span class="n">t00</span>
<span class="n">cd</span> <span class="n">wolf_smoke_col_1x1</span><span class="o">.</span><span class="n">t00</span>
<span class="o">./</span><span class="n">icepack</span><span class="o">.</span><span class="n">build</span>
<span class="o">./</span><span class="n">icepack</span><span class="o">.</span><span class="n">submit</span>
</pre></div>
</div>
<p>After job finishes, check output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="n">test_output</span>
</pre></div>
</div>
</div>
<div class="section" id="to-run-a-test-case-and-compare-to-a-baseline-dataset">
<h4>3.3.6.2. To run a test case and compare to a baseline dataset<a class="headerlink" href="#to-run-a-test-case-and-compare-to-a-baseline-dataset" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">icepack</span><span class="o">.</span><span class="n">create</span><span class="o">.</span><span class="n">case</span> <span class="o">-</span><span class="n">t</span> <span class="n">smoke</span> <span class="o">-</span><span class="n">m</span> <span class="n">wolf</span> <span class="o">-</span><span class="n">bc</span> <span class="n">icepackv6</span><span class="o">.</span><span class="mf">0.0</span> <span class="o">-</span><span class="n">testid</span> <span class="n">t01</span>
<span class="n">cd</span> <span class="n">wolf_smoke_col_1x1</span><span class="o">.</span><span class="n">t01</span>
<span class="o">./</span><span class="n">icepack</span><span class="o">.</span><span class="n">build</span>
<span class="o">./</span><span class="n">icepack</span><span class="o">.</span><span class="n">submit</span>
</pre></div>
</div>
<p>After job finishes, check output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="n">test_output</span>
</pre></div>
</div>
</div>
<div class="section" id="to-run-a-test-suite-to-generate-baseline-data-review-results-plot-timeseries-and-manually-report-results">
<h4>3.3.6.3. To run a test suite to generate baseline data, review results, plot timeseries, and manually report results<a class="headerlink" href="#to-run-a-test-suite-to-generate-baseline-data-review-results-plot-timeseries-and-manually-report-results" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">icepack</span><span class="o">.</span><span class="n">create</span><span class="o">.</span><span class="n">case</span> <span class="o">-</span><span class="n">m</span> <span class="n">wolf</span> <span class="o">-</span><span class="n">ts</span> <span class="n">base_suite</span> <span class="o">-</span><span class="n">testid</span> <span class="n">t02</span> <span class="o">-</span><span class="n">bg</span> <span class="n">icepackv6</span><span class="o">.</span><span class="mf">0.0</span><span class="n">bs</span>
</pre></div>
</div>
<p>Once all jobs finish, concatenate all output and manually report results:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">base_suite</span><span class="o">.</span><span class="n">t02</span>
<span class="o">./</span><span class="n">results</span><span class="o">.</span><span class="n">csh</span>
<span class="n">ctest</span> <span class="o">-</span><span class="n">S</span> <span class="n">steer</span><span class="o">.</span><span class="n">cmake</span>
</pre></div>
</div>
<p>To plot a timeseries of “total ice extent”, “total ice area”, and “total ice volume”:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">timeseries</span><span class="o">.</span><span class="n">csh</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;</span>
<span class="n">ls</span> <span class="o">*.</span><span class="n">png</span>
</pre></div>
</div>
</div>
<div class="section" id="to-run-a-test-suite-compare-to-baseline-data-generate-a-new-baseline-and-automatically-report-the-results">
<h4>3.3.6.4. To run a test suite, compare to baseline data, generate a new baseline, and automatically report the results<a class="headerlink" href="#to-run-a-test-suite-compare-to-baseline-data-generate-a-new-baseline-and-automatically-report-the-results" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">icepack</span><span class="o">.</span><span class="n">create</span><span class="o">.</span><span class="n">case</span> <span class="o">-</span><span class="n">m</span> <span class="n">wolf</span> <span class="o">-</span><span class="n">ts</span> <span class="n">base_suite</span> <span class="o">-</span><span class="n">testid</span> <span class="n">t03</span> <span class="o">-</span><span class="n">bc</span> <span class="n">icepackv6</span><span class="o">.</span><span class="mf">0.0</span><span class="n">bs</span> <span class="o">-</span><span class="n">bg</span> <span class="n">icepackv6</span><span class="o">.</span><span class="mf">0.0</span><span class="n">new</span> <span class="o">-</span><span class="n">report</span>
</pre></div>
</div>
<p>Once all jobs finish, concatenate all output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">base_suite</span><span class="o">.</span><span class="n">t03</span>
<span class="o">./</span><span class="n">results</span><span class="o">.</span><span class="n">csh</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="case-settings">
<h2>3.4. Case Settings<a class="headerlink" href="#case-settings" title="Permalink to this headline">¶</a></h2>
<p>There are two important files that define the case, <strong>icepack.settings</strong> and
<strong>icepack_in</strong>.  <strong>icepack.settings</strong> is a list of env variables that define many
values used to setup, build and run the case.  <strong>icepack_in</strong> is the input namelist file
for the icepack driver.  Variables in both files are described below.</p>
<div class="section" id="table-of-icepack-settings">
<span id="tabsettings"></span><h3>3.4.1. Table of icepack settings<a class="headerlink" href="#table-of-icepack-settings" title="Permalink to this headline">¶</a></h3>
<p>The <strong>icepack.settings</strong> file is reasonably well self documented.  Several of
the variables defined in the file are not used in Icepack.  They exist
to support the CICE model.</p>
<table border="1" class="docutils" id="id12">
<caption><span class="caption-text">Table 9</span><a class="headerlink" href="#id12" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="33%" />
<col width="27%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">variable</th>
<th class="head">options/format</th>
<th class="head">description</th>
<th class="head">recommended value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ICE_MACHINE</td>
<td>&#160;</td>
<td>machine name</td>
<td>set by icepack.create.case</td>
</tr>
<tr class="row-odd"><td>ICE_CASENAME</td>
<td>&#160;</td>
<td>case name</td>
<td>set by icepack.create.case</td>
</tr>
<tr class="row-even"><td>ICE_SANDBOX</td>
<td>&#160;</td>
<td>sandbox directory</td>
<td>set by icepack.create.case</td>
</tr>
<tr class="row-odd"><td>ICE_SCRIPTS</td>
<td>&#160;</td>
<td>scripts directory</td>
<td>set by icepack.create.case</td>
</tr>
<tr class="row-even"><td>ICE_CASEDIR</td>
<td>&#160;</td>
<td>case directory</td>
<td>set by icepack.create.case</td>
</tr>
<tr class="row-odd"><td>ICE_RUNDIR</td>
<td>&#160;</td>
<td>run directory</td>
<td>set by icepack.create.case</td>
</tr>
<tr class="row-even"><td>ICE_OBJDIR</td>
<td>&#160;</td>
<td>compile directory</td>
<td>${ICE_RUNDIR}/compile</td>
</tr>
<tr class="row-odd"><td>ICE_RSTDIR</td>
<td>&#160;</td>
<td>unused</td>
<td>${ICE_RUNDIR}/restart</td>
</tr>
<tr class="row-even"><td>ICE_HSTDIR</td>
<td>&#160;</td>
<td>unused</td>
<td>${ICE_RUNDIR}/history</td>
</tr>
<tr class="row-odd"><td>ICE_LOGDIR</td>
<td>&#160;</td>
<td>log directory</td>
<td>${ICE_CASEDIR}/logs</td>
</tr>
<tr class="row-even"><td>ICE_RSTPFILE</td>
<td>&#160;</td>
<td>unused</td>
<td>undefined</td>
</tr>
<tr class="row-odd"><td>ICE_DRVOPT</td>
<td>&#160;</td>
<td>unused</td>
<td>icepack</td>
</tr>
<tr class="row-even"><td>ICE_CONSTOPT</td>
<td>&#160;</td>
<td>unused</td>
<td>cice</td>
</tr>
<tr class="row-odd"><td>ICE_IOTYPE</td>
<td>&#160;</td>
<td>unused</td>
<td>none</td>
</tr>
<tr class="row-even"><td>ICE_CLEANBUILD</td>
<td>true,false</td>
<td>automatically clean before building</td>
<td>true</td>
</tr>
<tr class="row-odd"><td>ICE_GRID</td>
<td>col</td>
<td>grid</td>
<td>col</td>
</tr>
<tr class="row-even"><td>ICE_NXGLOB</td>
<td>4</td>
<td>number of gridcells</td>
<td>4</td>
</tr>
<tr class="row-odd"><td>ICE_NTASKS</td>
<td>1</td>
<td>number of tasks, must be set to 1</td>
<td>1</td>
</tr>
<tr class="row-even"><td>ICE_NTHRDS</td>
<td>1</td>
<td>number of threads per task, must be set to 1</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>ICE_TEST</td>
<td>&#160;</td>
<td>test setting if using a test</td>
<td>set by icepack.create.case</td>
</tr>
<tr class="row-even"><td>ICE_TESTNAME</td>
<td>&#160;</td>
<td>test name if using a test</td>
<td>set by icepack.create.case</td>
</tr>
<tr class="row-odd"><td>ICE_BASELINE</td>
<td>&#160;</td>
<td>baseline directory name, associated with icepack.create.case -bd</td>
<td>set by icepack.create.case</td>
</tr>
<tr class="row-even"><td>ICE_BASEGEN</td>
<td>&#160;</td>
<td>baseline directory name for regression generation, associated with icepack.create.case -bg</td>
<td>set by icepack.create.case</td>
</tr>
<tr class="row-odd"><td>ICE_BASECOM</td>
<td>&#160;</td>
<td>baseline directory name for regression comparison, associated with icepack.create.case -bc</td>
<td>set by icepack.create.case</td>
</tr>
<tr class="row-even"><td>ICE_BFBCOMP</td>
<td>&#160;</td>
<td>location of case for comparison, associated with icepack.create.case -td</td>
<td>set by icepack.create.case</td>
</tr>
<tr class="row-odd"><td>ICE_SPVAL</td>
<td>&#160;</td>
<td>unused</td>
<td>UnDeFiNeD</td>
</tr>
<tr class="row-even"><td>ICE_RUNLENGTH</td>
<td>&#160;</td>
<td>batch run length default</td>
<td><blockquote class="first last">
<div>00:10:00</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td>ICE_THREADED</td>
<td>true,false</td>
<td>force threading in compile, will always compile threaded if NTHRDS is gt 1</td>
<td>false</td>
</tr>
<tr class="row-even"><td>NICELYR</td>
<td>&#160;</td>
<td>number of vertical layers in the ice</td>
<td>7</td>
</tr>
<tr class="row-odd"><td>NSNWLYR</td>
<td>&#160;</td>
<td>number of vertical layers in the snow</td>
<td>1</td>
</tr>
<tr class="row-even"><td>NICECAT</td>
<td>&#160;</td>
<td>number of ice thickness categories</td>
<td>5</td>
</tr>
<tr class="row-odd"><td>TRAGE</td>
<td>0,1</td>
<td>ice age tracer</td>
<td>1</td>
</tr>
<tr class="row-even"><td>TRFY</td>
<td>0,1</td>
<td>first-year ice area tracer</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>TRLVL</td>
<td>0,1</td>
<td>deformed ice tracer</td>
<td>1</td>
</tr>
<tr class="row-even"><td>TRPND</td>
<td>0,1</td>
<td>melt pond tracer</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>NTRAERO</td>
<td>&#160;</td>
<td>number of aerosol tracers</td>
<td>1</td>
</tr>
<tr class="row-even"><td>TRBRI</td>
<td>0,1</td>
<td>brine height tracer</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>TRZS</td>
<td>0,1</td>
<td>zsalinity tracer, needs TRBRI=1</td>
<td>0</td>
</tr>
<tr class="row-even"><td>TRBGCS</td>
<td>0,1</td>
<td>skeletal layer tracer, needs TRBGCZ=0</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>TRBGCZ</td>
<td>0,1</td>
<td>zbgc tracers, needs TRBGCS=0 and TRBRI=1</td>
<td>0</td>
</tr>
<tr class="row-even"><td>NBGCLYR</td>
<td>&#160;</td>
<td>number of zbgc layers</td>
<td>7</td>
</tr>
<tr class="row-odd"><td>TRZAERO</td>
<td>0-6</td>
<td>number of z aerosol tracers</td>
<td>0</td>
</tr>
<tr class="row-even"><td>TRALG</td>
<td>0,1,2,3</td>
<td>number of algal tracers</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>TRDOC</td>
<td>0,1,2,3</td>
<td>number of dissolved organic carbon</td>
<td>0</td>
</tr>
<tr class="row-even"><td>TRDIC</td>
<td>0,1</td>
<td>number of dissolved inorganic carbon</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>TRDON</td>
<td>0,1</td>
<td>number of dissolved organic nitrogen</td>
<td>0</td>
</tr>
<tr class="row-even"><td>TRFEP</td>
<td>0,1,2</td>
<td>number of particulate iron tracers</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>TRFED</td>
<td>0,1,2</td>
<td>number of dissolved iron tracers</td>
<td>0</td>
</tr>
<tr class="row-even"><td>CAM_ICE</td>
<td>&#160;</td>
<td>unused</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>DITTO</td>
<td>&#160;</td>
<td>unused</td>
<td>no</td>
</tr>
<tr class="row-even"><td>BARRIERS</td>
<td>&#160;</td>
<td>unused</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>ICE_BLDDEBUG</td>
<td>true,false</td>
<td>turn on compile debug flags</td>
<td>false</td>
</tr>
<tr class="row-even"><td>NUMIN</td>
<td>&#160;</td>
<td>unused</td>
<td>11</td>
</tr>
<tr class="row-odd"><td>NUMAX</td>
<td>&#160;</td>
<td>unused</td>
<td>99</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="table-of-namelist-inputs">
<span id="tabnamelist"></span><h3>3.4.2. Table of namelist inputs<a class="headerlink" href="#table-of-namelist-inputs" title="Permalink to this headline">¶</a></h3>
<p>CHECK</p>
<p>Namelist is part of the icepack driver code and is used to setup testing of the
column physics.</p>
<table border="1" class="docutils" id="id13">
<span id="tab-namelist"></span><caption><span class="caption-text">Table 8</span><a class="headerlink" href="#id13" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="40%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">variable</th>
<th class="head">options/format</th>
<th class="head">description</th>
<th class="head">recommended value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>setup_nml</em></td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td><em>Time, Diagnostics</em></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">days_per_year</span></code></td>
<td><code class="docutils literal"><span class="pre">360</span></code> or <code class="docutils literal"><span class="pre">365</span></code></td>
<td>number of days in a model year</td>
<td>365</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">use_leap_years</span></code></td>
<td>true/false</td>
<td>if true, include leap days</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">year_init</span></code></td>
<td>yyyy</td>
<td>the initial year, if not using restart</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">istep0</span></code></td>
<td>integer</td>
<td>initial time step number</td>
<td>0</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">dt</span></code></td>
<td>seconds</td>
<td>thermodynamics time step length</td>
<td><ol class="first last arabic simple" start="3600">
<li></li>
</ol>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">npt</span></code></td>
<td>integer</td>
<td>total number of time steps to take</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">ndtd</span></code></td>
<td>integer</td>
<td>number of dynamics/advection/ridging/steps per thermo timestep</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td><em>Initialization/Restarting</em></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">ice_ic</span></code></td>
<td><code class="docutils literal"><span class="pre">default</span></code></td>
<td>latitude and sst dependent</td>
<td>default</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">none</span></code></td>
<td>no ice</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>path/file</td>
<td>restart file name</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">restart_dir</span></code></td>
<td>path/</td>
<td>path to restart directory</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">dumpfreq</span></code></td>
<td><code class="docutils literal"><span class="pre">y</span></code></td>
<td>write restart every <code class="docutils literal"><span class="pre">dumpfreq_n</span></code> years</td>
<td>y</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">m</span></code></td>
<td>write restart every <code class="docutils literal"><span class="pre">dumpfreq_n</span></code> months</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">d</span></code></td>
<td>write restart every <code class="docutils literal"><span class="pre">dumpfreq_n</span></code> days</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td><em>Model Output</em></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">diagfreq</span></code></td>
<td>integer</td>
<td>frequency of diagnostic output in <code class="docutils literal"><span class="pre">dt</span></code></td>
<td>24</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><em>e.g.</em>, 10</td>
<td>once every 10 time steps</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">diag_file</span></code></td>
<td>filename</td>
<td>diagnostic output file (script may reset)</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><em>grid_nml</em></td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td><em>Grid</em></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">kcatbound</span></code></td>
<td><code class="docutils literal"><span class="pre">0</span></code></td>
<td>original category boundary formula</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">1</span></code></td>
<td>new formula with round numbers</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">2</span></code></td>
<td>WMO standard categories</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">-1</span></code></td>
<td>one category</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><em>tracer_nml</em></td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td><em>Tracers</em></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">tr_iage</span></code></td>
<td>true/false</td>
<td>ice age</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">tr_FY</span></code></td>
<td>true/false</td>
<td>first-year ice area</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">tr_lvl</span></code></td>
<td>true/false</td>
<td>level ice area and volume</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">tr_pond_cesm</span></code></td>
<td>true/false</td>
<td>CESM melt ponds</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">tr_pond_topo</span></code></td>
<td>true/false</td>
<td>topo melt ponds</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">tr_pond_lvl</span></code></td>
<td>true/false</td>
<td>level-ice melt ponds</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">tr_aero</span></code></td>
<td>true/false</td>
<td>aerosols</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><em>thermo_nml</em></td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td><em>Thermodynamics</em></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">kitd</span></code></td>
<td><code class="docutils literal"><span class="pre">0</span></code></td>
<td>delta function ITD approximation</td>
<td>1</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">1</span></code></td>
<td>linear remapping ITD approximation</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">ktherm</span></code></td>
<td><code class="docutils literal"><span class="pre">0</span></code></td>
<td>zero-layer thermodynamic model</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">1</span></code></td>
<td>Bitz and Lipscomb thermodynamic model</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">2</span></code></td>
<td>mushy-layer thermodynamic model</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">conduct</span></code></td>
<td><code class="docutils literal"><span class="pre">MU71</span></code></td>
<td>conductivity <a class="reference internal" href="zreferences.html#mu71" id="id4">[34]</a></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">bubbly</span></code></td>
<td>conductivity <a class="reference internal" href="zreferences.html#petb07" id="id5">[37]</a></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">a_rapid_mode</span></code></td>
<td>real</td>
<td>brine channel diameter</td>
<td>0.5x10 <span class="math">\(^{-3}\)</span> m</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">Rac_rapid_mode</span></code></td>
<td>real</td>
<td>critical Rayleigh number</td>
<td>10</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">aspect_rapid_mode</span></code></td>
<td>real</td>
<td>brine convection aspect ratio</td>
<td>1</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">dSdt_slow_mode</span></code></td>
<td>real</td>
<td>drainage strength parameter</td>
<td>-1.5x10 <span class="math">\(^{-7}\)</span> m/s/K</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">phi_c_slow_mode</span></code></td>
<td><span class="math">\(0&lt;\phi_c &lt; 1\)</span></td>
<td>critical liquid fraction</td>
<td>0.05</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">phi_i_mushy</span></code></td>
<td><span class="math">\(0&lt;\phi_i &lt; 1\)</span></td>
<td>solid fraction at lower boundary</td>
<td>0.85</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><em>dynamics_nml</em></td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td><em>Dynamics</em></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">kstrength</span></code></td>
<td><code class="docutils literal"><span class="pre">0</span></code></td>
<td>ice strength formulation <a class="reference internal" href="zreferences.html#hibler79" id="id6">[17]</a></td>
<td>1</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">1</span></code></td>
<td>ice strength formulation <a class="reference internal" href="zreferences.html#rothrock75" id="id7">[38]</a></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">krdg_partic</span></code></td>
<td><code class="docutils literal"><span class="pre">0</span></code></td>
<td>old ridging participation function</td>
<td>1</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">1</span></code></td>
<td>new ridging participation function</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">krdg_redist</span></code></td>
<td><code class="docutils literal"><span class="pre">0</span></code></td>
<td>old ridging redistribution function</td>
<td>1</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">1</span></code></td>
<td>new ridging redistribution function</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">mu_rdg</span></code></td>
<td>real</td>
<td>e-folding scale of ridged ice</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">Cf</span></code></td>
<td>real</td>
<td>ratio of ridging work to PE change in ridging</td>
<td><ol class="first last arabic simple" start="17">
<li></li>
</ol>
</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><em>shortwave_nml</em></td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td><em>Shortwave</em></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">shortwave</span></code></td>
<td><code class="docutils literal"><span class="pre">ccsm3</span></code></td>
<td>NCAR CCSM3 distribution method</td>
<td>‘dEdd’</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">dEdd</span></code></td>
<td>Delta-Eddington method</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">albedo_type</span></code></td>
<td><code class="docutils literal"><span class="pre">ccsm3</span></code></td>
<td>NCAR CCSM3 albedos</td>
<td>‘ccsm3’</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">constant</span></code></td>
<td>four constant albedos</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">albicev</span></code></td>
<td><span class="math">\(0&lt;\alpha &lt;1\)</span></td>
<td>visible ice albedo for thicker ice</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">albicei</span></code></td>
<td><span class="math">\(0&lt;\alpha &lt;1\)</span></td>
<td>near infrared ice albedo for thicker ice</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">albsnowv</span></code></td>
<td><span class="math">\(0&lt;\alpha &lt;1\)</span></td>
<td>visible, cold snow albedo</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">albsnowi</span></code></td>
<td><span class="math">\(0&lt;\alpha &lt;1\)</span></td>
<td>near infrared, cold snow albedo</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">ahmax</span></code></td>
<td>real</td>
<td>albedo is constant above this thickness</td>
<td>0.3 m</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">R_ice</span></code></td>
<td>real</td>
<td>tuning parameter for sea ice albedo from Delta-Eddington shortwave</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">R_pnd</span></code></td>
<td>real</td>
<td>… for ponded sea ice albedo …</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">R_snw</span></code></td>
<td>real</td>
<td>… for snow (broadband albedo) …</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">dT_mlt</span></code></td>
<td>real</td>
<td><span class="math">\(\Delta\)</span> temperature per <span class="math">\(\Delta\)</span> snow grain radius</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">rsnw_mlt</span></code></td>
<td>real</td>
<td>maximum melting snow grain radius</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">kalg</span></code></td>
<td>real</td>
<td>absorption coefficient for algae</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><em>ponds_nml</em></td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td><em>Melt Ponds</em></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">hp1</span></code></td>
<td>real</td>
<td>critical ice lid thickness for topo ponds</td>
<td>0.01 m</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">hs0</span></code></td>
<td>real</td>
<td>snow depth of transition to bare sea ice</td>
<td>0.03 m</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">hs1</span></code></td>
<td>real</td>
<td>snow depth of transition to pond ice</td>
<td>0.03 m</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">dpscale</span></code></td>
<td>real</td>
<td>time scale for flushing in permeable ice</td>
<td><span class="math">\(1\times 10^{-3}\)</span></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">frzpnd</span></code></td>
<td><code class="docutils literal"><span class="pre">hlid</span></code></td>
<td>Stefan refreezing with pond ice thickness</td>
<td>‘hlid’</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">cesm</span></code></td>
<td>CESM refreezing empirical formula</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">rfracmin</span></code></td>
<td><span class="math">\(0 \le r_{min} \le 1\)</span></td>
<td>minimum melt water added to ponds</td>
<td>0.15</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">rfracmax</span></code></td>
<td><span class="math">\(0 \le r_{max} \le 1\)</span></td>
<td>maximum melt water added to ponds</td>
<td>1.0</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">pndaspect</span></code></td>
<td>real</td>
<td>aspect ratio of pond changes (depth:area)</td>
<td>0.8</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><em>zbgc_nml</em></td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td><em>Biogeochemistry</em></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">tr_brine</span></code></td>
<td>true/false</td>
<td>brine height tracer</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">skl_bgc</span></code></td>
<td>true/false</td>
<td>biogeochemistry</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">bgc_flux_type</span></code></td>
<td><code class="docutils literal"><span class="pre">Jin2006</span></code></td>
<td>ice–ocean flux velocity of <a class="reference internal" href="zreferences.html#jdwstwlg06" id="id8">[23]</a></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">constant</span></code></td>
<td>constant ice–ocean flux velocity</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">restore_bgc</span></code></td>
<td>true/false</td>
<td>restore nitrate/silicate to data</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">sil_data_type</span></code></td>
<td><code class="docutils literal"><span class="pre">default</span></code></td>
<td>default forcing value for silicate</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">clim</span></code></td>
<td>silicate forcing from ocean climatology <a class="reference internal" href="zreferences.html#glba06" id="id9">[15]</a></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">nit_data_type</span></code></td>
<td><code class="docutils literal"><span class="pre">default</span></code></td>
<td>default forcing value for nitrate</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">clim</span></code></td>
<td>nitrate forcing from ocean climatology <a class="reference internal" href="zreferences.html#glba06" id="id10">[15]</a></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">sss</span></code></td>
<td>nitrate forcing equals salinity</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">tr_bgc_C_sk</span></code></td>
<td>true/false</td>
<td>algal carbon tracer</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">tr_bgc_chl_sk</span></code></td>
<td>true/false</td>
<td>algal chlorophyll tracer</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">tr_bgc_Am_sk</span></code></td>
<td>true/false</td>
<td>ammonium tracer</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">tr_bgc_Sil_sk</span></code></td>
<td>true/false</td>
<td>silicate tracer</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">tr_bgc_DMSPp_sk</span></code></td>
<td>true/false</td>
<td>particulate DMSP tracer</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">tr_bgc_DMSPd_sk</span></code></td>
<td>true/false</td>
<td>dissolved DMSP tracer</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">tr_bgc_DMS_sk</span></code></td>
<td>true/false</td>
<td>DMS tracer</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">phi_snow</span></code></td>
<td>real</td>
<td>snow porosity for brine height tracer</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><em>forcing_nml</em></td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td><em>Forcing</em></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">formdrag</span></code></td>
<td>true/false</td>
<td>calculate form drag</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">atmbndy</span></code></td>
<td><code class="docutils literal"><span class="pre">default</span></code></td>
<td>stability-based boundary layer</td>
<td>‘default’</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">constant</span></code></td>
<td>bulk transfer coefficients</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">fyear_init</span></code></td>
<td>yyyy</td>
<td>first year of atmospheric forcing data</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">ycycle</span></code></td>
<td>integer</td>
<td>number of years in forcing data cycle</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">atm_data_type</span></code></td>
<td><code class="docutils literal"><span class="pre">default</span></code></td>
<td>constant values defined in the code</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">clim</span></code></td>
<td>monthly climatology</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">CFS</span></code></td>
<td>CFS model output</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">ISPOL</span></code></td>
<td>ISPOL experiment data</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">data_dir</span></code></td>
<td>path/</td>
<td>path to forcing data directory</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">calc_strair</span></code></td>
<td>true</td>
<td>calculate wind stress and speed</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>false</td>
<td>read wind stress and speed from files</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">highfreq</span></code></td>
<td>true/false</td>
<td>high-frequency atmo coupling</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">natmiter</span></code></td>
<td>integer</td>
<td>number of atmo boundary layer iterations</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">calc_Tsfc</span></code></td>
<td>true/false</td>
<td>calculate surface temperature</td>
<td><code class="docutils literal"><span class="pre">.true.</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">precip_units</span></code></td>
<td><code class="docutils literal"><span class="pre">mks</span></code></td>
<td>liquid precipitation data units</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">mm_per_month</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">mm_per_sec</span></code></td>
<td>(same as MKS units)</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">tfrz_option</span></code></td>
<td><code class="docutils literal"><span class="pre">minus1p8</span></code></td>
<td>constant ocean freezing temperature (<span class="math">\(-1.8^\circ C\)</span>)</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">linear_salt</span></code></td>
<td>linear function of salinity (ktherm=1)</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">mushy</span></code></td>
<td>matches mushy-layer thermo (ktherm=2)</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">ustar_min</span></code></td>
<td>real</td>
<td>minimum value of ocean friction velocity</td>
<td>0.0005 m/s</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">fbot_xfer_type</span></code></td>
<td><code class="docutils literal"><span class="pre">constant</span></code></td>
<td>constant ocean heat transfer coefficient</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">Cdn_ocn</span></code></td>
<td>variable ocean heat transfer coefficient</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">update_ocn_f</span></code></td>
<td>true</td>
<td>include frazil water/salt fluxes in ocn fluxes</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>false</td>
<td>do not include (when coupling with POP)</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">l_mpond_fresh</span></code></td>
<td>true</td>
<td>retain (topo) pond water until ponds drain</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>false</td>
<td>release (topo) pond water immediately to ocean</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">oceanmixed_ice</span></code></td>
<td>true/false</td>
<td>active ocean mixed layer calculation</td>
<td><code class="docutils literal"><span class="pre">.true.</span></code> (if uncoupled)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">ocn_data_type</span></code></td>
<td><code class="docutils literal"><span class="pre">default</span></code></td>
<td>constant values defined in the code</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">ISPOL</span></code></td>
<td>ISPOL experiment data</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">bgc_data_type</span></code></td>
<td><code class="docutils literal"><span class="pre">default</span></code></td>
<td>constant values defined in the code</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal"><span class="pre">ISPOL</span></code></td>
<td>ISPOL experiment data</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">oceanmixed_file</span></code></td>
<td>filename</td>
<td>data file containing ocean forcing data</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">restore_ocn</span></code></td>
<td>true/false</td>
<td>restore sst to data</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">trestore</span></code></td>
<td>integer</td>
<td>sst restoring time scale (days)</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="adding-things">
<h2>3.5. Adding things<a class="headerlink" href="#adding-things" title="Permalink to this headline">¶</a></h2>
<p>We require that any changes made to the code be implemented in such a way that they can
be “turned off” through namelist flags.  In most cases, code run with such changes should
be bit-for-bit identical with the unmodified code.  Occasionally, non-bit-for-bit changes
are necessary, e.g. associated with an unavoidable change in the order of operations. In
these cases, changes should be made in stages to isolate the non-bit-for-bit changes,
so that those that should be bit-for-bit can be tested separately.</p>
<div class="section" id="tracers">
<span id="addtrcr"></span><h3>3.5.1. Tracers<a class="headerlink" href="#tracers" title="Permalink to this headline">¶</a></h3>
<p>Tracers added to Icepack will also require extensive modifications to the host
sea ice model, including initialization on the horizontal grid, namelist flags
and restart capabilities.  Modifications to the Icepack driver should reflect
the modifications needed in the host model but are not expected to match completely.
We recommend that the logical namelist variable
<code class="docutils literal"><span class="pre">tr_[tracer]</span></code> be used for all calls involving the new tracer outside of
<strong>ice_[tracer].F90</strong>, in case other users do not want to use that
tracer.</p>
<p>A number of optional tracers are available in the code, including ice
age, first-year ice area, melt pond area and volume, brine height,
aerosols, and level ice area and volume (from which ridged ice
quantities are derived). Salinity, enthalpies, age, aerosols, level-ice
volume, brine height and most melt pond quantities are volume-weighted
tracers, while first-year area, pond area, level-ice area and all of the
biogeochemistry tracers in this release are area-weighted tracers. In
the absence of sources and sinks, the total mass of a volume-weighted
tracer such as aerosol (kg) is conserved under transport in horizontal
and thickness space (the mass in a given grid cell will change), whereas
the aerosol concentration (kg/m) is unchanged following the motion, and
in particular, the concentration is unchanged when there is surface or
basal melting. The proper units for a volume-weighted mass tracer in the
tracer array are kg/m.</p>
<p>In several places in the code, tracer computations must be performed on
the conserved “tracer volume” rather than the tracer itself; for
example, the conserved quantity is <span class="math">\(h_{pnd}a_{pnd}a_{lvl}a_{i}\)</span>,
not <span class="math">\(h_{pnd}\)</span>. Conserved quantities are thus computed according to
the tracer dependencies, and code must be included to account for new
dependencies (e.g., <span class="math">\(a_{lvl}\)</span> and <span class="math">\(a_{pnd}\)</span> in
<strong>ice_itd.F90</strong> and <strong>ice_mechred.F90</strong>).</p>
<p>To add a tracer, follow these steps using one of the existing tracers as
a pattern.</p>
<ol class="arabic simple">
<li><strong>icedrv_domain_size.F90</strong>: increase <code class="docutils literal"><span class="pre">max_ntrcr</span></code> (can also add option
to <strong>icepack.settings</strong> and <strong>icepack.build</strong>)</li>
<li><strong>icedrv_state.F90</strong>: declare <code class="docutils literal"><span class="pre">nt_[tracer]</span></code> and <code class="docutils literal"><span class="pre">tr_[tracer]</span></code></li>
<li><strong>icepack_[tracer].F90</strong>: create initialization, physics routines</li>
<li><strong>ice_drv_init.F90</strong>: (some of this may be done in <strong>ice_[tracer].F90</strong>
instead)<ul>
<li>add new module and <code class="docutils literal"><span class="pre">tr_[tracer]</span></code> to list of used modules and
variables</li>
<li>add logical namelist variable <code class="docutils literal"><span class="pre">tr_[tracer]</span></code></li>
<li>initialize namelist variable</li>
<li>print namelist variable to diagnostic output file</li>
<li>increment number of tracers in use based on namelist input (<code class="docutils literal"><span class="pre">ntrcr</span></code>)</li>
<li>define tracer types (<code class="docutils literal"><span class="pre">trcr_depend</span></code> = 0 for ice area tracers, 1 for
ice volume, 2 for snow volume, 2+``nt_``[tracer] for dependence on
other tracers)</li>
</ul>
</li>
<li><strong>icepack_itd.F90</strong>, <strong>icepack_mechred.F90</strong>: Account for new dependencies
if needed.</li>
<li><strong>icedrv_InitMod.F90</strong>: initialize tracer (includes reading restart
file)</li>
<li><strong>icedrv_RunMod.F90</strong>, <strong>icedrv_step_mod.F90</strong>:<ul>
<li>call routine to write tracer restart data</li>
<li>call physics routines in <strong>icepack_[tracer].F90</strong> (often called from
<strong>icedrv_step_mod.F90</strong>)</li>
</ul>
</li>
<li><strong>icedrv_restart.F90</strong>: define restart variables</li>
<li><strong>icepack_in</strong>: add namelist variables to <em>tracer_nml</em> and
<em>icefields_nml</em></li>
<li>If strict conservation is necessary, add diagnostics as noted for
topo ponds in Section&nbsp;<a class="reference internal" href="icepack_2_science_guide.html#ponds"><span class="std std-ref">Melt ponds</span></a>.</li>
</ol>
</div>
</div>
<div class="section" id="troubleshooting">
<h2>3.6. Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<p>Check the FAQ: <a class="reference external" href="https://github.com/CICE-Consortium/Icepack/wiki">https://github.com/CICE-Consortium/Icepack/wiki</a></p>
<div class="section" id="initial-setup">
<span id="setup"></span><h3>3.6.1. Initial setup<a class="headerlink" href="#initial-setup" title="Permalink to this headline">¶</a></h3>
<p>If there are problems, you can manually edit
the env, Macros, and <strong>icepack.run</strong> files in the case directory until things are
working properly.  Then you can copy the env and Macros files back to
<strong>configuration/scripts/machines</strong>.</p>
<ul class="simple">
<li>Changes made directly in the run directory, e.g. to the namelist file, will be overwritten
if scripts in the case directory are run again later.</li>
<li>If changes are needed in the <strong>icepack.run.setup.csh</strong> script, it must be manually modified.</li>
</ul>
</div>
<div class="section" id="restarts">
<span id="restarttrouble"></span><h3>3.6.2. Restarts<a class="headerlink" href="#restarts" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Manual restart tests require the path to the restart file be included in <code class="docutils literal"><span class="pre">ice_in</span></code> in the
namelist file.</li>
<li>Ensure that <code class="docutils literal"><span class="pre">kcatbound</span></code> is the same as that used to create the restart file.
Other configuration parameters, such as <code class="docutils literal"><span class="pre">NICELYR</span></code>, must also be consistent between runs.</li>
</ul>
</div>
<div class="section" id="underflows">
<span id="testtrouble"></span><h3>3.6.3. Underflows<a class="headerlink" href="#underflows" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Tests using a debug flag that traps underflows will fail unless a “flush-to-zero” flag
is set in the Macros file.  This is due to very small exponential values in the delta-Eddington
radiation scheme.</li>
</ul>
</div>
<div class="section" id="debugging-hints">
<h3>3.6.4. Debugging hints<a class="headerlink" href="#debugging-hints" title="Permalink to this headline">¶</a></h3>
<p>CHECK write utility in column physics interface, for checking parameter values</p>
<p>A printing utility is available in the driver that can be helpful when debugging the
code. Not all of these will work everywhere in the code, due to possible
conflicts in module dependencies.</p>
<dl class="docutils">
<dt><em>debug_icepack</em> (<strong>configuration/driver/ice_diagnostics.F90</strong>)</dt>
<dd>A wrapper for <em>print_state</em> that is easily called from numerous
points during initialization and the timestepping loop</dd>
<dt><em>print_state</em> (<strong>configuration/driver/ice_diagnostics.F90</strong>)</dt>
<dd>Print the ice state and forcing fields for a given grid cell.</dd>
</dl>
</div>
<div class="section" id="known-bugs">
<h3>3.6.5. Known bugs<a class="headerlink" href="#known-bugs" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>With the old CCSM radiative scheme (<code class="docutils literal"><span class="pre">shortwave</span></code> = ‘default’ or
‘ccsm3’), a sizable fraction (more than 10%) of the total shortwave
radiation is absorbed at the surface but should be penetrating into
the ice interior instead. This is due to use of the aggregated,
effective albedo rather than the bare ice albedo
when <code class="docutils literal"><span class="pre">snowpatch</span></code> &lt; 1.</li>
</ul>
</div>
<div class="section" id="interpretation-of-albedos">
<h3>3.6.6. Interpretation of albedos<a class="headerlink" href="#interpretation-of-albedos" title="Permalink to this headline">¶</a></h3>
<p>The snow-and-ice albedo, <code class="docutils literal"><span class="pre">albsni</span></code>, and diagnostic albedos <code class="docutils literal"><span class="pre">albice</span></code>, <code class="docutils literal"><span class="pre">albsno</span></code>,
and <code class="docutils literal"><span class="pre">albpnd</span></code> are merged over categories but not scaled (divided) by the
total ice area. (This is a change from CICE v4.1 for <code class="docutils literal"><span class="pre">albsni</span></code>.) The latter
three history variables represent completely bare or completely snow- or
melt-pond-covered ice; that is, they do not take into account the snow
or melt pond fraction (<code class="docutils literal"><span class="pre">albsni</span></code> does, as does the code itself during
thermodyamic computations). This is to facilitate comparison with
typical values in measurements or other albedo parameterizations. The
melt pond albedo <code class="docutils literal"><span class="pre">albpnd</span></code> is only computed for the Delta-Eddington
shortwave case.</p>
<p>With the Delta-Eddington parameterization, the albedo depends on the
cosine of the zenith angle (<span class="math">\(\cos\varphi\)</span>, <code class="docutils literal"><span class="pre">coszen</span></code>) and is zero if
the sun is below the horizon (<span class="math">\(\cos\varphi &lt; 0\)</span>). Therefore
time-averaged albedo fields would be low if a diurnal solar cycle is
used, because zero values would be included in the average for half of
each 24-hour period. To rectify this, a separate counter is used for the
averaging that is incremented only when <span class="math">\(\cos\varphi &gt; 0\)</span>. The
albedos will still be zero in the dark, polar winter hemisphere.</p>
</div>
<div class="section" id="proliferating-subprocess-parameterizations">
<h3>3.6.7. Proliferating subprocess parameterizations<a class="headerlink" href="#proliferating-subprocess-parameterizations" title="Permalink to this headline">¶</a></h3>
<p>With the addition of several alternative parameterizations for sea ice
processes, a number of subprocesses now appear in multiple parts of the
code with differing descriptions. For instance, sea ice porosity and
permeability, along with associated flushing and flooding, are
calculated separately for mushy thermodynamics, topo and level-ice melt
ponds, and for the brine height tracer, each employing its own
equations. Likewise, the BL99 and mushy thermodynamics compute freeboard
and snow–ice formation differently, and the topo and level-ice melt pond
schemes both allow fresh ice to grow atop melt ponds, using slightly
different formulations for Stefan freezing. These various process
parameterizations will be compared and their subprocess descriptions
possibly unified in the future.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3. User Guide</a><ul>
<li><a class="reference internal" href="#implementation">3.1. Implementation</a><ul>
<li><a class="reference internal" href="#directory-structure">3.1.1. Directory structure</a></li>
<li><a class="reference internal" href="#grid-and-boundary-conditions">3.1.2. Grid and boundary conditions</a></li>
<li><a class="reference internal" href="#test-configurations">3.1.3. Test configurations</a></li>
<li><a class="reference internal" href="#initialization-and-forcing">3.1.4. Initialization and Forcing</a></li>
<li><a class="reference internal" href="#choosing-an-appropriate-time-step">3.1.5. Choosing an appropriate time step</a></li>
<li><a class="reference internal" href="#model-output">3.1.6. Model output</a><ul>
<li><a class="reference internal" href="#diagnostic-files">3.1.6.1. Diagnostic files</a></li>
<li><a class="reference internal" href="#restart-files">3.1.6.2. Restart files</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#running-icepack">3.2. Running Icepack</a><ul>
<li><a class="reference internal" href="#scripts">3.2.1. Scripts</a></li>
<li><a class="reference internal" href="#porting">3.2.2. Porting</a><ul>
<li><a class="reference internal" href="#input-data">3.2.2.1. Input Data</a></li>
<li><a class="reference internal" href="#machine-account-settings">3.2.2.2. Machine Account Settings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#run-directories">3.2.3. Run Directories</a></li>
<li><a class="reference internal" href="#local-modifications">3.2.4. Local modifications</a></li>
<li><a class="reference internal" href="#forcing-data">3.2.5. Forcing data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#testing-icepack">3.3. Testing Icepack</a><ul>
<li><a class="reference internal" href="#individual-tests">3.3.1. Individual Tests</a></li>
<li><a class="reference internal" href="#test-suites">3.3.2. Test suites</a></li>
<li><a class="reference internal" href="#regression-testing">3.3.3. Regression testing</a></li>
<li><a class="reference internal" href="#comparison-testing">3.3.4. Comparison testing</a></li>
<li><a class="reference internal" href="#icepack-test-reporting">3.3.5. Icepack Test Reporting</a></li>
<li><a class="reference internal" href="#examples">3.3.6. Examples</a><ul>
<li><a class="reference internal" href="#to-generate-a-baseline-dataset-for-a-test-case">3.3.6.1. To generate a baseline dataset for a test case</a></li>
<li><a class="reference internal" href="#to-run-a-test-case-and-compare-to-a-baseline-dataset">3.3.6.2. To run a test case and compare to a baseline dataset</a></li>
<li><a class="reference internal" href="#to-run-a-test-suite-to-generate-baseline-data-review-results-plot-timeseries-and-manually-report-results">3.3.6.3. To run a test suite to generate baseline data, review results, plot timeseries, and manually report results</a></li>
<li><a class="reference internal" href="#to-run-a-test-suite-compare-to-baseline-data-generate-a-new-baseline-and-automatically-report-the-results">3.3.6.4. To run a test suite, compare to baseline data, generate a new baseline, and automatically report the results</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#case-settings">3.4. Case Settings</a><ul>
<li><a class="reference internal" href="#table-of-icepack-settings">3.4.1. Table of icepack settings</a></li>
<li><a class="reference internal" href="#table-of-namelist-inputs">3.4.2. Table of namelist inputs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-things">3.5. Adding things</a><ul>
<li><a class="reference internal" href="#tracers">3.5.1. Tracers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#troubleshooting">3.6. Troubleshooting</a><ul>
<li><a class="reference internal" href="#initial-setup">3.6.1. Initial setup</a></li>
<li><a class="reference internal" href="#restarts">3.6.2. Restarts</a></li>
<li><a class="reference internal" href="#underflows">3.6.3. Underflows</a></li>
<li><a class="reference internal" href="#debugging-hints">3.6.4. Debugging hints</a></li>
<li><a class="reference internal" href="#known-bugs">3.6.5. Known bugs</a></li>
<li><a class="reference internal" href="#interpretation-of-albedos">3.6.6. Interpretation of albedos</a></li>
<li><a class="reference internal" href="#proliferating-subprocess-parameterizations">3.6.7. Proliferating subprocess parameterizations</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="icepack_2_science_guide.html"
                        title="previous chapter">2. Science Guide</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="icepack_4_developer_guide.html"
                        title="next chapter">4. Developers Guide</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/icepack_3_user_guide.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="icepack_4_developer_guide.html" title="4. Developers Guide"
             >next</a></li>
        <li class="right" >
          <a href="icepack_2_science_guide.html" title="2. Science Guide"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CICE-Consortium Icepack 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Los Alamos National Security, LLC (code) and National Center for Atmospheric Research (documentation).
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>