
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>2. Science Guide &#8212; CICE-Consortium Icepack 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. User Guide" href="icepack_3_user_guide.html" />
    <link rel="prev" title="1. Introduction - Icepack" href="icepack_1_introduction.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="icepack_3_user_guide.html" title="3. User Guide"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="icepack_1_introduction.html" title="1. Introduction - Icepack"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CICE-Consortium Icepack 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="science-guide">
<h1>2. Science Guide<a class="headerlink" href="#science-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="coupling-with-host-models">
<span id="coupl"></span><h2>2.1. Coupling with host models<a class="headerlink" href="#coupling-with-host-models" title="Permalink to this headline">¶</a></h2>
<p>Sea ice models exchange information with
other components of the earth system via a flux coupler. This is done
through the full CICE model and a thorough description of coupling sea
ice through a flux coupler can be found in the <a class="reference external" href="https://CICE-Consortium.github.io/CICE/index.html">CICE model
documentation</a>.
Important information related to flux coupling associated
with the Icepack submodule will be discussed below,
along with information about the interface between Icepack and CICE or
other host sea ice models.</p>
<div class="section" id="the-column-physics-code-interface">
<span id="intfc"></span><h3>2.1.1. The column physics code interface<a class="headerlink" href="#the-column-physics-code-interface" title="Permalink to this headline">¶</a></h3>
<p>Subroutine calls and other linkages into Icepack from the host model should only
need to access the <strong>icepack_intfc*.F90</strong> interface modules within the
<code class="docutils literal"><span class="pre">columnphysics/</span></code> directory.
The Icepack driver in the <code class="docutils literal"><span class="pre">configuration/driver/</span></code> directory is based on the CICE
model and provides an example of the sea ice host model capabilities needed for inclusion
of Icepack.  In particular, host models will need to include code equivalent to that
in the modules <strong>icepack_drv_*_column.F90</strong>.  Calls into the Icepack interface routines
are primarily from <strong>icepack_drv_step_mod.F90</strong> but there are others (search the driver code
for <code class="docutils literal"><span class="pre">intfc</span></code>).</p>
<p>Guiding principles for the creation of Icepack include the following:
CHECK THAT THESE ARE TRUE</p>
<ul class="simple">
<li>The column physics modules shall be independent of all sea ice model infrastructural
elements that may vary from model to model.  Examples include input/output, timers,
references to CPUs or computational tasks, initialization other than that necessary for
strictly physical reasons, and anything related to a horizontal grid.</li>
<li>The column physics modules shall not call or reference any routines or code that
reside outside of the <strong>columnphysics/</strong> directory.</li>
<li>Any capabilities required by a host sea ice model (e.g. calendar variables, tracer
flags, diagnostics) shall be implemented in the driver and passed into or out of the
column physics modules via array arguments.</li>
</ul>
</div>
<div class="section" id="atmosphere-and-ocean-boundary-forcing">
<h3>2.1.2. Atmosphere and ocean boundary forcing<a class="headerlink" href="#atmosphere-and-ocean-boundary-forcing" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#tab-flux-cpl"><span class="std std-ref">Table 1</span></a>: <em>Data exchanged between the CESM flux coupler and the sea ice model that are relevant to Icepack</em></p>
<span id="tab-flux-cpl"></span><table border="1" class="colwidths-given docutils" id="id119">
<caption><span class="caption-text">Table 1</span><a class="headerlink" href="#id119" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Variable</th>
<th class="head">Description</th>
<th class="head">Interaction with flux coupler</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><span class="math">\(z_o\)</span></td>
<td>Atmosphere level height</td>
<td>From <em>atmosphere model</em> via flux coupler <strong>to</strong> <em>sea ice model</em></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\vec{U}_a\)</span></td>
<td>Wind velocity</td>
<td>From <em>atmosphere model</em> via flux coupler <strong>to</strong> <em>sea ice model</em></td>
</tr>
<tr class="row-even"><td><span class="math">\(Q_a\)</span></td>
<td>Specific humidity</td>
<td>From <em>atmosphere model</em> via flux coupler <strong>to</strong> <em>sea ice model</em></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\rho_a\)</span></td>
<td>Air density</td>
<td>From <em>atmosphere model</em> via flux coupler <strong>to</strong> <em>sea ice model</em></td>
</tr>
<tr class="row-even"><td><span class="math">\(\Theta_a\)</span></td>
<td>Air potential temperature</td>
<td>From <em>atmosphere model</em> via flux coupler <strong>to</strong> <em>sea ice model</em></td>
</tr>
<tr class="row-odd"><td><span class="math">\(T_a\)</span></td>
<td>Air temperature</td>
<td>From <em>atmosphere model</em> via flux coupler <strong>to</strong> <em>sea ice model</em></td>
</tr>
<tr class="row-even"><td><span class="math">\(F_{sw\downarrow}\)</span></td>
<td>Incoming shortwave radiation (4 bands)</td>
<td>From <em>atmosphere model</em> via flux coupler <strong>to</strong> <em>sea ice model</em></td>
</tr>
<tr class="row-odd"><td><span class="math">\(F_{L\downarrow}\)</span></td>
<td>Incoming longwave radiation</td>
<td>From <em>atmosphere model</em> via flux coupler <strong>to</strong> <em>sea ice model</em></td>
</tr>
<tr class="row-even"><td><span class="math">\(F_{rain}\)</span></td>
<td>Rainfall rate</td>
<td>From <em>atmosphere model</em> via flux coupler <strong>to</strong> <em>sea ice model</em></td>
</tr>
<tr class="row-odd"><td><span class="math">\(F_{snow}\)</span></td>
<td>Snowfall rate</td>
<td>From <em>atmosphere model</em> via flux coupler <strong>to</strong> <em>sea ice model</em></td>
</tr>
<tr class="row-even"><td><span class="math">\(F_{frzmlt}\)</span></td>
<td>Freezing/melting potential</td>
<td>From <em>ocean model</em> via flux coupler <strong>to</strong> <em>sea ice model</em></td>
</tr>
<tr class="row-odd"><td><span class="math">\(T_w\)</span></td>
<td>Sea surface temperature</td>
<td>From <em>ocean model</em> via flux coupler <strong>to</strong> <em>sea ice model</em></td>
</tr>
<tr class="row-even"><td><span class="math">\(S\)</span></td>
<td>Sea surface salinity</td>
<td>From <em>ocean model</em> via flux coupler <strong>to</strong> <em>sea ice model</em></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\vec{U}_w\)</span></td>
<td>Surface ocean currents</td>
<td>From <em>ocean model</em> via flux coupler <strong>to</strong> <em>sea ice model</em> (available in Icepack driver, not used directly in column physics)</td>
</tr>
<tr class="row-even"><td><span class="math">\(\vec{\tau}_a\)</span></td>
<td>Wind stress</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> <em>atmosphere model</em></td>
</tr>
<tr class="row-odd"><td><span class="math">\(F_s\)</span></td>
<td>Sensible heat flux</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> <em>atmosphere model</em></td>
</tr>
<tr class="row-even"><td><span class="math">\(F_l\)</span></td>
<td>Latent heat flux</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> <em>atmosphere model</em></td>
</tr>
<tr class="row-odd"><td><span class="math">\(F_{L\uparrow}\)</span></td>
<td>Outgoing longwave radiation</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> <em>atmosphere model</em></td>
</tr>
<tr class="row-even"><td><span class="math">\(F_{evap}\)</span></td>
<td>Evaporated water</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> <em>atmosphere model</em></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\alpha\)</span></td>
<td>Surface albedo (4 bands)</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> <em>atmosphere model</em></td>
</tr>
<tr class="row-even"><td><span class="math">\(T_{sfc}\)</span></td>
<td>Surface temperature</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> <em>atmosphere model</em></td>
</tr>
<tr class="row-odd"><td><span class="math">\(F_{sw\Downarrow}\)</span></td>
<td>Penetrating shortwave radiation</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> <em>ocean model</em></td>
</tr>
<tr class="row-even"><td><span class="math">\(F_{water}\)</span></td>
<td>Fresh water flux</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> <em>ocean model</em></td>
</tr>
<tr class="row-odd"><td><span class="math">\(F_{hocn}\)</span></td>
<td>Net heat flux to ocean</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> <em>ocean model</em></td>
</tr>
<tr class="row-even"><td><span class="math">\(F_{salt}\)</span></td>
<td>Salt flux</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> <em>ocean model</em></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\vec{\tau}_w\)</span></td>
<td>Ice-ocean stress</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> <em>ocean model</em></td>
</tr>
<tr class="row-even"><td><span class="math">\(F_{bio}\)</span></td>
<td>Biogeochemical fluxes</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> <em>ocean model</em></td>
</tr>
<tr class="row-odd"><td><span class="math">\(a_{i}\)</span></td>
<td>Ice fraction</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> both <em>ocean and atmosphere models</em></td>
</tr>
<tr class="row-even"><td><span class="math">\(T^{ref}_{a}\)</span></td>
<td>2m reference temperature (diagnostic)</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> both <em>ocean and atmosphere models</em></td>
</tr>
<tr class="row-odd"><td><span class="math">\(Q^{ref}_{a}\)</span></td>
<td>2m reference humidity (diagnostic)</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> both <em>ocean and atmosphere models</em></td>
</tr>
<tr class="row-even"><td><span class="math">\(F_{swabs}\)</span></td>
<td>Absorbed shortwave (diagnostic)</td>
<td>From <em>sea ice model</em> via flux coupler <strong>to</strong> both <em>ocean and atmosphere models</em></td>
</tr>
</tbody>
</table>
<p>The ice fraction <span class="math">\(a_i\)</span> (aice) is the total fractional ice
coverage of a grid cell. That is, in each cell,</p>
<div class="math">
\[\begin{split}\begin{array}{cl}
               a_{i}=0 &amp; \mbox{if there is no ice} \\
               a_{i}=1 &amp; \mbox{if there is no open water} \\
               0&lt;a_{i}&lt;1 &amp; \mbox{if there is both ice and open water,}
\end{array}\end{split}\]</div>
<p>where <span class="math">\(a_{i}\)</span> is the sum of fractional ice areas for each category
of ice. The ice fraction is used by the flux coupler to merge fluxes
from the ice model with fluxes from the other components. For example,
the penetrating shortwave radiation flux, weighted by <span class="math">\(a_i\)</span>, is
combined with the net shortwave radiation flux through ice-free leads,
weighted by (<span class="math">\(1-a_i\)</span>), to obtain the net shortwave flux into the
ocean over the entire grid cell. The CESM flux coupler requires the fluxes to
be divided by the total ice area so that the ice and land models are
treated identically (land also may occupy less than 100% of an
atmospheric grid cell). These fluxes are “per unit ice area” rather than
“per unit grid cell area.”</p>
<p>In some coupled climate models (for example, recent versions of the U.K.
Hadley Centre model) the surface air temperature and fluxes are computed
within the atmosphere model and are passed to CICE for use in the column physics. In this case the
logical parameter <code class="docutils literal"><span class="pre">calc_Tsfc</span></code> in <em>ice_therm_vertical</em> is set to false.
The fields <code class="docutils literal"><span class="pre">fsurfn</span></code> (the net surface heat flux from the atmosphere), <code class="docutils literal"><span class="pre">flatn</span></code>
(the surface latent heat flux), and <code class="docutils literal"><span class="pre">fcondtopn</span></code> (the conductive flux at
the top surface) for each ice thickness category are copied or derived
from the input coupler fluxes and are passed to the thermodynamic driver
subroutine, <em>thermo_vertical</em>. At the end of the time step, the surface
temperature and effective conductivity (i.e., thermal conductivity
divided by thickness) of the top ice/snow layer in each category are
returned to the atmosphere model via the coupler. Since the ice surface
temperature is treated explicitly, the effective conductivity may need
to be limited to ensure stability. As a result, accuracy may be
significantly reduced, especially for thin ice or snow layers. A more
stable and accurate procedure would be to compute the temperature
profiles for both the atmosphere and ice, together with the surface
fluxes, in a single implicit calculation. This was judged impractical,
however, given that the atmosphere and sea ice models generally exist on
different grids and/or processor sets.</p>
<div class="section" id="atmosphere">
<span id="atmo"></span><h4>2.1.2.1. Atmosphere<a class="headerlink" href="#atmosphere" title="Permalink to this headline">¶</a></h4>
<p>The wind velocity, specific humidity, air density and potential
temperature at the given level height <span class="math">\(z_\circ\)</span> are used to
compute transfer coefficients used in formulas for the surface wind
stress and turbulent heat fluxes <span class="math">\(\vec\tau_a\)</span>, <span class="math">\(F_s\)</span>, and
<span class="math">\(F_l\)</span>, as described below. The sensible and latent heat fluxes,
<span class="math">\(F_s\)</span> and <span class="math">\(F_l\)</span>, along with shortwave and longwave
radiation, <span class="math">\(F_{sw\downarrow}\)</span>, <span class="math">\(F_{L\downarrow}\)</span>
and <span class="math">\(F_{L\uparrow}\)</span>, are included in the flux balance that
determines the ice or snow surface temperature when calc_Tsfc = true.
As described in the&nbsp;<a class="reference internal" href="#thermo"><span class="std std-ref">Thermodynamics</span></a> section, these fluxes depend nonlinearly
on the ice surface temperature <span class="math">\(T_{sfc}\)</span>. The balance
equation is iterated until convergence, and the resulting fluxes and
<span class="math">\(T_{sfc}\)</span> are then passed to the flux coupler.</p>
<p>The snowfall precipitation rate (provided as liquid water equivalent and
converted by the ice model to snow depth) also contributes to the heat
and water mass budgets of the ice layer. Melt ponds generally form on
the ice surface in the Arctic and refreeze later in the fall, reducing
the total amount of fresh water that reaches the ocean and altering the
heat budget of the ice; this version includes two new melt pond
parameterizations. Rain and all melted snow end up in the ocean.</p>
<p>Wind stress and transfer coefficients for the
turbulent heat fluxes are computed in subroutine
<em>atmo_boundary_layer</em> following <a class="reference internal" href="zreferences.html#kl02" id="id1">[28]</a>. For
clarity, the equations are reproduced here in the present notation.</p>
<p>The wind stress and turbulent heat flux calculation accounts for both
stable and unstable atmosphere–ice boundary layers. Define the
“stability”</p>
<div class="math" id="equation-upsilon">
<span class="eqno">(1)<a class="headerlink" href="#equation-upsilon" title="Permalink to this equation">¶</a></span>\[\Upsilon = {\kappa g z_\circ\over u^{*2}}
\left({\Theta^*\over\Theta_a\left(1+0.606Q_a\right)}  +
{Q^*\over 1/0.606 + Q_a}\right),\]</div>
<p>where <span class="math">\(\kappa\)</span> is the von Karman constant, <span class="math">\(g\)</span> is
gravitational acceleration, and <span class="math">\(u^*\)</span>, <span class="math">\(\Theta^*\)</span> and
<span class="math">\(Q^*\)</span> are turbulent scales for velocity, temperature, and humidity,
respectively:</p>
<div class="math" id="equation-stars">
<span class="eqno">(2)<a class="headerlink" href="#equation-stars" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
u^*&amp;=&amp;c_u \left|\vec{U}_a\right|, \\
\Theta^*&amp;=&amp; c_\theta\left(\Theta_a-T_{sfc}\right), \\
Q^*&amp;=&amp;c_q\left(Q_a-Q_{sfc}\right).\end{aligned}\end{split}\]</div>
<p>The wind speed has a minimum value of 1 m/s. We have ignored ice motion
in <span class="math">\(u^*\)</span>, and <span class="math">\(T_{sfc}\)</span> and
<span class="math">\(Q_{sfc}\)</span> are the surface temperature and specific
humidity, respectively. The latter is calculated by assuming a saturated
surface, as described in the&nbsp;<a class="reference internal" href="#sfc-forcing"><span class="std std-ref">Thermodynamic surface forcing balance</span></a> section.</p>
<p>Neglecting form drag,the exchange coefficients <span class="math">\(c_u\)</span>,
<span class="math">\(c_\theta\)</span> and <span class="math">\(c_q\)</span> are initialized as</p>
<div class="math" id="equation-kappa">
<span class="eqno">(3)<a class="headerlink" href="#equation-kappa" title="Permalink to this equation">¶</a></span>\[\kappa\over \ln(z_{ref}/z_{ice})\]</div>
<p>and updated during a short iteration, as they depend upon the turbulent
scales. The number of iterations is set by the namelist variable
<code class="docutils literal"><span class="pre">natmiter</span></code>. (For the case with form drag, see the&nbsp;<a class="reference internal" href="#formdrag"><span class="std std-ref">Variable exchange coefficients</span></a> section.)
Here, <span class="math">\(z_{ref}\)</span> is a reference height of 10m and
<span class="math">\(z_{ice}\)</span> is the roughness length scale for the given
sea ice category. <span class="math">\(\Upsilon\)</span> is constrained to have magnitude less
than 10. Further, defining
<span class="math">\(\chi = \left(1-16\Upsilon\right)^{0.25}\)</span> and <span class="math">\(\chi \geq 1\)</span>,
the “integrated flux profiles” for momentum and stability in the
unstable (<span class="math">\(\Upsilon &lt;0\)</span>) case are given by</p>
<div class="math" id="equation-psi1">
<span class="eqno">(4)<a class="headerlink" href="#equation-psi1" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
\psi_m = &amp;\mbox{}&amp;2\ln\left[0.5(1+\chi)\right] +
         \ln\left[0.5(1+\chi^2)\right] -2\tan^{-1}\chi +
         {\pi\over 2}, \\
\psi_s = &amp;\mbox{}&amp;2\ln\left[0.5(1+\chi^2)\right].\end{aligned}\end{split}\]</div>
<p>In a departure from the parameterization used in
<a class="reference internal" href="zreferences.html#kl02" id="id2">[28]</a>, we use profiles for the stable case
following <a class="reference internal" href="zreferences.html#jam99" id="id3">[27]</a>,</p>
<div class="math" id="equation-psi2">
<span class="eqno">(5)<a class="headerlink" href="#equation-psi2" title="Permalink to this equation">¶</a></span>\[\psi_m = \psi_s = -\left[0.7\Upsilon + 0.75\left(\Upsilon-14.3\right)
         \exp\left(-0.35\Upsilon\right) + 10.7\right].\]</div>
<p>The coefficients are then updated as</p>
<div class="math" id="equation-coeff1">
<span class="eqno">(6)<a class="headerlink" href="#equation-coeff1" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
c_u^\prime&amp;=&amp;{c_u\over 1+c_u\left(\lambda-\psi_m\right)/\kappa} \\
c_\theta^\prime&amp;=&amp; {c_\theta\over 1+c_\theta\left(\lambda-\psi_s\right)/\kappa}\\
c_q^\prime&amp;=&amp;c_\theta^\prime\end{aligned}\end{split}\]</div>
<p>where <span class="math">\(\lambda = \ln\left(z_\circ/z_{ref}\right)\)</span>. The
first iteration ends with new turbulent scales from
equations&nbsp;<a class="reference internal" href="#equation-stars">(2)</a>. After five iterations the latent and sensible
heat flux coefficients are computed, along with the wind stress:</p>
<div class="math" id="equation-coeff2">
<span class="eqno">(7)<a class="headerlink" href="#equation-coeff2" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
C_l&amp;=&amp;\rho_a \left(L_{vap}+L_{ice}\right) u^* c_q \\
C_s&amp;=&amp;\rho_a c_p u^* c_\theta^* + 1, \\
\vec{\tau}_a&amp;=&amp;{\rho_a u^{*2}\vec{U}_a\over |\vec{U}_a|},\end{aligned}\end{split}\]</div>
<p>where <span class="math">\(L_{vap}\)</span> and <span class="math">\(L_{ice}\)</span> are
latent heats of vaporization and fusion, <span class="math">\(\rho_a\)</span> is the density
of air and <span class="math">\(c_p\)</span> is its specific heat. Again following
<a class="reference internal" href="zreferences.html#jam99" id="id4">[27]</a>, we have added a constant to the sensible
heat flux coefficient in order to allow some heat to pass between the
atmosphere and the ice surface in stable, calm conditions.</p>
<p>The atmospheric reference temperature <span class="math">\(T_a^{ref}\)</span> is computed from
<span class="math">\(T_a\)</span> and <span class="math">\(T_{sfc}\)</span> using the coefficients
<span class="math">\(c_u\)</span>, <span class="math">\(c_\theta\)</span> and <span class="math">\(c_q\)</span>. Although the sea ice
model does not use this quantity, it is convenient for the ice model to
perform this calculation. The atmospheric reference temperature is
returned to the flux coupler as a climate diagnostic. The same is true
for the reference humidity, <span class="math">\(Q_a^{ref}\)</span>.</p>
<p>Additional details about the latent and sensible heat fluxes and other
quantities referred to here can be found in
the&nbsp;<a class="reference internal" href="#sfc-forcing"><span class="std std-ref">Thermodynamic surface forcing balance</span></a> section.</p>
</div>
<div class="section" id="ocean">
<span id="id5"></span><h4>2.1.2.2. Ocean<a class="headerlink" href="#ocean" title="Permalink to this headline">¶</a></h4>
<p>New sea ice forms when the ocean temperature drops below its freezing
temperature. In the Bitz and Lipscomb thermodynamics,
<a class="reference internal" href="zreferences.html#bl99" id="id6">[7]</a> <span class="math">\(T_f=-\mu S\)</span>, where <span class="math">\(S\)</span> is the
seawater salinity and <span class="math">\(\mu=0.054 \ ^\circ\)</span>/ppt is the ratio of the
freezing temperature of brine to its salinity (linear liquidus
approximation). For the mushy thermodynamics, <span class="math">\(T_f\)</span> is given by a
piecewise linear liquidus relation. The ocean model calculates the new
ice formation; if the freezing/melting potential
<span class="math">\(F_{frzmlt}\)</span> is positive, its value represents a certain
amount of frazil ice that has formed in one or more layers of the ocean
and floated to the surface. (The ocean model assumes that the amount of
new ice implied by the freezing potential actually forms.)</p>
<p>If <span class="math">\(F_{frzmlt}\)</span> is negative, it is used to heat already
existing ice from below. In particular, the sea surface temperature and
salinity are used to compute an oceanic heat flux <span class="math">\(F_w\)</span>
(<span class="math">\(\left|F_w\right| \leq \left|F_{frzmlt}\right|\)</span>) which
is applied at the bottom of the ice. The portion of the melting
potential actually used to melt ice is returned to the coupler in
<span class="math">\(F_{hocn}\)</span>. The ocean model adjusts its own heat budget
with this quantity, assuming that the rest of the flux remained in the
ocean.</p>
<p>In addition to runoff from rain and melted snow, the fresh water flux
<span class="math">\(F_{water}\)</span> includes ice melt water from the top surface
and water frozen (a negative flux) or melted at the bottom surface of
the ice. This flux is computed as the net change of fresh water in the
ice and snow volume over the coupling time step, excluding frazil ice
formation and newly accumulated snow. Setting the namelist option
update_ocn_f to true causes frazil ice to be included in the fresh
water and salt fluxes.</p>
<p>There is a flux of salt into the ocean under melting conditions, and a
(negative) flux when sea water is freezing. However, melting sea ice
ultimately freshens the top ocean layer, since the ocean is much more
saline than the ice. The ice model passes the net flux of salt
<span class="math">\(F_{salt}\)</span> to the flux coupler, based on the net change
in salt for ice in all categories. In the present configuration,
ice_ref_salinity is used for computing the salt flux, although the ice
salinity used in the thermodynamic calculation has differing values in
the ice layers.</p>
<p>A fraction of the incoming shortwave <span class="math">\(F_{sw\Downarrow}\)</span>
penetrates the snow and ice layers and passes into the ocean, as
described in the&nbsp;<a class="reference internal" href="#sfc-forcing"><span class="std std-ref">Thermodynamic surface forcing balance</span></a> section.</p>
<p>CHECK icepack_ocean.F90?</p>
<p>A thermodynamic slab ocean mixed-layer parameterization is available
in <strong>icepack_ocean.F90</strong> and can be run in the full CICE configuration.
The turbulent fluxes are computed above the water surface using the same
parameterizations as for sea ice, but with parameters appropriate for
the ocean. The surface flux balance takes into account the turbulent
fluxes, oceanic heat fluxes from below the mixed layer, and shortwave
and longwave radiation, including that passing through the sea ice into
the ocean. If the resulting sea surface temperature falls below the
salinity-dependent freezing point, then new ice (frazil) forms.
Otherwise, heat is made available for melting the ice.</p>
</div>
<div class="section" id="variable-exchange-coefficients">
<span id="formdrag"></span><h4>2.1.2.3. Variable exchange coefficients<a class="headerlink" href="#variable-exchange-coefficients" title="Permalink to this headline">¶</a></h4>
<p>In the default configuration, atmospheric and oceanic neutral drag
coefficients (<span class="math">\(c_u\)</span> and <span class="math">\(c_w\)</span>) are assumed constant in time
and space. These constants are chosen to reflect friction associated
with an effective sea ice surface roughness at the ice–atmosphere and
ice–ocean interfaces. Sea ice (in both Arctic and Antarctic) contains
pressure ridges as well as floe and melt pond edges that act as discrete
obstructions to the flow of air or water past the ice, and are a source
of form drag. Following <a class="reference internal" href="zreferences.html#tfsffklb14" id="id7">[51]</a> and based on
recent theoretical developments <a class="reference internal" href="zreferences.html#lgha12" id="id8">[34]</a><a class="reference internal" href="zreferences.html#llcl11" id="id9">[33]</a>, the
neutral drag coefficients can now be estimated from properties of the
ice cover such as ice concentration, vertical extent and area of the
ridges, freeboard and floe draft, and size of floes and melt ponds. The
new parameterization allows the drag coefficients to be coupled to the
sea ice state and therefore to evolve spatially and temporally. This
parameterization is contained in the subroutine <em>neutral_drag_coeffs</em>
and is accessed by setting <cite>formdrag</cite> = true in the namelist.</p>
<p>Following <a class="reference internal" href="zreferences.html#tfsffklb14" id="id10">[51]</a>, consider the general case of
fluid flow obstructed by N randomly oriented obstacles of height
<span class="math">\(H\)</span> and transverse length <span class="math">\(L_y\)</span>, distributed on a domain
surface area <span class="math">\(S_T\)</span>. Under the assumption of a logarithmic fluid
velocity profile, the general formulation of the form drag coefficient
can be expressed as</p>
<div class="math" id="equation-formdrag">
<span class="eqno">(8)<a class="headerlink" href="#equation-formdrag" title="Permalink to this equation">¶</a></span>\[C_d=\frac{N c S_c^2 \gamma L_y  H}{2 S_T}\left[\frac{\ln(H/z_0)}{\ln(z_{ref}/z_0)}\right]^2,\]</div>
<p>where <span class="math">\(z_0\)</span> is a roughness length parameter at the top or bottom
surface of the ice, <span class="math">\(\gamma\)</span> is a geometric factor, <span class="math">\(c\)</span> is
the resistance coefficient of a single obstacle, and <span class="math">\(S_c\)</span> is a
sheltering function that takes into account the shielding effect of the
obstacle,</p>
<div class="math" id="equation-shelter">
<span class="eqno">(9)<a class="headerlink" href="#equation-shelter" title="Permalink to this equation">¶</a></span>\[S_{c}=\left(1-\exp(-s_l D/H)\right)^{1/2},\]</div>
<p>with <span class="math">\(D\)</span> the distance between two obstacles and <span class="math">\(s_l\)</span> an
attenuation parameter.</p>
<p>As in the original drag formulation in CICE (<a class="reference internal" href="#atmo"><span class="std std-ref">Atmosphere</span></a> and
<a class="reference internal" href="#ocean"><span class="std std-ref">Ocean</span></a> sections), <span class="math">\(c_u\)</span> and <span class="math">\(c_w\)</span> along with the transfer
coefficients for sensible heat, <span class="math">\(c_{\theta}\)</span>, and latent heat,
<span class="math">\(c_{q}\)</span>, are initialized to a situation corresponding to neutral
atmosphere–ice and ocean–ice boundary layers. The corresponding neutral
exchange coefficients are then replaced by coefficients that explicitly
account for form drag, expressed in terms of various contributions as</p>
<div class="math" id="equation-Cda">
<span class="eqno">(10)<a class="headerlink" href="#equation-Cda" title="Permalink to this equation">¶</a></span>\[\tt{Cdn\_atm}  = \tt{Cdn\_atm\_rdg} + \tt{Cdn\_atm\_floe} + \tt{Cdn\_atm\_skin} + \tt{Cdn\_atm\_pond} ,\]</div>
<div class="math" id="equation-Cdw">
<span class="eqno">(11)<a class="headerlink" href="#equation-Cdw" title="Permalink to this equation">¶</a></span>\[\tt{Cdn\_ocn}  =  \tt{Cdn\_ocn\_rdg} + \tt{Cdn\_ocn\_floe} + \tt{Cdn\_ocn\_skin}.\]</div>
<p>The contributions to form drag from ridges (and keels underneath the
ice), floe edges and melt pond edges can be expressed using the general
formulation of equation <a class="reference internal" href="#equation-formdrag">(8)</a> (see <a class="reference internal" href="zreferences.html#tfsffklb14" id="id11">[51]</a> for
details). Individual terms in equation <a class="reference internal" href="#equation-Cdw">(11)</a> are fully described in
<a class="reference internal" href="zreferences.html#tfsffklb14" id="id12">[51]</a>. Following <a class="reference internal" href="zreferences.html#arya75" id="id13">[4]</a>
the skin drag coefficient is parametrized as</p>
<div class="math" id="equation-skindrag">
<span class="eqno">(12)<a class="headerlink" href="#equation-skindrag" title="Permalink to this equation">¶</a></span>\[{ \tt{Cdn\_(atm/ocn)\_skin}}=a_{i} \left(1-m_{(s/k)} \frac{H_{(s/k)}}{D_{(s/k)}}\right)c_{s(s/k)}, \mbox{       if  $\displaystyle\frac{H_{(s/k)}}{D_{(s/k)}}\ge\frac{1}{m_{(s/k)}}$,}\]</div>
<p>where <span class="math">\(m_s\)</span> (<span class="math">\(m_k\)</span>) is a sheltering parameter that depends
on the average sail (keel) height, <span class="math">\(H_s\)</span> (<span class="math">\(H_k\)</span>), but is
often assumed constant, <span class="math">\(D_s\)</span> (<span class="math">\(D_k\)</span>) is the average
distance between sails (keels), and <span class="math">\(c_{ss}\)</span> (<span class="math">\(c_{sk}\)</span>) is
the unobstructed atmospheric (oceanic) skin drag that would be attained
in the absence of sails (keels) and with complete ice coverage,
<span class="math">\(a_{ice}=1\)</span>.</p>
<p>Calculation of equations <a class="reference internal" href="#equation-formdrag">(8)</a> – <a class="reference internal" href="#equation-skindrag">(12)</a> requires that small-scale geometrical
properties of the ice cover be related to average grid cell quantities
already computed in the sea ice model. These intermediate quantities are
briefly presented here and described in more detail in
<a class="reference internal" href="zreferences.html#tfsffklb14" id="id14">[51]</a>. The sail height is given by</p>
<div class="math" id="equation-Hs">
<span class="eqno">(13)<a class="headerlink" href="#equation-Hs" title="Permalink to this equation">¶</a></span>\[H_{s} = \displaystyle 2\frac{v_{rdg}}{a_{rdg}}\left(\frac{\alpha\tan \alpha_{k} R_d+\beta \tan \alpha_{s} R_h}{\phi_r\tan \alpha_{k} R_d+\phi_k \tan \alpha_{s} R_h^2}\right),\]</div>
<p>and the distance between sails</p>
<div class="math" id="equation-Ds">
<span class="eqno">(14)<a class="headerlink" href="#equation-Ds" title="Permalink to this equation">¶</a></span>\[D_{s} = \displaystyle 2 H_s\frac{a_{i}}{a_{rdg}} \left(\frac{\alpha}{\tan \alpha_s}+\frac{\beta}{\tan \alpha_k}\frac{R_h}{R_d}\right),\]</div>
<p>where <span class="math">\(0&lt;\alpha&lt;1\)</span> and <span class="math">\(0&lt;\beta&lt;1\)</span> are weight functions,
<span class="math">\(\alpha_{s}\)</span> and <span class="math">\(\alpha_{k}\)</span> are the sail and keel slope,
<span class="math">\(\phi_s\)</span> and <span class="math">\(\phi_k\)</span> are constant porosities for the sails
and keels, and we assume constant ratios for the average keel depth and
sail height (<span class="math">\(H_k/H_s=R_h\)</span>) and for the average distances between
keels and between sails (<span class="math">\(D_k/D_s=R_d\)</span>). With the assumption of
hydrostatic equilibrium, the effective ice plus snow freeboard is
<span class="math">\(H_{f}=\bar{h_i}(1-\rho_i/\rho_w)+\bar{h_s}(1-\rho_s/\rho_w)\)</span>,
where <span class="math">\(\rho_i\)</span>, <span class="math">\(\rho_w\)</span> and <span class="math">\(\rho_s\)</span> are
respectively the densities of sea ice, water and snow, <span class="math">\(\bar{h_i}\)</span>
is the mean ice thickness and <span class="math">\(\bar{h_s}\)</span> is the mean snow
thickness (means taken over the ice covered regions). For the melt pond
edge elevation we assume that the melt pond surface is at the same level
as the ocean surface surrounding the floes
<a class="reference internal" href="zreferences.html#ff07" id="id15">[15]</a><a class="reference internal" href="zreferences.html#fft10" id="id16">[16]</a><a class="reference internal" href="zreferences.html#fsfh12" id="id17">[17]</a> and use the simplification
<span class="math">\(H_p = H_f\)</span>. Finally to estimate the typical floe size
<span class="math">\(L_A\)</span>, distance between floes, <span class="math">\(D_F\)</span>, and melt pond size,
<span class="math">\(L_P\)</span> we use the parameterizations of <a class="reference internal" href="zreferences.html#lgha12" id="id18">[34]</a>
to relate these quantities to the ice and pond concentrations. All of
these intermediate quantities are available for output, along
with <code class="docutils literal"><span class="pre">Cdn_atm</span></code>, <code class="docutils literal"><span class="pre">Cdn_ocn</span></code> and the ratio <code class="docutils literal"><span class="pre">Cdn_atm_ratio_n</span></code> between the
total atmospheric drag and the atmospheric neutral drag coefficient.</p>
<p>We assume that the total neutral drag coefficients are thickness
category independent, but through their dependance on the diagnostic
variables described above, they vary both spatially and temporally. The
total drag coefficients and heat transfer coefficients will also depend
on the type of stratification of the atmosphere and the ocean, and we
use the parameterization described in the <a class="reference internal" href="#atmo"><span class="std std-ref">Atmosphere</span></a> section that accounts
for both stable and unstable atmosphere–ice boundary layers. In contrast
to the neutral drag coefficients the stability effect of the atmospheric
boundary layer is calculated separately for each ice thickness category.</p>
<p>The transfer coefficient for oceanic heat flux to the bottom of the ice
may be varied based on form drag considerations by setting the namelist
variable <code class="docutils literal"><span class="pre">fbot_xfer_type</span></code> to <code class="docutils literal"><span class="pre">Cdn_ocn</span></code>; this is recommended when using
the form drag parameterization. Its default value of the transfer
coefficient is 0.006 (<code class="docutils literal"><span class="pre">fbot_xfer_type</span> <span class="pre">=</span> <span class="pre">’constant’</span></code>).</p>
</div>
</div>
</div>
<div class="section" id="model-components">
<span id="model-comp"></span><h2>2.2. Model components<a class="headerlink" href="#model-components" title="Permalink to this headline">¶</a></h2>
<p>The Arctic and Antarctic sea ice packs are mixtures of open water, thin
first-year ice, thicker multiyear ice, and thick pressure ridges. The
thermodynamic and dynamic properties of the ice pack depend on how much
ice lies in each thickness range. Thus the basic problem in sea ice
modeling is to describe the evolution of the ice thickness distribution
(ITD) in time and space.</p>
<p>The fundamental equation solved by CICE is <a class="reference internal" href="zreferences.html#trmc75" id="id19">[49]</a>:</p>
<div class="math" id="equation-transport-g">
<span class="eqno">(15)<a class="headerlink" href="#equation-transport-g" title="Permalink to this equation">¶</a></span>\[\frac{\partial g}{\partial t} = -\nabla \cdot (g {\bf u})
 - \frac{\partial}{\partial h} (f g) + \psi - L,\]</div>
<p>where <span class="math">\({\bf u}\)</span> is the horizontal ice velocity,
<span class="math">\(\nabla = (\frac{\partial}{\partial x}, \frac{\partial}{\partial y})\)</span>,
<span class="math">\(f\)</span> is the rate of thermodynamic ice growth, <span class="math">\(\psi\)</span> is a
ridging redistribution function,
<span class="math">\(L\)</span> is the lateral melt rate
and <span class="math">\(g\)</span> is the ice thickness
distribution function. We define <span class="math">\(g({\bf x},h,t)\,dh\)</span> as the
fractional area covered by ice in the thickness range <span class="math">\((h,h+dh)\)</span>
at a given time and location.  Icepack represents all of the terms in this
equation except for the divergence (the first term on the right).</p>
<p>Equation&nbsp;<a class="reference internal" href="#equation-transport-g">(15)</a> is solved by partitioning the ice pack in
each grid cell into discrete thickness categories. The number of
categories can be set by the user, with a default value <span class="math">\(N_C = 5\)</span>.
(Five categories, plus open water, are generally sufficient to simulate
the annual cycles of ice thickness, ice strength, and surface fluxes
<a class="reference internal" href="zreferences.html#bhwe01" id="id20">[6]</a><a class="reference internal" href="zreferences.html#lipscomb01" id="id21">[31]</a>.) Each category <span class="math">\(n\)</span> has
lower thickness bound <span class="math">\(H_{n-1}\)</span> and upper bound <span class="math">\(H_n\)</span>. The
lower bound of the thinnest ice category, <span class="math">\(H_0\)</span>, is set to zero.
The other boundaries are chosen with greater resolution for small
<span class="math">\(h\)</span>, since the properties of the ice pack are especially sensitive
to the amount of thin ice <a class="reference internal" href="zreferences.html#maykut82" id="id22">[35]</a>. The continuous
function <span class="math">\(g(h)\)</span> is replaced by the discrete variable
<span class="math">\(a_{in}\)</span>, defined as the fractional area covered by ice in the
open water by <span class="math">\(a_{i0}\)</span>, giving <span class="math">\(\sum_{n=0}^{N_C} a_{in} = 1\)</span>
by definition.</p>
<p>Category boundaries are computed in <em>init_itd</em> using one of several
formulas, summarized in&nbsp;<a class="reference internal" href="#tab-itd"><span class="std std-ref">Table 2</span></a>.
Setting the namelist variable <code class="docutils literal"><span class="pre">kcatbound</span></code> equal to 0 or 1 gives lower
thickness boundaries for any number of thickness categories <span class="math">\(N_C\)</span>.
<a class="reference internal" href="#tab-itd"><span class="std std-ref">Table 2</span></a> shows the boundary values for <span class="math">\(N_C\)</span> = 5 and linear remapping
of the ice thickness distribution. A third option specifies the boundaries
based on the World Meteorological Organization classification; the full WMO
thickness distribution is used if <span class="math">\(N_C\)</span> = 7; if <span class="math">\(N_C\)</span> = 5 or
6, some of the thinner categories are combined. The original formula
(<code class="docutils literal"><span class="pre">kcatbound</span></code> = 0) is the default. Category boundaries differ from those
shown in <a class="reference internal" href="#tab-itd"><span class="std std-ref">Table 2</span></a> for the delta-function ITD. Users may
substitute their own preferred boundaries in <em>init_itd</em>.</p>
<p><a class="reference internal" href="#tab-itd"><span class="std std-ref">Table 2</span></a> : <em>Lower boundary values for thickness categories, in meters, for
the three distribution options (</em> <code class="docutils literal"><span class="pre">kcatbound</span></code> <em>) and linear remapping (</em> <cite>kitd</cite> = 1 <em>).
In the WMO case, the distribution used depends on the number of categories used.</em></p>
<span id="tab-itd"></span><table border="1" class="docutils" id="id120">
<caption><span class="caption-text">Table 2</span><a class="headerlink" href="#id120" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="26%" />
<col width="20%" />
<col width="15%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">distribution</th>
<th class="head">original</th>
<th class="head">round</th>
<th class="head" colspan="3">WMO</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><cite>kcatbound</cite></td>
<td>0</td>
<td>1</td>
<td colspan="3">2</td>
</tr>
<tr class="row-odd"><td><span class="math">\(N_C\)</span></td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>6</td>
<td>7</td>
</tr>
<tr class="row-even"><td>categories</td>
<td colspan="5">lower bound (m)</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
</tr>
<tr class="row-even"><td>2</td>
<td>0.64</td>
<td>0.60</td>
<td>0.30</td>
<td>0.15</td>
<td>0.10</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>1.39</td>
<td>1.40</td>
<td>0.70</td>
<td>0.30</td>
<td>0.15</td>
</tr>
<tr class="row-even"><td>4</td>
<td>2.47</td>
<td>2.40</td>
<td>1.20</td>
<td>0.70</td>
<td>0.30</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>4.57</td>
<td>3.60</td>
<td>2.00</td>
<td>1.20</td>
<td>0.70</td>
</tr>
<tr class="row-even"><td>6</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>2.00</td>
<td>1.20</td>
</tr>
<tr class="row-odd"><td>7</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>2.00</td>
</tr>
</tbody>
</table>
<div class="section" id="tracers">
<span id="id23"></span><h3>2.2.1. Tracers<a class="headerlink" href="#tracers" title="Permalink to this headline">¶</a></h3>
<p>Numerous tracers are available with the column physics.  Several of these are
required (surface temperature and thickness, salinity and enthalpy of ice and snow layers),
and many others are options.  For instance, there are tracers to track the age of the ice;
the area of first-year ice, fractions of ice area and volume that are level, from which
the amount of deformed ice can be calculated; pond area, volume and ice-covered volume;
aerosols and numerous other biogeochemical tracers.</p>
<div class="section" id="tracers-that-depend-on-other-tracers">
<span id="pondtr"></span><h4>2.2.1.1. Tracers that depend on other tracers<a class="headerlink" href="#tracers-that-depend-on-other-tracers" title="Permalink to this headline">¶</a></h4>
<p>Tracers may be defined that depend on other tracers. Melt pond tracers
provide an example (these equations pertain to cesm and topo tracers;
level-ice tracers are similar with an extra factor of <span class="math">\(a_{lvl}\)</span>,
see Equations&nbsp;<a class="reference internal" href="#equation-transport-lvl">(78)</a>–<a class="reference internal" href="#equation-transport-ipnd-lvl">(81)</a>. Conservation
equations for pond area fraction <span class="math">\(a_{pnd}a_i\)</span> and pond volume
<span class="math">\(h_{pnd}a_{pnd}a_i\)</span>, given the ice velocity <span class="math">\(\bf u\)</span>, are</p>
<div class="math" id="equation-transport-apnd">
<span class="eqno">(16)<a class="headerlink" href="#equation-transport-apnd" title="Permalink to this equation">¶</a></span>\[{\partial\over\partial t} (a_{pnd}a_{i}) + \nabla \cdot (a_{pnd}a_{i} {\bf u}) = 0,\]</div>
<div class="math" id="equation-transport-hpnd">
<span class="eqno">(17)<a class="headerlink" href="#equation-transport-hpnd" title="Permalink to this equation">¶</a></span>\[{\partial\over\partial t} (h_{pnd}a_{pnd}a_{i}) + \nabla \cdot (h_{pnd}a_{pnd}a_{i} {\bf u}) = 0.\]</div>
<p>(These equations represent quantities within one thickness category;
all melt pond calculations are performed for each category, separately.)
Equation <a class="reference internal" href="#equation-transport-hpnd">(17)</a> expresses conservation of melt pond
volume, but in this form highlights that the quantity tracked in the
code is the pond depth tracer <span class="math">\(h_{pnd}\)</span>, which depends on the pond
area tracer <span class="math">\(a_{pnd}\)</span>. Likewise, <span class="math">\(a_{pnd}\)</span> is a tracer on
ice area (Equation&nbsp;<a class="reference internal" href="#equation-transport-apnd">(16)</a>), which is a state variable, not a
tracer.</p>
<p>For a generic quantity <span class="math">\(q\)</span> that represents a mean value over the
ice fraction, <span class="math">\(q a_i\)</span> is the average value over the grid cell.
Thus for cesm or topo melt ponds, <span class="math">\(h_{pnd}\)</span> can be considered the
actual pond depth, <span class="math">\(h_{pnd}a_{pnd}\)</span> is the mean pond depth over
the sea ice, and <span class="math">\(h_{pnd}a_{pnd}a_i\)</span> is the mean pond depth over
the grid cell. These quantities are illustrated in <a class="reference internal" href="#fig-tracers"><span class="std std-ref">Figure 1</span></a>.</p>
<div class="figure align-center" id="id121">
<span id="fig-tracers"></span><a class="reference internal image-reference" href="_images/tracergraphic.png"><img alt="_images/tracergraphic.png" src="_images/tracergraphic.png" style="width: 588.5px; height: 324.5px;" /></a>
<p class="caption"><span class="caption-text">Figure 1</span></p>
</div>
<p><a class="reference internal" href="#fig-tracers"><span class="std std-ref">Figure 1</span></a> : Melt pond tracer definitions. The graphic on the right
illustrates the <em>grid cell</em> fraction of ponds or level ice as defined
by the tracers. The chart on the left provides corresponding ice
thickness and pond depth averages over the grid cell, sea ice and
pond area fractions.</p>
<p>Tracers may need to be modified for physical reasons outside of the
“core” module or subroutine describing their evolution. For example,
when new ice forms in open water, the new ice does not yet have ponds on
it. Likewise when sea ice deforms, we assume that pond water (and ice)
on the portion of ice that ridges is lost to the ocean.</p>
<p>When new ice is added to a grid cell, the <em>grid cell</em> total area of melt
ponds is preserved within each category gaining ice,
<span class="math">\(a_{pnd}^{t+\Delta t}a_{i}^{t+\Delta t} = a_{pnd}^{t}a_{i}^{t}\)</span>,
or</p>
<div class="math" id="equation-apnd">
<span class="eqno">(18)<a class="headerlink" href="#equation-apnd" title="Permalink to this equation">¶</a></span>\[a_{pnd}^{t+\Delta t}= {a_{pnd}^{t}a_{i}^{t} \over a_{i}^{t+\Delta t} }.\]</div>
<p>Similar calculations are performed for all tracer types, for example
tracer-on-tracer dependencies such as <span class="math">\(h_{pnd}\)</span>, when needed:</p>
<div class="math" id="equation-hpnd">
<span class="eqno">(19)<a class="headerlink" href="#equation-hpnd" title="Permalink to this equation">¶</a></span>\[h_{pnd}^{t+\Delta t}= {h_{pnd}^{t}a_{pnd}^{t}a_{i}^{t} \over a_{pnd}^{t+\Delta t}a_{i}^{t+\Delta t} }.\]</div>
<p>In this case (adding new ice), <span class="math">\(h_{pnd}\)</span> does not change because
<span class="math">\(a_{pnd}^{t+\Delta t}a_{i}^{t+\Delta t} = a_{pnd}^{t}a_{i}^{t}\)</span>.</p>
<p>When ice is transferred between two thickness categories, we conserve
the total pond area summed over categories <span class="math">\(n\)</span>,</p>
<div class="math" id="equation-apnd2">
<span class="eqno">(20)<a class="headerlink" href="#equation-apnd2" title="Permalink to this equation">¶</a></span>\[\sum_n a_{pnd}^{t+\Delta t}(n)a_{i}^{t+\Delta t}(n) = \sum_n a_{pnd}^{t}(n)a_{i}^{t}(n).\]</div>
<p>Thus,</p>
<div class="math" id="equation-apnd3">
<span class="eqno">(21)<a class="headerlink" href="#equation-apnd3" title="Permalink to this equation">¶</a></span>\[\begin{split}a_{pnd}^{t+\Delta t}(m) &amp;= {\sum_n a_{pnd}^{t}(n)a_{i}^{t}(n) - \sum_{n\ne m} a_{pnd}^{t+\Delta t}(n)a_{i}^{t+\Delta t}(n) \over a_i^{t+\Delta t}(m)  } \\
&amp;= {a_{pnd}^t(m)a_i^t(m) + \sum_{n\ne m} \Delta \left(a_{pnd}a_i\right)^{t+\Delta t} \over a_i^{t+\Delta t}(m)  }\end{split}\]</div>
<p>This is more complicated because of the <span class="math">\(\Delta\)</span> term on the
right-hand side, which is handled in subroutine <em>icepack_compute_tracers</em>. Such
tracer calculations are scattered throughout the code, wherever there
are changes to the ice thickness distribution.</p>
<p>Note that if a quantity such as <span class="math">\(a_{pnd}\)</span> becomes zero in a grid
cell’s thickness category, then all tracers that depend on it also
become zero. If a tracer should be conserved (e.g., aerosols and the
liquid water in topo ponds), additional code must be added to track
changes in the conserved quantity.</p>
<p>More information about the melt pond schemes is in the
<a class="reference internal" href="#ponds"><span class="std std-ref">Melt ponds</span></a> section.</p>
</div>
<div class="section" id="ice-age">
<span id="id24"></span><h4>2.2.1.2. Ice age<a class="headerlink" href="#ice-age" title="Permalink to this headline">¶</a></h4>
<p>The age of the ice, <span class="math">\(\tau_{age}\)</span>, is treated as an
ice-volume tracer (<cite>trcr_depend</cite> = 1). It is initialized at 0 when ice
forms as frazil, and the ice ages the length of the timestep during each
timestep. Freezing directly onto the bottom of the ice does not affect
the age, nor does melting. Mechanical redistribution processes and
advection alter the age of ice in any given grid cell in a conservative
manner following changes in ice area. The sea ice age tracer is
validated in <a class="reference internal" href="zreferences.html#hb09" id="id25">[23]</a>.</p>
<p>Another age-related tracer, the area covered by first-year ice
<span class="math">\(a_{FY}\)</span>, is an area tracer (<cite>trcr_depend</cite> = 0) that corresponds
more closely to satellite-derived ice age data for first-year ice than
does <span class="math">\(\tau_{age}\)</span>. It is re-initialized each year on 15
September (<code class="docutils literal"><span class="pre">yday</span></code> = 259) in the northern hemisphere and 15 March (<code class="docutils literal"><span class="pre">yday</span></code> =
75) in the southern hemisphere, in non-leap years. This tracer is
increased when new ice forms in open water, in subroutine
<em>add_new_ice</em> in <strong>icepack_therm_itd.F90</strong>. The first-year area tracer
is discussed in <a class="reference internal" href="zreferences.html#abth11" id="id26">[2]</a>.</p>
</div>
<div class="section" id="brine-height">
<span id="brine-ht"></span><h4>2.2.1.3. Brine height<a class="headerlink" href="#brine-height" title="Permalink to this headline">¶</a></h4>
<p>The brine height, <span class="math">\(h_b\)</span>, is the distance from the ice–ocean
interface to the brine surface. When <cite>tr_brine</cite> is set true in
<strong>icepack_in</strong> and <cite>TRBRI</cite> is set equal to 1 in <strong>comp_ice</strong>, the brine
surface can move relative to the ice surface. Physically, this occurs
when the ice is permeable and there is a nonzero pressure head: the
difference between the brine height and the equilibrium sea surface.
Brine height motion is computed in <strong>icepack_brine.F90</strong> from thermodynamic
variables (<code class="docutils literal"><span class="pre">melts</span></code>, <code class="docutils literal"><span class="pre">meltb</span></code>, <code class="docutils literal"><span class="pre">meltt</span></code>, etc) and the ice microstructural state
deduced from internal bulk salinities and temperature. In the current
release, this tracer is for diagnostic purposes only; it is driven by
the prognostic salinity parameterization but is not used for computing
salinity. In future releases it will be used for transporting
biogeochemical tracers vertically through the ice.</p>
<p>Brine height is transported horizontally as the fraction
<span class="math">\(f_{bri} = h_b/h_i\)</span>, a volume conserved tracer
Note that unlike the sea ice porosity, brine
height fraction may be greater than 1 when <span class="math">\(h_b &gt; h_i\)</span>.</p>
<p>Vertical transport processes are, generally, a result of the brine
motion. Therefore the vertical transport equations for biogeochemical
tracers will be defined only where brine is present. This region, from
the ice–ocean interface to the brine height, defines the domain of the
vertical bio-grid, whose resolution is independent of the sea ice
vertical grid and is set at compile time (see
the&nbsp;<a class="reference internal" href="icepack_3_user_guide.html#grids"><span class="std std-ref">Grid and boundary conditions</span></a> section). The ice microstructural state,
determined in <strong>icepack_brine.F90</strong>, is computed from sea ice salinities
and temperatures linearly interpolated to the bio-grid. When
<span class="math">\(h_b &gt; h_i\)</span>, the upper surface brine is assumed to have the same
microstructural properties as the ice surface.</p>
<p>Changes to <span class="math">\(h_b\)</span> occur from ice and snow melt, ice bottom boundary
changes, and from pressure adjustments. The computation of <span class="math">\(h_b\)</span>
at <span class="math">\(t+\Delta
t\)</span> is a two step process. First, <span class="math">\(h_b\)</span> is updated from changes in
ice and snow thickness, ie.</p>
<div class="math" id="equation-hb-thickness-changes">
<span class="eqno">(22)<a class="headerlink" href="#equation-hb-thickness-changes" title="Permalink to this equation">¶</a></span>\[h_b'  =  h_b(t) + \Delta h_b|_{h_i,h_s}.\]</div>
<p>Second, pressure driven adjustments arising from meltwater flushing and
snow loading are applied to <span class="math">\(h'_b\)</span>. Brine flow due to pressure
forces are governed by Darcy’s equation</p>
<div class="math" id="equation-Darcy1">
<span class="eqno">(23)<a class="headerlink" href="#equation-Darcy1" title="Permalink to this equation">¶</a></span>\[w =  -\frac{\Pi^* \bar{\rho} g}{\mu}\frac{h_p}{h_i}.\]</div>
<p>The vertical component of the net permeability tensor <span class="math">\(\Pi^*\)</span> is
computed as</p>
<div class="math" id="equation-netPi1">
<span class="eqno">(24)<a class="headerlink" href="#equation-netPi1" title="Permalink to this equation">¶</a></span>\[\Pi^*  =  \left(\frac{1}{h}\sum_{i=1}^N{\frac{\Delta
      z_i}{\Pi_i}}\right)^{-1}\]</div>
<p>where the sea ice is composed of <span class="math">\(N\)</span> vertical layers with
<span class="math">\(i\)</span>th layer thickness <span class="math">\(\Delta z_i\)</span> and permeability
<span class="math">\(\Pi_i\)</span> <a class="reference internal" href="#equation-topo-permea">(72)</a>. The average sea ice density is
<span class="math">\(\bar{\rho}\)</span> specified in <strong>icepack_zbgc_shared.F90</strong>. The hydraulic
head is <span class="math">\(h_p = h_b - h_{sl}\)</span> where <span class="math">\(h_{sl}\)</span> is the sea level
given by</p>
<div class="math" id="equation-hsl">
<span class="eqno">(25)<a class="headerlink" href="#equation-hsl" title="Permalink to this equation">¶</a></span>\[h_{sl}  =  \frac{\bar{\rho}}{\rho_w}h_i + \frac{\rho_s}{\rho_w}h_s.\]</div>
<p>Assuming constant <span class="math">\(h_i\)</span> and <span class="math">\(h_s\)</span> during Darcy flow, the
rate of change of <span class="math">\(h_b\)</span> is</p>
<div class="math" id="equation-h-p">
<span class="eqno">(26)<a class="headerlink" href="#equation-h-p" title="Permalink to this equation">¶</a></span>\[\frac{\partial h_b}{\partial t}   =  -w h_p\]</div>
<p>where <span class="math">\(w_o = \Pi^* \bar{\rho}
g/(h_i\mu\phi_{top})\)</span> and <span class="math">\(\phi_{top}\)</span> is the upper surface
porosity. When the Darcy flow is downward into the ice
(<span class="math">\(w_o &lt; 0\)</span>), then <span class="math">\(\phi_{top}\)</span> equals the sea ice porosity
in the uppermost layer. However, when the flow is upwards into the snow,
then <span class="math">\(\phi_{top}\)</span> equals the snow porosity <code class="docutils literal"><span class="pre">phi_snow</span></code> specified in
<strong>icepack_in</strong>. If a negative number is specified for <code class="docutils literal"><span class="pre">phi_snow</span></code>, then the
default value is used: <code class="docutils literal"><span class="pre">phi_snow</span></code> <span class="math">\(=1 - \rho_s/\rho_w\)</span>.</p>
<p>Since <span class="math">\(h_{sl}\)</span> remains relatively unchanged during Darcy flow,
Equation <a class="reference internal" href="#equation-h-p">(26)</a> has the approximate solution</p>
<div class="math" id="equation-brine-height">
<span class="eqno">(27)<a class="headerlink" href="#equation-brine-height" title="Permalink to this equation">¶</a></span>\[h_b(t+\Delta t) \approx h_{sl}(t+\Delta t) +  [h'_b - h_{sl}(t+\Delta t)]\exp\left\{-w \Delta t\right\}.\]</div>
<p>The contribution <span class="math">\(\Delta h_b|_{h_i,h_s}\)</span> arises from snow and ice
melt and bottom ice changes. Since the ice and brine bottom boundaries
coincide, changes in the ice bottom from growth or melt,
<span class="math">\((\Delta h_i)_{bot}\)</span>, equal the bottom brine boundary changes. The
surface contribution from ice and snow melt, however, is opposite in
sign. The ice contribution is as follows. If <span class="math">\(h_i &gt; h_b\)</span> and the
ice surface is melting, ie. <span class="math">\((\Delta h_i)_{top} &lt;
0\)</span>), then melt water increases the brine height:</p>
<div class="math" id="equation-delta-hb">
<span class="eqno">(28)<a class="headerlink" href="#equation-delta-hb" title="Permalink to this equation">¶</a></span>\[\begin{split}\left(\Delta h_b\right)_{top}  =   \frac{\rho_i}{\rho_o} \cdot \left\{ \begin{array}{ll}
-(\Delta h_i)_{top} &amp;  \mbox{if }
|(\Delta h_i)_{top}| &lt; h_i-h_b  \\
h_i-h_b &amp; \mbox{otherwise.}   \end{array} \right.\end{split}\]</div>
<p>For snow melt (<span class="math">\(\Delta h_s &lt; 0\)</span>), it is assumed that all snow
melt water contributes a source of surface brine. The total change from
snow melt and ice thickness changes is</p>
<div class="math" id="equation-dzdt-meltwater">
<span class="eqno">(29)<a class="headerlink" href="#equation-dzdt-meltwater" title="Permalink to this equation">¶</a></span>\[\Delta h_b|_{h_i,h_s}  =  \left( \Delta
h_b\right)_{top} -\left(\Delta h_i\right)_{bot} -\frac{\rho_s}{\rho_o}\Delta h_s.\]</div>
<p>The above brine height calculation is used only when <span class="math">\(h_i\)</span> and
<span class="math">\(h_b\)</span> exceed a minimum thickness, <code class="docutils literal"><span class="pre">thinS</span></code>, specified in
<strong>icepack_zbgc_shared</strong>. Otherwise</p>
<div class="math" id="equation-thinbrine1">
<span class="eqno">(30)<a class="headerlink" href="#equation-thinbrine1" title="Permalink to this equation">¶</a></span>\[h_b(t+\Delta t)  =  h_b(t) + \Delta h_i\]</div>
<p>provided that <span class="math">\(|h_{sl}-h_b| \leq 0.001\)</span>. This formulation ensures
small Darcy velocities when <span class="math">\(h_b\)</span> first exceeds <code class="docutils literal"><span class="pre">thinS</span></code>.</p>
<p>Both the volume fraction <span class="math">\(f_{bri}\)</span> and the area-weighted brine
height <span class="math">\(h_b\)</span> are available for output.</p>
<div class="math" id="equation-volume-frac">
<span class="eqno">(31)<a class="headerlink" href="#equation-volume-frac" title="Permalink to this equation">¶</a></span>\[{{\sum f_{bri} v_i} \over {\sum v_i}},\]</div>
<p>while <code class="docutils literal"><span class="pre">hbri</span></code> is comparable to hi (<span class="math">\(h_i\)</span>)</p>
<div class="math" id="equation-volume-frac2">
<span class="eqno">(32)<a class="headerlink" href="#equation-volume-frac2" title="Permalink to this equation">¶</a></span>\[{{\sum f_{bri} h_i a_i} \over {\sum a_i}},\]</div>
<p>where the sums are taken over thickness categories.</p>
</div>
<div class="section" id="biogeochemistry">
<span id="ice-bgc-tracers"></span><h4>2.2.1.4. Biogeochemistry<a class="headerlink" href="#biogeochemistry" title="Permalink to this headline">¶</a></h4>
<p>CHECK:  refer to section <a class="reference internal" href="#ice-bgc"><span class="std std-ref">Biogeochemistry - ECH</span></a> for science and configuration description.
This section is for explaining how the tracer stack works.</p>
<p>All biogeochemical tracers (<span class="math">\(T_b\)</span>) are brine concentrations. (except cesm aerosols?)
Tracers <span class="math">\(T_b\)</span> are area conserved and are expected to be transported horizontally in
a host sea ice model such as CICE.
Bulk tracer concentrations are written to diagnostic files.</p>
<p><em>Bottom layer</em></p>
<p>Although biogeochemical activity occurs throughout the sea ice column,
in the skeletal layer configuration we restrict ourselves to simulations of activity
taking place in the lowest few vertical centimeters.</p>
<p><em>Aerosols</em></p>
<p>Aerosols may be deposited on the ice and gradually work their way
through it until the ice melts and they are passed into the ocean. They
are defined as ice and snow volume tracers,
with the snow and ice each having two tracers for
each aerosol species, one in the surface scattering layer
(delta-Eddington SSL) and one in the snow or ice interior below the SSL.</p>
</div>
</div>
<div class="section" id="transport-in-thickness-space">
<span id="itd-trans"></span><h3>2.2.2. Transport in thickness space<a class="headerlink" href="#transport-in-thickness-space" title="Permalink to this headline">¶</a></h3>
<p>Next we solve the equation for ice transport in thickness space due to
thermodynamic growth and melt,</p>
<div class="math" id="equation-itd-transport">
<span class="eqno">(33)<a class="headerlink" href="#equation-itd-transport" title="Permalink to this equation">¶</a></span>\[\frac{\partial g}{\partial t} + \frac{\partial}{\partial h} (f g) = 0,\]</div>
<p>which is obtained from Equation <a class="reference internal" href="#equation-transport-g">(15)</a> by neglecting the first and
third terms on the right-hand side. We use the remapping method of
<a class="reference internal" href="zreferences.html#lipscomb01" id="id27">[31]</a>, in which thickness categories are
represented as Lagrangian grid cells whose boundaries are projected
forward in time. The thickness distribution function <span class="math">\(g\)</span> is
approximated as a linear function of <span class="math">\(h\)</span> in each displaced
category and is then remapped onto the original thickness categories.
This method is numerically smooth and is not too diffusive. It can be
viewed as a 1D simplification of the 2D incremental remapping scheme
described above.</p>
<p>We first compute the displacement of category boundaries in thickness
space. Assume that at time <span class="math">\(m\)</span> the ice areas <span class="math">\(a_n^m\)</span> and
mean ice thicknesses <span class="math">\(h_n^m\)</span> are known for each thickness
category. (For now we omit the subscript <span class="math">\(i\)</span> that distinguishes
ice from snow.) We use a thermodynamic model (<a class="reference internal" href="#thermo"><span class="std std-ref">Thermodynamics</span></a>)
to compute the new mean thicknesses <span class="math">\(h_n^{m+1}\)</span> at time
<span class="math">\(m+1\)</span>. The time step must be small enough that trajectories do not
cross; i.e., <span class="math">\(h_n^{m+1} &lt; h_{n+1}^{m+1}\)</span> for each pair of adjacent
categories. The growth rate at <span class="math">\(h = h_n\)</span> is given by
<span class="math">\(f_n = (h_n^{m+1} - h_n^m) / \Delta t\)</span>. By linear interpolation we
estimate the growth rate <span class="math">\(F_n\)</span> at the upper category boundary
<span class="math">\(H_n\)</span>:</p>
<div class="math" id="equation-growth-rate">
<span class="eqno">(34)<a class="headerlink" href="#equation-growth-rate" title="Permalink to this equation">¶</a></span>\[F_n = f_n + \frac{f_{n+1}-f_n}{h_{n+1}-h_n} \, (H_n - h_n).\]</div>
<p>If <span class="math">\(a_n\)</span> or <span class="math">\(a_{n+1} = 0\)</span>, <span class="math">\(F_n\)</span> is set to the growth
rate in the nonzero category, and if <span class="math">\(a_n = a_{n+1} = 0\)</span>, we set
<span class="math">\(F_n = 0\)</span>. The temporary displaced boundaries are given by</p>
<div class="math" id="equation-displ">
<span class="eqno">(35)<a class="headerlink" href="#equation-displ" title="Permalink to this equation">¶</a></span>\[H_n^* = H_n + F_n \, \Delta t, \ n = 1 \ {\rm to} \ N-1\]</div>
<p>The boundaries must not be displaced by more than one category to the
left or right; that is, we require <span class="math">\(H_{n-1} &lt; H_n^* &lt; H_{n+1}\)</span>.
Without this requirement we would need to do a general remapping rather
than an incremental remapping, at the cost of added complexity.</p>
<p>Next we construct <span class="math">\(g(h)\)</span> in the displaced thickness categories.
The ice areas in the displaced categories are <span class="math">\(a_n^{m+1} = a_n^m\)</span>,
since area is conserved following the motion in thickness space (i.e.,
during vertical ice growth or melting). The new ice volumes are
<span class="math">\(v_n^{m+1} = (a_n h_n)^{m+1} = a_n^m h_n^{m+1}\)</span>. For conciseness,
define <span class="math">\(H_L = H_{n-1}^*\)</span> and <span class="math">\(H_R = H_{n}^*\)</span> and drop the
time index <span class="math">\(m+1\)</span>. We wish to construct a continuous function
<span class="math">\(g(h)\)</span> within each category such that the total area and volume at
time <span class="math">\(m+1\)</span> are <span class="math">\(a_n\)</span> and <span class="math">\(v_n\)</span>, respectively:</p>
<div class="math" id="equation-area-cons">
<span class="eqno">(36)<a class="headerlink" href="#equation-area-cons" title="Permalink to this equation">¶</a></span>\[\int_{H_L}^{H_R} g \, dh = a_n,\]</div>
<div class="math" id="equation-volume-cons">
<span class="eqno">(37)<a class="headerlink" href="#equation-volume-cons" title="Permalink to this equation">¶</a></span>\[\int_{H_L}^{H_R} h \, g \, dh = v_n.\]</div>
<p>The simplest polynomial that can satisfy both equations is a line. It
is convenient to change coordinates, writing
<span class="math">\(g(\eta) = g_1 \eta + g_0\)</span>, where <span class="math">\(\eta = h - H_L\)</span> and the
coefficients <span class="math">\(g_0\)</span> and <span class="math">\(g_1\)</span> are to be determined. Then
Equations <a class="reference internal" href="#equation-area-cons">(36)</a> and <a class="reference internal" href="#equation-volume-cons">(37)</a> can be written as</p>
<div class="math" id="equation-g1">
<span class="eqno">(38)<a class="headerlink" href="#equation-g1" title="Permalink to this equation">¶</a></span>\[g_1 \frac{\eta_R^2}{2} + g_0 \eta_R = a_n,\]</div>
<div class="math" id="equation-g1a">
<span class="eqno">(39)<a class="headerlink" href="#equation-g1a" title="Permalink to this equation">¶</a></span>\[g_1 \frac{\eta_R^3}{3} + g_0 \frac{\eta_R^2}{2} = a_n \eta_n,\]</div>
<p>where <span class="math">\(\eta_R = H_R - H_L\)</span> and <span class="math">\(\eta_n = h_n - H_L\)</span>. These
equations have the solution</p>
<div class="math" id="equation-g0">
<span class="eqno">(40)<a class="headerlink" href="#equation-g0" title="Permalink to this equation">¶</a></span>\[g_0 = \frac{6 a_n}{\eta_R^2} \left(\frac{2 \eta_R}{3} - \eta_n\right),\]</div>
<div class="math" id="equation-g1b">
<span class="eqno">(41)<a class="headerlink" href="#equation-g1b" title="Permalink to this equation">¶</a></span>\[g_1 = \frac{12 a_n}{\eta_R^3} \left(\eta_n - \frac{\eta_R}{2}\right).\]</div>
<p>Since <span class="math">\(g\)</span> is linear, its maximum and minimum values lie at the
boundaries, <span class="math">\(\eta = 0\)</span> and <span class="math">\(\eta_R\)</span>:</p>
<div class="math" id="equation-gmin">
<span class="eqno">(42)<a class="headerlink" href="#equation-gmin" title="Permalink to this equation">¶</a></span>\[g(0)=\frac{6 a_n}{\eta_R^2} \, \left(\frac{2 \eta_R}{3} - \eta_n\right) = g_0,\]</div>
<div class="math" id="equation-gmax">
<span class="eqno">(43)<a class="headerlink" href="#equation-gmax" title="Permalink to this equation">¶</a></span>\[g(\eta_R) = \frac{6 a_n}{\eta_R^2} \, \left(\eta_n - \frac{\eta_R}{3}\right).\]</div>
<p>Equation <a class="reference internal" href="#equation-gmin">(42)</a> implies that <span class="math">\(g(0) &lt; 0\)</span> when
<span class="math">\(\eta_n &gt; 2 \eta_R/3\)</span>, i.e., when <span class="math">\(h_n\)</span> lies in the right
third of the thickness range <span class="math">\((H_L, H_R)\)</span>. Similarly, Equation <a class="reference internal" href="#equation-gmax">(43)</a>
implies that <span class="math">\(g(\eta_R) &lt; 0\)</span> when <span class="math">\(\eta_n &lt; \eta_R/3\)</span>, i.e.,
when <span class="math">\(h_n\)</span> is in the left third of the range. Since negative
values of <span class="math">\(g\)</span> are unphysical, a different solution is needed when
<span class="math">\(h_n\)</span> lies outside the central third of the thickness range. If
<span class="math">\(h_n\)</span> is in the left third of the range, we define a cutoff
thickness, <span class="math">\(H_C = 3 h_n - 2 H_L\)</span>, and set <span class="math">\(g = 0\)</span> between
<span class="math">\(H_C\)</span> and <span class="math">\(H_R\)</span>. Equations <a class="reference internal" href="#equation-g0">(40)</a> and <a class="reference internal" href="#equation-g1">(38)</a> are then
valid with <span class="math">\(\eta_R\)</span> redefined as <span class="math">\(H_C - H_L\)</span>. And if
<span class="math">\(h_n\)</span> is in the right third of the range, we define
<span class="math">\(H_C = 3 h_n - 2 H_R\)</span> and set <span class="math">\(g = 0\)</span> between <span class="math">\(H_L\)</span>
and <span class="math">\(H_C\)</span>. In this case, <a class="reference internal" href="#equation-g0">(40)</a> and <a class="reference internal" href="#equation-g1">(38)</a> apply with
<span class="math">\(\eta_R = H_R - H_C\)</span> and <span class="math">\(\eta_n = h_n - H_C\)</span>.</p>
<p><a class="reference internal" href="#fig-gplot"><span class="std std-ref">Figure 4</span></a> illustrates the linear reconstruction of <span class="math">\(g\)</span>
for the simple cases <span class="math">\(H_L = 0\)</span>, <span class="math">\(H_R = 1\)</span>, <span class="math">\(a_n = 1\)</span>,
and <span class="math">\(h_n =\)</span> 0.2, 0.4, 0.6, and 0.8. Note that <span class="math">\(g\)</span> slopes
downward (<span class="math">\(g_1 &lt; 0\)</span>) when <span class="math">\(h_n\)</span> is less than the midpoint
thickness, <span class="math">\((H_L + H_R)/2 = 1/2\)</span>, and upward when <span class="math">\(h_n\)</span>
exceeds the midpoint thickness. For <span class="math">\(h_n = 0.2\)</span> and 0.8,
<span class="math">\(g = 0\)</span> over part of the range.</p>
<div class="figure align-center" id="id122">
<span id="fig-gplot"></span><a class="reference internal image-reference" href="_images/gplot.png"><img alt="_images/gplot.png" src="_images/gplot.png" style="width: 657.4px; height: 504.6px;" /></a>
<p class="caption"><span class="caption-text">Figure 4</span></p>
</div>
<p><a class="reference internal" href="#fig-gplot"><span class="std std-ref">Figure 4</span></a> : Linear approximation of the thickness distribution
function <span class="math">\(g(h)\)</span> for an ice category with left boundary
<span class="math">\(H_L = 0\)</span>, right boundary <span class="math">\(H_R = 1\)</span>, fractional area
<span class="math">\(a_n = 1\)</span>, and mean ice thickness <span class="math">\(h_n = 0.2, 0.4, 0.6,\)</span> and <span class="math">\(0.8\)</span>.</p>
<p>Finally, we remap the thickness distribution to the original boundaries
by transferring area and volume between categories. We compute the ice
area <span class="math">\(\Delta a_n\)</span> and volume <span class="math">\(\Delta v_n\)</span> between each
original boundary <span class="math">\(H_n\)</span> and displaced boundary <span class="math">\(H_n^*\)</span>. If
<span class="math">\(H_n^* &gt; H_n\)</span>, ice moves from category <span class="math">\(n\)</span> to <span class="math">\(n+1\)</span>.
The area and volume transferred are</p>
<div class="math" id="equation-move-area">
<span class="eqno">(44)<a class="headerlink" href="#equation-move-area" title="Permalink to this equation">¶</a></span>\[\Delta a_n = \int_{H_n}^{H_n^*} g \, dh,\]</div>
<div class="math" id="equation-move-volume">
<span class="eqno">(45)<a class="headerlink" href="#equation-move-volume" title="Permalink to this equation">¶</a></span>\[\Delta v_n = \int_{H_n}^{H_n^*} h \, g \, dh.\]</div>
<p>If <span class="math">\(H_n^* &lt; H_N\)</span>, ice area and volume are transferred from
category <span class="math">\(n+1\)</span> to <span class="math">\(n\)</span> using Equations <a class="reference internal" href="#equation-move-area">(44)</a> and
<a class="reference internal" href="#equation-move-volume">(45)</a> with the limits of integration reversed. To evaluate
the integrals we change coordinates from <span class="math">\(h\)</span> to
<span class="math">\(\eta = h - H_L\)</span>, where <span class="math">\(H_L\)</span> is the left limit of the range
over which <span class="math">\(g &gt; 0\)</span>, and write <span class="math">\(g(\eta)\)</span> using Equations <a class="reference internal" href="#equation-g0">(40)</a> and
<a class="reference internal" href="#equation-g1">(38)</a>. In this way we obtain the new areas <span class="math">\(a_n\)</span> and volumes
<span class="math">\(v_n\)</span> between the original boundaries <span class="math">\(H_{n-1}\)</span> and
<span class="math">\(H_n\)</span> in each category. The new thicknesses,
<span class="math">\(h_n = v_n/a_n\)</span>, are guaranteed to lie in the range
<span class="math">\((H_{n-1}, H_n)\)</span>. If <span class="math">\(g = 0\)</span> in the part of a category that
is remapped to a neighboring category, no ice is transferred.</p>
<p>Other conserved quantities are transferred in proportion to the ice
volume <span class="math">\(\Delta v_{in}\)</span>. For example, the transferred ice energy in
layer <span class="math">\(k\)</span> is
<span class="math">\(\Delta e_{ink} = e_{ink} (\Delta v_{in} / v_{in})\)</span>.</p>
<p>The left and right boundaries of the domain require special treatment.
If ice is growing in open water at a rate <span class="math">\(F_0\)</span>, the left boundary
<span class="math">\(H_0\)</span> is shifted to the right by <span class="math">\(F_0 \Delta t\)</span> before
<span class="math">\(g\)</span> is constructed in category 1, then reset to zero after the
remapping is complete. New ice is then added to the grid cell,
conserving area, volume, and energy. If ice cannot grow in open water
(because the ocean is too warm or the net surface energy flux is
downward), <span class="math">\(H_0\)</span> is fixed at zero, and the growth rate at the left
boundary is estimated as <span class="math">\(F_0 = f_1\)</span>. If <span class="math">\(F_0 &lt; 0\)</span>, all ice
thinner than <span class="math">\(\Delta h_0 = -F_0 \Delta t\)</span> is assumed to have
melted, and the ice area in category 1 is reduced accordingly. The area
of new open water is</p>
<div class="math" id="equation-a0">
<span class="eqno">(46)<a class="headerlink" href="#equation-a0" title="Permalink to this equation">¶</a></span>\[\Delta a_0 = \int_{0}^{\Delta h_0} g \, dh.\]</div>
<p>The right boundary <span class="math">\(H_N\)</span> is not fixed but varies with
<span class="math">\(h_N\)</span>, the mean ice thickness in the thickest category. Given
<span class="math">\(h_N\)</span>, we set <span class="math">\(H_N = 3 h_N - 2 H_{N-1}\)</span>, which ensures that
<span class="math">\(g(h) &gt; 0\)</span> for <span class="math">\(H_{N-1} &lt; h &lt; H_N\)</span> and <span class="math">\(g(h) = 0\)</span> for
<span class="math">\(h \geq H_N\)</span>. No ice crosses the right boundary. If the ice growth
or melt rates in a given grid cell are too large, the thickness
remapping scheme will not work. Instead, the thickness categories in
that grid cell are treated as delta functions following
<a class="reference internal" href="zreferences.html#bhwe01" id="id28">[6]</a>, and categories outside their prescribed
boundaries are merged with neighboring categories as needed. For time
steps of less than a day and category thickness ranges of 10 cm or more,
this simplification is needed rarely, if ever.</p>
<p>The linear remapping algorithm for thickness is not monotonic for
tracers, although significant errors rarely occur. Usually they appear
as snow temperatures (enthalpy) outside the physical range of values in
very small snow volumes. In this case we transfer the snow and its heat
and tracer contents to the ocean.</p>
</div>
<div class="section" id="mechanical-redistribution">
<span id="mech-red"></span><h3>2.2.3. Mechanical redistribution<a class="headerlink" href="#mechanical-redistribution" title="Permalink to this headline">¶</a></h3>
<p>The last term on the right-hand side of Equation <a class="reference internal" href="#equation-transport-g">(15)</a>
is <span class="math">\(\psi\)</span>, which describes the redistribution
of ice in thickness space due to ridging and other mechanical processes.
The mechanical redistribution scheme in Icepack is based on
<a class="reference internal" href="zreferences.html#trmc75" id="id29">[49]</a>, <a class="reference internal" href="zreferences.html#rothrock75" id="id30">[42]</a>,
<a class="reference internal" href="zreferences.html#hibler80" id="id31">[21]</a>, <a class="reference internal" href="zreferences.html#fh95" id="id32">[14]</a>, and
<a class="reference internal" href="zreferences.html#lhmj07" id="id33">[32]</a>. This scheme converts thinner ice to thicker
ice and is applied after horizontal transport. When the ice is
converging, enough ice ridges to ensure that the ice area does not
exceed the grid cell area.</p>
<p>First we specify the participation function: the thickness distribution
<span class="math">\(a_P(h) = b(h) \, g(h)\)</span> of the ice participating in ridging. (We
use “ridging” as shorthand for all forms of mechanical redistribution,
including rafting.) The weighting function <span class="math">\(b(h)\)</span> favors ridging
of thin ice and closing of open water in preference to ridging of
thicker ice. There are two options for the form of <span class="math">\(b(h)\)</span>. If
<code class="docutils literal"><span class="pre">krdg_partic</span></code> = 0 in the namelist, we follow <a class="reference internal" href="zreferences.html#trmc75" id="id34">[49]</a>
and set</p>
<div class="math" id="equation-partic-old-contin">
<span class="eqno">(47)<a class="headerlink" href="#equation-partic-old-contin" title="Permalink to this equation">¶</a></span>\[\begin{split}b(h) = \left\{\begin{array}{ll}
       \frac{2}{G^*}(1-\frac{G(h)}{G^*}) &amp; \mbox{if $G(h)&lt;G^*$} \\
                 0                       &amp; \mbox{otherwise}
              \end{array}  \right.\end{split}\]</div>
<p>where <span class="math">\(G(h)\)</span> is the fractional area covered by ice thinner than
<span class="math">\(h\)</span>, and <span class="math">\(G^*\)</span> is an empirical constant. Integrating
<span class="math">\(a_P(h)\)</span> between category boundaries <span class="math">\(H_{n-1}\)</span> and
<span class="math">\(H_n\)</span>, we obtain the mean value of <span class="math">\(a_P\)</span> in category
<span class="math">\(n\)</span>:</p>
<div class="math" id="equation-partic-old-discrete">
<span class="eqno">(48)<a class="headerlink" href="#equation-partic-old-discrete" title="Permalink to this equation">¶</a></span>\[a_{Pn} = \frac{2}{G^*} (G_n - G_{n-1})
         \left( 1 - \frac{G_{n-1}+G_n}{2 G^*} \right),\]</div>
<p>where <span class="math">\(a_{Pn}\)</span> is the ratio of the ice area ridging (or open
water area closing) in category <span class="math">\(n\)</span> to the total area ridging and
closing, and <span class="math">\(G_n\)</span> is the total fractional ice area in categories
0 to <span class="math">\(n\)</span>. Equation&nbsp;<a class="reference internal" href="#equation-partic-old-discrete">(48)</a> applies to
categories with <span class="math">\(G_n &lt; G^*\)</span>. If <span class="math">\(G_{n-1} &lt; G^* &lt; G_n\)</span>, then
Equation <a class="reference internal" href="#equation-partic-old-discrete">(48)</a> is valid with <span class="math">\(G^*\)</span> replacing
<span class="math">\(G_n\)</span>, and if <span class="math">\(G_{n-1} &gt; G^*\)</span>, then <span class="math">\(a_{Pn} = 0\)</span>. If
the open water fraction <span class="math">\(a_0 &gt; G^*\)</span>, no ice can ridge, because
“ridging” simply reduces the area of open water. As in
<a class="reference internal" href="zreferences.html#trmc75" id="id35">[49]</a> we set <span class="math">\(G^* = 0.15\)</span>.</p>
<p>If the spatial resolution is too fine for a given time step
<span class="math">\(\Delta t\)</span>, the weighting function Equation <a class="reference internal" href="#equation-partic-old-contin">(47)</a> can
promote numerical instability. For <span class="math">\(\Delta t = \mbox{1 hour}\)</span>,
resolutions finer than <span class="math">\(\Delta x \sim \mbox{10 km}\)</span> are typically
unstable. The instability results from feedback between the ridging
scheme and the dynamics via the ice strength. If the strength changes
significantly on time scales less than <span class="math">\(\Delta t\)</span>, the
viscous-plastic solution of the momentum equation is inaccurate and
sometimes oscillatory. As a result, the fields of ice area, thickness,
velocity, strength, divergence, and shear can become noisy and
unphysical.</p>
<p>A more stable weighting function was suggested by
<a class="reference internal" href="zreferences.html#lhmj07" id="id36">[32]</a>:</p>
<div class="math" id="equation-partic-new-contin">
<span class="eqno">(49)<a class="headerlink" href="#equation-partic-new-contin" title="Permalink to this equation">¶</a></span>\[b(h) = \frac{\exp[-G(h)/a^*]}
            {a^*[1-\exp(-1/a^*)]}\]</div>
<p>When integrated between category boundaries, Equation <a class="reference internal" href="#equation-partic-new-contin">(49)</a>
implies</p>
<div class="math" id="equation-partic-new-discrete">
<span class="eqno">(50)<a class="headerlink" href="#equation-partic-new-discrete" title="Permalink to this equation">¶</a></span>\[a_{Pn} = \frac {\exp(-G_{n-1}/a^*) - \exp(-G_{n}/a^*)}
               {1 - \exp(-1/a^*)}\]</div>
<p>This weighting function is used if <code class="docutils literal"><span class="pre">krdg_partic</span></code> = 1 in the namelist.
From Equation <a class="reference internal" href="#equation-partic-new-contin">(49)</a>, the mean value of <span class="math">\(G\)</span> for ice
participating in ridging is <span class="math">\(a^*\)</span>, as compared to <span class="math">\(G^*/3\)</span>
for Equation <a class="reference internal" href="#equation-partic-old-contin">(47)</a>. For typical ice thickness distributions,
setting <span class="math">\(a^* = 0.05\)</span> with <code class="docutils literal"><span class="pre">krdg_partic</span></code> = 1 gives participation
fractions similar to those given by <span class="math">\(G^* = 0.15\)</span> with <code class="docutils literal"><span class="pre">krdg_partic</span></code>
= 0. See <a class="reference internal" href="zreferences.html#lhmj07" id="id37">[32]</a> for a detailed comparison of these
two participation functions.</p>
<p>Thin ice is converted to thick, ridged ice in a way that reduces the
total ice area while conserving ice volume and internal energy. There
are two namelist options for redistributing ice among thickness
categories. If <code class="docutils literal"><span class="pre">krdg_redist</span></code> = 0, ridging ice of thickness <span class="math">\(h_n\)</span>
forms ridges whose area is distributed uniformly between
<span class="math">\(H_{\min} = 2 h_n\)</span> and <span class="math">\(H_{\max} = 2 \sqrt{H^* h_n}\)</span>, as in
<a class="reference internal" href="zreferences.html#hibler80" id="id38">[21]</a>. The default value of <span class="math">\(H^*\)</span> is 25&nbsp;m, as
in earlier versions of CICE. Observations suggest that
<span class="math">\(H^* = 50\)</span>&nbsp;m gives a better fit to first-year ridges
<a class="reference internal" href="zreferences.html#ami04" id="id39">[1]</a>, although the lower value may be appropriate
for multiyear ridges <a class="reference internal" href="zreferences.html#fh95" id="id40">[14]</a>. The ratio of the mean
ridge thickness to the thickness of ridging ice is
<span class="math">\(k_n = (H_{\min} + H_{\max}) / (2 h_n)\)</span>. If the area of category
<span class="math">\(n\)</span> is reduced by ridging at the rate <span class="math">\(r_n\)</span>, the area of
thicker categories grows simultaneously at the rate <span class="math">\(r_n/k_n\)</span>.
Thus the <em>net</em> rate of area loss due to ridging of ice in category
<span class="math">\(n\)</span> is <span class="math">\(r_n(1-1/k_n)\)</span>.</p>
<p>The ridged ice area and volume are apportioned among categories in the
thickness range <span class="math">\((H_{\min}, H_{\max})\)</span>. The fraction of the new
ridge area in category <span class="math">\(m\)</span> is</p>
<div class="math" id="equation-ridge-area-old">
<span class="eqno">(51)<a class="headerlink" href="#equation-ridge-area-old" title="Permalink to this equation">¶</a></span>\[f_m^{\mathrm{area}} = \frac{H_R - H_L}
                           {H_{\max} - H_{\min}},\]</div>
<p>where <span class="math">\(H_L = \max(H_{m-1},H_{\min})\)</span> and
<span class="math">\(H_R= \min(H_m,H_{\max})\)</span>. The fraction of the ridge volume going
to category <span class="math">\(m\)</span> is</p>
<div class="math" id="equation-ridge-volume-old">
<span class="eqno">(52)<a class="headerlink" href="#equation-ridge-volume-old" title="Permalink to this equation">¶</a></span>\[f_m^{\mathrm{vol}} = \frac{(H_R)^2 - (H_L)^2}
                          {(H_{\max})^2 - (H_{\min})^2}.\]</div>
<p>This uniform redistribution function tends to produce too little ice in
the 3–5&nbsp;m range and too much ice thicker than 10&nbsp;m
<a class="reference internal" href="zreferences.html#ami04" id="id41">[1]</a>. Observations show that the ITD of ridges is
better approximated by a negative exponential. Setting <code class="docutils literal"><span class="pre">krdg_redist</span></code> = 1
gives ridges with an exponential ITD <a class="reference internal" href="zreferences.html#lhmj07" id="id42">[32]</a>:</p>
<div class="math" id="equation-redist-new">
<span class="eqno">(53)<a class="headerlink" href="#equation-redist-new" title="Permalink to this equation">¶</a></span>\[g_R(h) \propto \exp[-(h - H_{\min})/\lambda]\]</div>
<p>for <span class="math">\(h \ge H_{\min}\)</span>, with <span class="math">\(g_R(h) = 0\)</span> for
<span class="math">\(h &lt; H_{\min}\)</span>. Here, <span class="math">\(\lambda\)</span> is an empirical <em>e</em>-folding
scale and <span class="math">\(H_{\min}=2h_n\)</span> (where <span class="math">\(h_n\)</span> is the thickness of
ridging ice). We assume that <span class="math">\(\lambda = \mu h_n^{1/2}\)</span>, where
<span class="math">\(\mu\)</span> (mu_rdg) is a tunable parameter with units . Thus the mean
ridge thickness increases in proportion to <span class="math">\(h_n^{1/2}\)</span>, as in
<a class="reference internal" href="zreferences.html#hibler80" id="id43">[21]</a>. The value <span class="math">\(\mu = 4.0\)</span>&nbsp; gives
<span class="math">\(\lambda\)</span> in the range 1–4 m for most ridged ice. Ice strengths
with <span class="math">\(\mu = 4.0\)</span>&nbsp; and <code class="docutils literal"><span class="pre">krdg_redist</span></code> = 1 are roughly comparable to
the strengths with <span class="math">\(H^* = 50\)</span>&nbsp;m and <code class="docutils literal"><span class="pre">krdg_redist</span></code> = 0.</p>
<p>From Equation <a class="reference internal" href="#equation-redist-new">(53)</a> it can be shown that the fractional area going
to category <span class="math">\(m\)</span> as a result of ridging is</p>
<div class="math" id="equation-ridge-area-new">
<span class="eqno">(54)<a class="headerlink" href="#equation-ridge-area-new" title="Permalink to this equation">¶</a></span>\[f_m^{\mathrm{area}} = \exp[-(H_{m-1} - H_{\min}) / \lambda]
                     - \exp[-(H_m - H_{\min}) / \lambda].\]</div>
<p>The fractional volume going to category <span class="math">\(m\)</span> is</p>
<div class="math" id="equation-ridge-volume-new">
<span class="eqno">(55)<a class="headerlink" href="#equation-ridge-volume-new" title="Permalink to this equation">¶</a></span>\[f_m^{\mathrm{vol}} = \frac{(H_{m-1}+\lambda) \exp[-(H_{m-1}-H_{\min})/\lambda]
                           - (H_m + \lambda) \exp[-(H_m - H_{\min}) / \lambda]}
                             {H_{min} + \lambda}.\]</div>
<p>Equations <a class="reference internal" href="#equation-ridge-area-new">(54)</a> and <a class="reference internal" href="#equation-ridge-volume-new">(55)</a> replace
Equations <a class="reference internal" href="#equation-ridge-area-old">(51)</a> and <a class="reference internal" href="#equation-ridge-volume-old">(52)</a> when <code class="docutils literal"><span class="pre">krdg_redist</span></code>
= 1.</p>
<p>Internal ice energy is transferred between categories in proportion to
ice volume. Snow volume and internal energy are transferred in the same
way, except that a fraction of the snow may be deposited in the ocean
instead of added to the new ridge.</p>
<p>The net area removed by ridging and closing is a function of the strain
rates. Let <span class="math">\(R_{\mathrm{net}}\)</span> be the net rate of area loss for the
ice pack (i.e., the rate of open water area closing, plus the net rate
of ice area loss due to ridging). Following <a class="reference internal" href="zreferences.html#fh95" id="id44">[14]</a>,
<span class="math">\(R_{\mathrm{net}}\)</span> is given by</p>
<div class="math" id="equation-Rnet">
<span class="eqno">(56)<a class="headerlink" href="#equation-Rnet" title="Permalink to this equation">¶</a></span>\[R_{\mathrm{net}} = \frac{C_s}{2}
                 (\Delta - |D_D|) - \min(D_D,0),\]</div>
<p>where <span class="math">\(C_s\)</span> is the fraction of shear dissipation energy that
contributes to ridge-building, <span class="math">\(D_D\)</span> is the divergence, and
<span class="math">\(\Delta\)</span> is a function of the divergence and shear. These strain
rates are computed by the dynamics scheme. The default value of
<span class="math">\(C_s\)</span> is 0.25.</p>
<p>Next, define <span class="math">\(R_{\mathrm{tot}} = \sum_{n=0}^N r_n\)</span>. This rate is
related to <span class="math">\(R_{\mathrm{net}}\)</span> by</p>
<div class="math" id="equation-Rtot-Rnet">
<span class="eqno">(57)<a class="headerlink" href="#equation-Rtot-Rnet" title="Permalink to this equation">¶</a></span>\[R_{\mathrm{net}} =
   \left[ a_{P0} + \sum_{n=1}^N a_{Pn}\left(1-{1\over k_n}\right)\right]
    R_{\mathrm{tot}}.\]</div>
<p>Given <span class="math">\(R_{\mathrm{net}}\)</span> from&nbsp;Equation <a class="reference internal" href="#equation-Rnet">(56)</a>, we
use&nbsp;Equation <a class="reference internal" href="#equation-Rtot-Rnet">(57)</a> to compute <span class="math">\(R_{\mathrm{tot}}\)</span>. Then the area
ridged in category <span class="math">\(n\)</span> is given by <span class="math">\(a_{rn} = r_n \Delta t\)</span>,
where <span class="math">\(r_n = a_{Pn} R_{\mathrm{tot}}\)</span>. The area of new ridges is
<span class="math">\(a_{rn} / k_n\)</span>, and the volume of new ridges is <span class="math">\(a_{rn} h_n\)</span>
(since volume is conserved during ridging). We remove the ridging ice
from category <span class="math">\(n\)</span> and use Equations&nbsp;<a class="reference internal" href="#equation-ridge-area-old">(51)</a>
and&nbsp;<a class="reference internal" href="#equation-ridge-volume-old">(52)</a>: (or <a class="reference internal" href="#equation-ridge-area-new">(54)</a> and
<a class="reference internal" href="#equation-ridge-volume-new">(55)</a>) to redistribute the ice among thicker
categories.</p>
<p>Occasionally the ridging rate in thickness category <span class="math">\(n\)</span> may be
large enough to ridge the entire area <span class="math">\(a_n\)</span> during a time interval
less than <span class="math">\(\Delta t\)</span>. In this case <span class="math">\(R_{\mathrm{tot}}\)</span> is
reduced to the value that exactly ridges an area <span class="math">\(a_n\)</span> during
<span class="math">\(\Delta t\)</span>. After each ridging iteration, the total fractional ice
area <span class="math">\(a_i\)</span> is computed. If <span class="math">\(a_i &gt; 1\)</span>, the ridging is
repeated with a value of <span class="math">\(R_{\mathrm{net}}\)</span> sufficient to yield
<span class="math">\(a_i = 1\)</span>.</p>
<p>Two tracers for tracking the ridged ice area and volume are available.
The actual tracers are for level (undeformed) ice area (<cite>alvl</cite>) and volume
(<cite>vlvl</cite>), which are easier to implement for a couple of reasons: (1) ice
ridged in a given thickness category is spread out among the rest of the
categories, making it more difficult (and expensive) to track than the
level ice remaining behind in the original category; (2) previously
ridged ice may ridge again, so that simply adding a volume of freshly
ridged ice to the volume of previously ridged ice in a grid cell may be
inappropriate. Although the code currently only tracks level ice
internally, both level ice and ridged ice are available for output.
They are simply related:</p>
<div class="math" id="equation-alvl">
<span class="eqno">(58)<a class="headerlink" href="#equation-alvl" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
a_{lvl} + a_{rdg} &amp;=&amp; a_i, \\
v_{lvl} + v_{rdg} &amp;=&amp; v_i.\end{aligned}\end{split}\]</div>
<p>Level ice area fraction and volume increase with new ice formation and
decrease steadily via ridging processes. Without the formation of new
ice, level ice asymptotes to zero because we assume that both level ice
and ridged ice ridge, in proportion to their fractional areas in a grid
cell (in the spirit of the ridging calculation itself which does not
prefer level ice over previously ridged ice).</p>
<p>The ice strength <span class="math">\(P\)</span> may be computed in either of two ways. If the
namelist parameter kstrength = 0, we use the strength formula from
<a class="reference internal" href="zreferences.html#hibler79" id="id45">[20]</a>:</p>
<div class="math" id="equation-hib-strength">
<span class="eqno">(59)<a class="headerlink" href="#equation-hib-strength" title="Permalink to this equation">¶</a></span>\[P = P^* h \exp[-C(1-a_i)],\]</div>
<p>where <span class="math">\(P^* = 27,500 \, \mathrm {N/m}\)</span> and <span class="math">\(C = 20\)</span> are
empirical constants, and <span class="math">\(h\)</span> is the mean ice thickness.
Alternatively, setting kstrength = 1 gives an ice strength closely
related to the ridging scheme. Following
<a class="reference internal" href="zreferences.html#rothrock75" id="id46">[42]</a>, the strength is assumed proportional
to the change in ice potential energy <span class="math">\(\Delta E_P\)</span> per unit area
of compressive deformation. Given uniform ridge ITDs (<code class="docutils literal"><span class="pre">krdg_redist</span></code> = 0),
we have</p>
<div class="math" id="equation-roth-strength0">
<span class="eqno">(60)<a class="headerlink" href="#equation-roth-strength0" title="Permalink to this equation">¶</a></span>\[P = C_f \, C_p \, \beta \sum_{n=1}^{N_C}
  \left[ -a_{Pn} \, h_n^2  + \frac{a_{Pn}}{k_n}
     \left( \frac{(H_n^{\max})^3 - (H_n^{\min})^3}
                 {3(H_n^{\max}-H_n^{\min})} \right) \right],\]</div>
<p>where <span class="math">\(C_P = (g/2)(\rho_i/\rho_w)(\rho_w-\rho_i)\)</span>,
<span class="math">\(\beta =R_{\mathrm{tot}}/R_{\mathrm{net}} &gt; 1\)</span>
from&nbsp;Equation <a class="reference internal" href="#equation-Rtot-Rnet">(57)</a>, and <span class="math">\(C_f\)</span> is an empirical parameter that
accounts for frictional energy dissipation. Following
<a class="reference internal" href="zreferences.html#fh95" id="id47">[14]</a>, we set <span class="math">\(C_f = 17\)</span>. The first term in
the summation is the potential energy of ridging ice, and the second,
larger term is the potential energy of the resulting ridges. The factor
of <span class="math">\(\beta\)</span> is included because <span class="math">\(a_{Pn}\)</span> is normalized with
respect to the total area of ice ridging, not the net area removed.
Recall that more than one unit area of ice must be ridged to reduce the
net ice area by one unit. For exponential ridge ITDs (<code class="docutils literal"><span class="pre">krdg_redist</span></code> = 1),
the ridge potential energy is modified:</p>
<div class="math" id="equation-roth-strength1">
<span class="eqno">(61)<a class="headerlink" href="#equation-roth-strength1" title="Permalink to this equation">¶</a></span>\[P = C_f \, C_p \, \beta \sum_{n=1}^{N_C}
  \left[ -a_{Pn} \, h_n^2  + \frac{a_{Pn}}{k_n}
     \left( H_{\min}^2 + 2H_{\min}\lambda + 2 \lambda^2 \right) \right]\]</div>
<p>The energy-based ice strength given by Equations <a class="reference internal" href="#equation-roth-strength0">(60)</a> or
<a class="reference internal" href="#equation-roth-strength1">(61)</a> is more physically realistic than the strength
given by Equation <a class="reference internal" href="#equation-hib-strength">(59)</a>. However, use of Equation <a class="reference internal" href="#equation-hib-strength">(59)</a> is
less likely to allow numerical instability at a given resolution and
time step. See <a class="reference internal" href="zreferences.html#lhmj07" id="id48">[32]</a> for more details.</p>
</div>
<div class="section" id="thermodynamics">
<span id="thermo"></span><h3>2.2.4. Thermodynamics<a class="headerlink" href="#thermodynamics" title="Permalink to this headline">¶</a></h3>
<p>The current Icepack version includes three thermodynamics
options, the “zero-layer” thermodynamics of <a class="reference internal" href="zreferences.html#semtner76" id="id49">[44]</a>
(<code class="docutils literal"><span class="pre">ktherm</span></code> = 0), the Bitz and Lipscomb model <a class="reference internal" href="zreferences.html#bl99" id="id50">[7]</a>
(<code class="docutils literal"><span class="pre">ktherm</span></code> = 1) that assumes a fixed salinity profile, and a new “mushy”
formulation (<code class="docutils literal"><span class="pre">ktherm</span></code> = 2) in which salinity evolves
<a class="reference internal" href="zreferences.html#thb13" id="id51">[52]</a>. For each thickness category, Icepack computes
changes in the ice and snow thickness and vertical temperature profile
resulting from radiative, turbulent, and conductive heat fluxes. The ice
has a temperature-dependent specific heam to simulate the effect of
brine pocket melting and freezing, for <code class="docutils literal"><span class="pre">ktherm</span></code> = 1 and 2.</p>
<p>Each thickness category <span class="math">\(n\)</span> in each grid cell is treated as a
horizontally uniform column with ice thickness
<span class="math">\(h_{in} = v_{in}/a_{in}\)</span> and snow thickness
<span class="math">\(h_{sn} = v_{sn}/a_{in}\)</span>. (Henceforth we omit the category
index&nbsp;<span class="math">\(n\)</span>.) Each column is divided into <span class="math">\(N_i\)</span> ice layers
of thickness <span class="math">\(\Delta h_i = h_i/N_i\)</span> and <span class="math">\(N_s\)</span> snow layers of
thickness <span class="math">\(\Delta h_s = h_s/N_s\)</span>. The surface temperature (i.e.,
the temperature of ice or snow at the interface with the atmosphere) is
<span class="math">\(T_{sf}\)</span>, which cannot exceed . The temperature at the
midpoint of the snow layer is <span class="math">\(T_s\)</span>, and the midpoint ice layer
temperatures are <span class="math">\(T_{ik}\)</span>, where <span class="math">\(k\)</span> ranges from 1 to
<span class="math">\(N_i\)</span>. The temperature at the bottom of the ice is held at
<span class="math">\(T_f\)</span>, the freezing temperature of the ocean mixed layer. All
temperatures are in degrees Celsius unless stated otherwise.</p>
<p>Each ice layer has an enthalpy <span class="math">\(q_{ik}\)</span>, defined as the negative
of the energy required to melt a unit volume of ice and raise its
temperature to . Because of internal melting and freezing in brine
pockets, the ice enthalpy depends on the brine pocket volume and is a
function of temperature and salinity. We can also define a snow enthalpy
<span class="math">\(q_s\)</span>, which depends on temperature alone.</p>
<p>Given surface forcing at the atmosphere–ice and ice–ocean interfaces
along with the ice and snow thicknesses and temperatures/enthalpies at
time <span class="math">\(m\)</span>, the thermodynamic model advances these quantities to
time <span class="math">\(m+1\)</span> (<code class="docutils literal"><span class="pre">ktherm</span></code> = 2 also advances salinity). The calculation
proceeds in two steps. First we solve a set of equations for the new
temperatures, as discussed in the&nbsp;<a class="reference internal" href="#thermo-temp"><span class="std std-ref">New temperatures</span></a> section. Then we
compute the melting, if any, of ice or snow at the top surface, and the
growth or melting of ice at the bottom surface, as described in
the&nbsp;<a class="reference internal" href="#thermo-growth"><span class="std std-ref">Growth and melting</span></a> section. We begin by describing the surface
forcing parameterizations, which are closely related to the ice and snow
surface temperatures.</p>
<div class="section" id="melt-ponds">
<span id="ponds"></span><h4>2.2.4.1. Melt ponds<a class="headerlink" href="#melt-ponds" title="Permalink to this headline">¶</a></h4>
<p>Three explicit melt pond parameterizations are available in Icepack, and
all must use the delta-Eddington radiation scheme, described below. The
default (ccsm3) shortwave parameterization incorporates melt ponds
implicitly by adjusting the albedo based on surface conditions.</p>
<p>For each of the three explicit parameterizations, a volume
<span class="math">\(\Delta V_{melt}\)</span> of melt water produced on a given category may
be added to the melt pond liquid volume:</p>
<div class="math" id="equation-meltvol">
<span class="eqno">(62)<a class="headerlink" href="#equation-meltvol" title="Permalink to this equation">¶</a></span>\[\Delta V_{melt} = {r\over\rho_w} \left({\rho_{i}}\Delta h_{i} + {\rho_{s}}\Delta h_{s} + F_{rain}{\Delta t}\right) a_i,\]</div>
<p>where</p>
<div class="math" id="equation-melt-retention">
<span class="eqno">(63)<a class="headerlink" href="#equation-melt-retention" title="Permalink to this equation">¶</a></span>\[r = r_{min} + \left(r_{max} - r_{min}\right) a_i\]</div>
<p>is the fraction of the total melt water available that is added to the
ponds, <span class="math">\(\rho_i\)</span> and <span class="math">\(\rho_s\)</span> are ice and snow densities,
<span class="math">\(\Delta h_i\)</span> and <span class="math">\(\Delta h_s\)</span> are the thicknesses of ice and
snow that melted, and <span class="math">\(F_{rain}\)</span> is the rainfall rate. Namelist
parameters are set for the level-ice (<code class="docutils literal"><span class="pre">tr_pond_lvl</span></code>) parameterization;
in the cesm and topo pond schemes the standard values of <span class="math">\(r_{max}\)</span>
and <span class="math">\(r_{min}\)</span> are 0.7 and 0.15, respectively.</p>
<p>Radiatively, the surface of an ice category is divided into fractions of
snow, pond and bare ice. In these melt pond schemes, the actual pond
area and depth are maintained throughout the simulation according to the
physical processes acting on it. However, snow on the sea ice and pond
ice may shield the pond and ice below from solar radiation. These
processes do not alter the actual pond volume; instead they are used to
define an “effective pond fraction” (and likewise, effective pond depth,
snow fraction and snow depth) used only for the shortwave radiation
calculation.</p>
<p>In addition to the physical processes discussed below, tracer equations
and definitions for melt ponds are also described in
the&nbsp;<a class="reference internal" href="#tracers"><span class="std std-ref">Tracers</span></a> and <a class="reference internal" href="#fig-tracers"><span class="std std-ref">Figure 1</span></a> sections.</p>
<p><strong>CESM formulation</strong> (<code class="docutils literal"><span class="pre">tr_pond_cesm</span></code> = true)</p>
<p>Melt pond area and thickness tracers are carried on each ice thickness
category as in the&nbsp;<a class="reference internal" href="#tracers"><span class="std std-ref">Tracers</span></a> section. Defined simply as the product
of pond area, <span class="math">\(a_p\)</span>, and depth, <span class="math">\(h_p\)</span>, the melt pond volume,
<span class="math">\(V_{p}\)</span>, grows through addition of ice or snow melt water or rain
water, and shrinks when the ice surface temperature becomes cold,</p>
<div class="math" id="equation-meltpond-cesm">
<span class="eqno">(64)<a class="headerlink" href="#equation-meltpond-cesm" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
{\rm pond \ growth:\ } \ V_{p}^\prime &amp;= V_{p}(t) +\Delta V_{melt} , \\
{\rm pond \ contraction:\ } \ V_{p}(t+\Delta t) &amp;= V_{p}^\prime\exp\left[r_2\left( {\max\left(T_p-T_{sfc}, 0\right) \over T_p}\right)\right], \end{aligned}\end{split}\]</div>
<p>where <span class="math">\(dh_{i}\)</span> and <span class="math">\(dh_{s}\)</span> represent ice and snow melt at
the top surface of each thickness category and <span class="math">\(r_2=0.01\)</span>. Here,
<span class="math">\(T_p\)</span> is a reference temperature equal to -2 <span class="math">\(^\circ\)</span>C.
Pond depth is assumed to be a linear function of the pond fraction
(<span class="math">\(h_p=\delta_p a_p\)</span>) and is limited by the category ice thickness
(<span class="math">\(h_p \le 0.9 h_i\)</span>). The pond shape (<code class="docutils literal"><span class="pre">pndaspect</span></code>)
<span class="math">\(\delta_p = 0.8\)</span> in the standard CESM pond configuration. The area
and thickness are computed according to the assumed pond shape, and the
pond area is then reduced in the presence of snow for the radiation
calculation. Ponds are allowed only on ice at least 1&nbsp;cm thick. This
formulation differs slightly from that documented in
<a class="reference internal" href="zreferences.html#hbblh12" id="id52">[22]</a>.</p>
<p><strong>Topographic formulation</strong> (<code class="docutils literal"><span class="pre">tr_pond_topo</span></code> = true)</p>
<p>The principle concept of this scheme is that melt water runs downhill
under the influence of gravity and collects on sea ice with increasing
surface height starting at the lowest height
<a class="reference internal" href="zreferences.html#ff07" id="id53">[15]</a><a class="reference internal" href="zreferences.html#fft10" id="id54">[16]</a><a class="reference internal" href="zreferences.html#fsfh12" id="id55">[17]</a>. Thus, the topography of the
ice cover plays a crucial role in determining the melt pond cover.
However, Icepack does not explicitly represent the topography of sea ice.
Therefore, we split the existing ice thickness distribution function
into a surface height and basal depth distribution assuming that each
sea ice thickness category is in hydrostatic equilibrium at the
beginning of the melt season. We then calculate the position of sea
level assuming that the ice in the whole grid cell is rigid and in
hydrostatic equilibrium.</p>
<div class="figure align-center" id="id123">
<span id="fig-topo"></span><a class="reference internal image-reference" href="_images/topo.png"><img alt="_images/topo.png" src="_images/topo.png" style="width: 569.25px; height: 661.5px;" /></a>
<p class="caption"><span class="caption-text">Figure 6</span></p>
</div>
<p><a class="reference internal" href="#fig-topo"><span class="std std-ref">Figure 6</span></a> : (a) Schematic illustration of the relationship between the
height of the pond surface <span class="math">\(h_{pnd,tot}\)</span>, the volume of water
<span class="math">\(V_{Pk}\)</span> required to completely fill up to category <span class="math">\(k\)</span>, the
volume of water <span class="math">\(V_{P} - V_{Pk}\)</span>, and the depth to which this
fills up category <span class="math">\(k + 1\)</span>. Ice and snow areas <span class="math">\(a_i\)</span> and
<span class="math">\(a_s\)</span> are also depicted. The volume calculation takes account of
the presence of snow, which may be partially or completely saturated.
(b) Schematic illustration indicating pond surface height
<span class="math">\(h_{pnd,tot}\)</span> and sea level <span class="math">\(h_{sl}\)</span> measured with respect
to the thinnest surface height category <span class="math">\(h_{i1}\)</span>, the submerged
portion of the floe <span class="math">\(h_{sub}\)</span>, and hydraulic head <span class="math">\(\Delta H\)</span>
. A positive hydraulic head (pond surface above sea level) will flush
melt water through the sea ice into the ocean; a negative hydraulic head
can drive percolation of sea water up onto the ice surface. Here,
<span class="math">\(\alpha=0.6\)</span> and <span class="math">\(\beta=0.4\)</span> are the surface height and
basal depth distribution fractions. The height of the steps is the
height of the ice above the reference level, and the width of the steps
is the area of ice of that height. The illustration does not imply a
particular assumed topography, rather it is assumed that all thickness
categories are present at the sub-grid scale so that water will always
flow to the lowest surface height class.</p>
<p>Once a volume of water is produced from ice and snow melting, we
calculate the number of ice categories covered by water. At each time
step, we construct a list of volumes of water
<span class="math">\(\{V_{P1}, V_{P2}, . . . V_{P,k-1}, V_{Pk},\)</span>
<span class="math">\(V_{P,k+1}, . . . \}\)</span>, where <span class="math">\(V_{Pk}\)</span> is the volume of water
required to completely cover the ice and snow in the surface height
categories from <span class="math">\(i = 1\)</span> up to <span class="math">\(i = k\)</span>. The volume
<span class="math">\(V_{Pk}\)</span> is defined so that if the volume of water <span class="math">\(V_{P}\)</span>
is such that <span class="math">\(V_{Pk} &lt; V_{P} &lt; V_{P,k+1}\)</span> then the snow and ice in
categories <span class="math">\(n = 1\)</span> up to <span class="math">\(n = k + 1\)</span> are covered in melt
water. <a class="reference internal" href="#fig-topo"><span class="std std-ref">Figure 6</span></a> (a) depicts the areas covered in melt water and
saturated snow on the surface height (rather than thickness) categories
<span class="math">\(h_{top,k}\)</span>. Note in the code, we assume that
<span class="math">\(h_{top,n}/h_{in} = 0.6\)</span> (an arbitrary choice). The fractional
area of the <span class="math">\(n\)</span>th category covered in snow is <span class="math">\(a_{sn}\)</span>.
The volume <span class="math">\(V_{P1}\)</span>, which is the region with vertical hatching,
is the volume of water required to completely fill up the first
thickness category, so that any extra melt water must occupy the second
thickness category, and it is given by the expression</p>
<div class="math" id="equation-topo-vol1">
<span class="eqno">(65)<a class="headerlink" href="#equation-topo-vol1" title="Permalink to this equation">¶</a></span>\[V_{P1} = a_{i1} (h_{top,2}-h_{top,1}) - a_{s1} a_{i1} h_{s1} (1-V_{sw}),\]</div>
<p>where <span class="math">\(V_{sw}\)</span> is the fraction of the snow volume that can be
occupied by water, and <span class="math">\(h_{s1}\)</span> is the snow depth on ice height
class 1. In a similar way, the volume required to fill up the first and
second surface categories, <span class="math">\(V_{P2}\)</span>, is given by</p>
<div class="math" id="equation-topo-vol2">
<span class="eqno">(66)<a class="headerlink" href="#equation-topo-vol2" title="Permalink to this equation">¶</a></span>\[V_{P2} = a_{i1} (h_{top,3}-h_{top,2}) + a_{i2} (h_{top,3}-h_{top,2}) - a_{s2} a_{i2} h_{s2} (1-V_{sw}) + V_{P1}.\]</div>
<p>The general expression for volume <span class="math">\(V_{Pk}\)</span> is given by</p>
<div class="math" id="equation-topo-vol">
<span class="eqno">(67)<a class="headerlink" href="#equation-topo-vol" title="Permalink to this equation">¶</a></span>\[V_{Pk} = \sum^k_{m=0} a_{im} (h_{top,k+1}-h_{top,k}) - a_{sk} a_{ik} h_{sk} (1-V_{sw})
          + \sum^{k-1}_{m=0} V_{Pm}.\]</div>
<p>(Note that we have implicitly assumed that
<span class="math">\(h_{si} &lt; h_{top,k+1} - h_{top,k}\)</span> for all <span class="math">\(k\)</span>.) No melt
water can be stored on the thickest ice thickness category. If the melt
water volume exceeds the volume calculated above, the remaining melt
water is released to the ocean.</p>
<p>At each time step, the pond height above the level of the thinnest
surface height class, that is, the maximum pond depth, is diagnosed from
the list of volumes <span class="math">\(V_{Pk}\)</span>. In particular, if the total volume
of melt water <span class="math">\(V_{P}\)</span> is such that
<span class="math">\(V_{Pk} &lt; V_{P} &lt; V_{P,k+1}\)</span> then the pond height
<span class="math">\(h_{pnd,tot}\)</span> is</p>
<div class="math" id="equation-topo_hpnd_tot">
<span class="eqno">(68)<a class="headerlink" href="#equation-topo_hpnd_tot" title="Permalink to this equation">¶</a></span>\[h_{pnd,tot} = h_{par} + h_{top,k} - h_{top,1},\]</div>
<p>where <span class="math">\(h_{par}\)</span> is the height of the pond above the level of the
ice in class <span class="math">\(k\)</span> and partially fills the volume between
<span class="math">\(V_{P,k}\)</span> and <span class="math">\(V_{P,k+1}\)</span>. From <a class="reference internal" href="#fig-topo"><span class="std std-ref">Figure 6</span></a> (a) we see
that <span class="math">\(h_{top,k} - h_{top,1}\)</span> is the height of the melt water,
which has volume <span class="math">\(V_{Pk}\)</span>, which completely fills the surface
categories up to category <span class="math">\(k\)</span>. The remaining volume,
<span class="math">\(V_{P} - V_{Pk}\)</span>, partially fills category <span class="math">\(k + 1\)</span> up to the
height <span class="math">\(h_{par}\)</span> and there are two cases to consider: either the
snow cover on category <span class="math">\(k + 1\)</span>, with height <span class="math">\(h_{s,k+1}\)</span>, is
completely covered in melt water (i.e., <span class="math">\(h_{par} &gt; h_{s,k+1}\)</span>), or
it is not (i.e., <span class="math">\(h_{par} \le h_{s,k+1}\)</span>). From conservation of
volume, we see from <a class="reference internal" href="#fig-topo"><span class="std std-ref">Figure 6</span></a> (a) that for an incompletely to
completely saturated snow cover on surface ice class <span class="math">\(k + 1\)</span>,</p>
<div class="math" id="equation-topo-satsnow1">
<span class="eqno">(69)<a class="headerlink" href="#equation-topo-satsnow1" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
V_{P} - V_{Pk} &amp; = &amp; h_{par} \left( \sum^k_{m=1} a_{ik} + a_{i,k+1}(1-a_{s,k+1})
+ a_{i,k+1} a_{s,k+1} V_{sw} \right)
&amp; &amp; {\rm for} \hspace{3mm} h_{par} \le h_{s,k+1},\end{aligned}\]</div>
<p>and for a saturated snow cover with water on top of the snow on surface
ice class <span class="math">\(k + 1\)</span>,</p>
<div class="math" id="equation-topo-satsnow2">
<span class="eqno">(70)<a class="headerlink" href="#equation-topo-satsnow2" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
V_{P} - V_{Pk} &amp; = &amp; h_{par} \left( \sum^k_{m=1} a_{ik} + a_{i,k+1}(1-a_{s,k+1}) \right)
   + a_{i,k+1} a_{s,k+1} V_{sw} h_{s,k+1} \\
&amp; + &amp; a_{i,k+1} a_{s,k+1} (h_{par}-h_{s,k+1})
&amp; &amp; {\rm for} \hspace{3mm} h_{par} &gt; h_{s,k+1}.\end{aligned}\end{split}\]</div>
<p>As the melting season progresses, not only does melt water accumulate
upon the upper surface of the sea ice, but the sea ice beneath the melt
water becomes more porous owing to a reduction in solid fraction
<a class="reference internal" href="zreferences.html#egprf04" id="id56">[11]</a>. The hydraulic head of melt water on sea
ice (i.e., its height above sea level) drives flushing of melt water
through the porous sea ice and into the underlying ocean. The mushy
thermodynamics scheme (<cite>ktherm</cite>&nbsp;= 2) handles flushing. For
<cite>ktherm</cite>&nbsp;<span class="math">\(\ne 2\)</span> we model the vertical flushing rate using Darcy’s
law for flow through a porous medium</p>
<div class="math" id="equation-topo-darcy">
<span class="eqno">(71)<a class="headerlink" href="#equation-topo-darcy" title="Permalink to this equation">¶</a></span>\[w = - \frac{\Pi_v}{\mu} \rho_o g \frac{\Delta H}{h_i},\]</div>
<p>where <span class="math">\(w\)</span> is the vertical mass flux per unit perpendicular
cross-sectional area (i.e., the vertical component of the Darcy
velocity), <span class="math">\(\Pi_v\)</span> is the vertical component of the permeability
tensor (assumed to be isotropic in the horizontal), <span class="math">\(\mu\)</span> is the
viscosity of water, <span class="math">\(\rho_o\)</span> is the ocean density, <span class="math">\(g\)</span> is
gravitational acceleration, <span class="math">\(\Delta H\)</span> is the the hydraulic head,
and <span class="math">\(h_i\)</span> is the thickness of the ice through which the pond
flushes. As proposed by <a class="reference internal" href="zreferences.html#gehmpz07" id="id57">[19]</a> the vertical
permeability of sea ice can be calculated from the liquid fraction
<span class="math">\(\phi\)</span>:</p>
<div class="math" id="equation-topo-permea">
<span class="eqno">(72)<a class="headerlink" href="#equation-topo-permea" title="Permalink to this equation">¶</a></span>\[\Pi_v = 3 \times 10^{-8} \phi^3 \rm{m^2}.\]</div>
<p>Since the solid fraction varies throughout the depth of the sea ice, so
does the permeability. The rate of vertical drainage is determined by
the lowest (least permeable) layer, corresponding to the highest solid
fraction. From the equations describing sea ice as a mushy layer
<a class="reference internal" href="zreferences.html#fuww06" id="id58">[13]</a>, the solid fraction is determined by:</p>
<div class="math" id="equation-topo-solid">
<span class="eqno">(73)<a class="headerlink" href="#equation-topo-solid" title="Permalink to this equation">¶</a></span>\[\phi = \frac{c_i-S}{c_i-S_{br}(T)},\]</div>
<p>where <span class="math">\(S\)</span> is the bulk salinity of the ice, <span class="math">\(S_{br}(T)\)</span> is
the concentration of salt in the brine at temperature <span class="math">\(T\)</span> and
<span class="math">\(c_i\)</span> is the concentration of salt in the ice crystals (set to
zero).</p>
<p>The hydraulic head is given by the difference in height between the
upper surface of the melt pond <span class="math">\(h_{pnd,tot}\)</span> and the sea level
<span class="math">\(h_{sl}\)</span>. The value of the sea level <span class="math">\(h_{sl}\)</span> is calculated
from</p>
<div class="math" id="equation-topo-hsl1">
<span class="eqno">(74)<a class="headerlink" href="#equation-topo-hsl1" title="Permalink to this equation">¶</a></span>\[h_{sl} = h_{sub} - 0.4 \sum^{N}_{n=1} a_{in} h_{in} - \beta h_{i1},\]</div>
<p>where <span class="math">\(0.4 \sum^{N}_{n=1} a_{in} h_{i,n}\)</span> is the mean thickness
of the basal depth classes, and <span class="math">\(h_{sub}\)</span> is the depth of the
submerged portion of the floe. <a class="reference internal" href="#fig-topo"><span class="std std-ref">Figure 6</span></a> (b) depicts the
relationship between the hydraulic head and the depths and heights that
appear in Equation <a class="reference internal" href="#equation-topo-hsl1">(74)</a>. The depth of the submerged portion
of the floe is determined from hydrostatic equilibrium to be</p>
<div class="math" id="equation-topo-hsl2">
<span class="eqno">(75)<a class="headerlink" href="#equation-topo-hsl2" title="Permalink to this equation">¶</a></span>\[h_{sub} = \frac{\rho_m}{\rho_w} V_P + \frac{\rho_s}{\rho_w} V_s + \frac{\rho_i}{\rho_w} V_i,\]</div>
<p>where <span class="math">\(\rho_m\)</span> is the density of melt water, <span class="math">\(V_P\)</span> is the
total pond volume, <span class="math">\(V_s\)</span> is the total snow volume, and <span class="math">\(V_i\)</span>
is the total ice volume.</p>
<p>When the surface energy balance is negative, a layer of ice is formed at
the upper surface of the ponds. The rate of growth of the ice lid is
given by the Stefan energy budget at the lid-pond interface</p>
<div class="math" id="equation-topo-lid">
<span class="eqno">(76)<a class="headerlink" href="#equation-topo-lid" title="Permalink to this equation">¶</a></span>\[\rho_i L_0 \frac{d h_{ipnd}}{dt} = k_i \frac{\partial T_i}{\partial z} - k_p \frac{\partial T_p}{\partial z},\]</div>
<p>where <span class="math">\(L_0\)</span> is the latent heat of fusion of pure ice per unit
volume, <span class="math">\(T_i\)</span> and <span class="math">\(T_p\)</span> are the ice surface and pond
temperatures, and <span class="math">\(k_i\)</span> and <span class="math">\(k_p\)</span> are the thermal
conductivity of the ice lid and pond respectively. The second term on
the right hand-side is close to zero since the pond is almost uniformly
at the freezing temperature <a class="reference internal" href="zreferences.html#tf04" id="id59">[48]</a>. Approximating the
temperature gradient in the ice lid as linear, the Stefan condition
yields the classic Stefan solution for ice lid depth</p>
<div class="math" id="equation-topo-stefan">
<span class="eqno">(77)<a class="headerlink" href="#equation-topo-stefan" title="Permalink to this equation">¶</a></span>\[h_{ipnd} = \sqrt{\frac{2k_i}{\rho_s L}\Delta T_i t},\]</div>
<p>where <span class="math">\(\Delta T\)</span> is the temperature difference between the top
and the bottom of the lid. Depending on the surface flux conditions the
ice lid can grow, partially melt, or melt completely. Provided that the
ice lid is thinner than a critical lid depth (1 cm is suggested) then
the pond is regarded as effective, i.e. the pond affects the optical
properties of the ice cover. Effective pond area and pond depth for each
thickness category are passed to the radiation scheme for calculating
albedo. Note that once the ice lid has exceeded the critical thickness,
snow may accumulate on the lid causing a substantial increase in albedo.
In the current CICE model, melt ponds only affect the thermodynamics of
the ice through the albedo. To conserve energy, the ice lid is dismissed
once the pond is completely refrozen.</p>
<p>As the sea ice area shrinks due to melting and ridging, the pond volume
over the lost area is released to the ocean immediately. In
<a class="reference internal" href="zreferences.html#fft10" id="id60">[16]</a>, the pond volume was carried as an ice area
tracer, but in <a class="reference internal" href="zreferences.html#fsfh12" id="id61">[17]</a> and here, pond area and
thickness are carried as separate tracers, as in
the&nbsp;<a class="reference internal" href="#tracers"><span class="std std-ref">Tracers</span></a> section.</p>
<p>Unlike the cesm and level-ice melt pond schemes, the liquid pond water
in the topo parameterization is not necessarily virtual; it can be
withheld from being passed to the ocean model until the ponds drain by
setting the namelist variable <code class="docutils literal"><span class="pre">l_mpond_fresh</span></code> = .true. The refrozen pond
lids are still virtual. Extra code needed to track and enforce
conservation of water has been added to <strong>icepack_itd.F90</strong> (subroutine
<em>zap_small_areas</em>), <strong>icepack_mechred.F90</strong> (subroutine <em>ridge_shift</em>),
<strong>icepack_therm_itd.F90</strong> (subroutines <em>linear_itd</em> and <em>lateral_melt</em>),
and <strong>icepack_therm_vertical.F90</strong> (subroutine <em>thermo_vertical</em>), along
with global diagnostics in <strong>icepack_diagnostics.F90</strong>.</p>
<p><strong>Level-ice formulation</strong> (<code class="docutils literal"><span class="pre">tr_pond_lvl</span></code> = true)</p>
<p>This meltpond parameterization represents a combination of ideas from
the empirical CESM melt pond scheme and the topo approach, and is
documented in <a class="reference internal" href="zreferences.html#hhl13" id="id62">[24]</a>. The ponds evolve according to
physically based process descriptions, assuming a thickness-area ratio
for changes in pond volume. A novel aspect of the new scheme is that the
ponds are carried as tracers on the level (undeformed) ice area of each
thickness category, thus limiting their spatial extent based on the
simulated sea ice topography. This limiting is meant to approximate the
horizontal drainage of melt water into depressions in ice floes. (The
primary difference between the level-ice and topo meltpond
parameterizations lies in how sea ice topography is taken into account
when determining the areal coverage of ponds.) Infiltration of the snow
by melt water postpones the appearance of ponds and the subsequent
acceleration of melting through albedo feedback, while snow on top of
refrozen pond ice also reduces the ponds’ effect on the radiation
budget.</p>
<p>Melt pond processes, described in more detail below, include addition of
liquid water from rain, melting snow and melting surface ice, drainage
of pond water when its weight pushes the ice surface below sea level or
when the ice interior becomes permeable, and refreezing of the pond
water. If snow falls after a layer of ice has formed on the ponds, the
snow may block sunlight from reaching the ponds below. When melt water
forms with snow still on the ice, the water is assumed to infiltrate the
snow. If there is enough water to fill the air spaces within the
snowpack, then the pond becomes visible above the snow, thus decreasing
the albedo and ultimately causing the snow to melt faster. The albedo
also decreases as snow depth decreases, and thus a thin layer of snow
remaining above a pond-saturated layer of snow will have a lower albedo
than if the melt water were not present.</p>
<p>The level-ice formulation assumes a thickness-area ratio for <em>changes</em>
in pond volume, while the CESM scheme assumes this ratio for the total
pond volume. Pond volume changes are distributed as changes to the area
and to the depth of the ponds using an assumed aspect ratio, or shape,
given by the parameter <span class="math">\(\delta_p\)</span> (<code class="docutils literal"><span class="pre">pndaspect</span></code>),
<span class="math">\(\delta_p = {\Delta h_p / \Delta a_{p}}\)</span> and
<span class="math">\(\Delta V = \Delta h_p \Delta a_{p} = \delta_p\Delta a_p^2  = \Delta h_{p}^2/\delta_p\)</span>.
Here, <span class="math">\(a_{p} = a_{pnd} a_{lvl}\)</span>, the mean pond area over the ice.</p>
<p>Given the ice velocity <span class="math">\(\bf u\)</span>, conservation equations for level
ice fraction <span class="math">\(a_{lvl}a_i\)</span>, pond area fraction
<span class="math">\(a_{pnd}a_{lvl}a_i\)</span>, pond volume <span class="math">\(h_{pnd}a_{pnd}a_{lvl}a_i\)</span>
and pond ice volume <span class="math">\(h_{ipnd}a_{pnd}a_{lvl}a_i\)</span> are</p>
<div class="math" id="equation-transport-lvl">
<span class="eqno">(78)<a class="headerlink" href="#equation-transport-lvl" title="Permalink to this equation">¶</a></span>\[{\partial\over\partial t} (a_{lvl}a_{i}) + \nabla \cdot (a_{lvl}a_{i} {\bf u}) = 0,\]</div>
<div class="math" id="equation-transport-apnd-lvl">
<span class="eqno">(79)<a class="headerlink" href="#equation-transport-apnd-lvl" title="Permalink to this equation">¶</a></span>\[{\partial\over\partial t} (a_{pnd}a_{lvl}a_{i}) + \nabla \cdot (a_{pnd}a_{lvl}a_{i} {\bf u}) = 0,\]</div>
<div class="math" id="equation-transport-hpnd-lvl">
<span class="eqno">(80)<a class="headerlink" href="#equation-transport-hpnd-lvl" title="Permalink to this equation">¶</a></span>\[{\partial\over\partial t} (h_{pnd}a_{pnd}a_{lvl}a_{i}) + \nabla \cdot (h_{pnd}a_{pnd}a_{lvl}a_{i} {\bf u}) = 0,\]</div>
<div class="math" id="equation-transport-ipnd-lvl">
<span class="eqno">(81)<a class="headerlink" href="#equation-transport-ipnd-lvl" title="Permalink to this equation">¶</a></span>\[{\partial\over\partial t} (h_{ipnd}a_{pnd}a_{lvl}a_{i}) + \nabla \cdot (h_{ipnd}a_{pnd}a_{lvl}a_{i} {\bf u}) = 0.\]</div>
<p>(We have dropped the category subscript here, for clarity.) Equations
<a class="reference internal" href="#equation-transport-hpnd-lvl">(80)</a> and <a class="reference internal" href="#equation-transport-ipnd-lvl">(81)</a> express
conservation of melt pond volume and pond ice volume, but in this form
highlight that the quantities tracked in the code are the tracers
<span class="math">\(h_{pnd}\)</span> and <span class="math">\(h_{ipnd}\)</span>, pond depth and pond ice thickness.
Likewise, the level ice fraction <span class="math">\(a_{lvl}\)</span> is a tracer on ice area
fraction (Equation&nbsp;<a class="reference internal" href="#equation-transport-lvl">(78)</a>), and pond fraction <span class="math">\(a_{pnd}\)</span> is
a tracer on level ice (Equation&nbsp;<a class="reference internal" href="#equation-transport-apnd-lvl">(79)</a>).</p>
<p><em>Pond ice.</em> The ponds are assumed to be well mixed fresh water, and
therefore their temperature is 0<span class="math">\(^\circ\)</span>C. If the air
temperature is cold enough, a layer of clear ice may form on top of the
ponds. There are currently three options in the code for refreezing the
pond ice. Only option A tracks the thickness of the lid ice using the
tracer <span class="math">\(h_{ipnd}\)</span> and includes the radiative effect of snow on top
of the lid.</p>
<p>A. The <code class="docutils literal"><span class="pre">frzpnd</span></code> = ‘hlid’ option uses a Stefan approximation for growth of
fresh ice and is invoked only when <span class="math">\(\Delta V_{melt}=0\)</span>.</p>
<p>The basic thermodynamic equation governing ice growth is</p>
<div class="math" id="equation-Stefanthermo1">
<span class="eqno">(82)<a class="headerlink" href="#equation-Stefanthermo1" title="Permalink to this equation">¶</a></span>\[\rho_i L {\partial h_i\over\partial t} = k_i{\partial T_i\over\partial z} \sim k_i {\Delta T\over h_i}\]</div>
<p>assuming a linear temperature profile through the ice thickness
<span class="math">\(h_i\)</span>. In discrete form, the solution is</p>
<div class="math" id="equation-hi">
<span class="eqno">(83)<a class="headerlink" href="#equation-hi" title="Permalink to this equation">¶</a></span>\[\begin{split}\Delta h_i = \left\{
\begin{array}{ll}    {\sqrt{\beta\Delta t}/2} &amp; \mbox {if $h_i=0$} \\
                                {\beta\Delta t / 2 h_i} &amp; \mbox {if $h_i&gt;0,$}
\end{array} \right.\end{split}\]</div>
<p>where</p>
<div class="math" id="equation-beta">
<span class="eqno">(84)<a class="headerlink" href="#equation-beta" title="Permalink to this equation">¶</a></span>\[\beta = {2 k_i \Delta T \over \rho_i L} .\]</div>
<p>When <span class="math">\(\Delta V_{melt}&gt;0\)</span>, any existing pond ice may also melt. In
this case,</p>
<div class="math" id="equation-ipndmelt">
<span class="eqno">(85)<a class="headerlink" href="#equation-ipndmelt" title="Permalink to this equation">¶</a></span>\[\Delta h_i = -\min\left({\max(F_\circ, 0) \Delta t \over \rho_i L}, h_i\right),\]</div>
<p>where <span class="math">\(F_\circ\)</span> is the net downward surface flux.</p>
<p>In either case, the change in pond volume associated with growth or melt
of pond ice is</p>
<div class="math" id="equation-vfrz">
<span class="eqno">(86)<a class="headerlink" href="#equation-vfrz" title="Permalink to this equation">¶</a></span>\[\Delta V_{frz} = -\Delta h_i a_{pnd} a_{lvl} a_i {\rho_i/\rho_0},\]</div>
<p>where <span class="math">\(\rho_0\)</span> is the density of fresh water.</p>
<p>B. The <code class="docutils literal"><span class="pre">frzpnd</span></code> = ‘cesm’ option uses the same empirical function as in the
CESM melt pond parameterization.</p>
<p><em>Radiative effects.</em> Freshwater ice that has formed on top of a melt
pond is assumed to be perfectly clear. Snow may accumulate on top of the
pond ice, however, shading the pond and ice below. The depth of the snow
on the pond ice is initialized as <span class="math">\(h_{ps}^0 = F_{snow}\Delta t\)</span> at
the first snowfall after the pond ice forms. From that time until either
the pond ice or the pond snow disappears, the pond snow depth tracks the
depth of snow on sea ice (<span class="math">\(h_s\)</span>) using a constant difference
<span class="math">\(\Delta\)</span>. As <span class="math">\(h_s\)</span> melts, <span class="math">\(h_{ps}=h_s-\Delta\)</span> will be
reduced to zero eventually, at which time the pond ice is fully
uncovered and shortwave radiation passes through.</p>
<p>To prevent a sudden change in the shortwave reaching the sea ice (which
can prevent the thermodynamics from converging), thin layers of snow on
pond ice are assumed to be patchy, thus allowing the shortwave flux to
increase gradually as the layer thins. This is done using the same
parameterization for patchy snow as is used elsewhere in Icepack, but with
its own parameter <span class="math">\(h_{s1}\)</span>:</p>
<div class="math" id="equation-apndeff">
<span class="eqno">(87)<a class="headerlink" href="#equation-apndeff" title="Permalink to this equation">¶</a></span>\[a_{pnd}^{eff} = \left(1 - \min\left(h_{ps}/h_{s1}, 1\right)\right) a_{pnd} a_{lvl}.\]</div>
<p>If any of the pond ice melts, the radiative flux allowed to pass through
the ice is reduced by the (roughly) equivalent flux required to melt
that ice. This is accomplished (approximately) with
<span class="math">\(a_{pnd}^{eff} = (1-f_{frac})a_{pnd}a_{lvl}\)</span>, where (see
Equation&nbsp;<a class="reference internal" href="#equation-ipndmelt">(85)</a>)</p>
<div class="math" id="equation-snowinf">
<span class="eqno">(88)<a class="headerlink" href="#equation-snowinf" title="Permalink to this equation">¶</a></span>\[f_{frac} = \min\left(-{\rho_i L\Delta h_i\over F_\circ \Delta t}, 1 \right) .\]</div>
<p><em>Snow infiltration by pond water.</em> If there is snow on top of the sea
ice, melt water may infiltrate the snow. It is a “virtual process” that
affects the model’s thermodynamics through the input parameters of the
radiation scheme; it does not melt the snow or affect the snow heat
content.</p>
<p>A snow pack is considered saturated when its percentage of liquid water
content is greater or equal to 15% (Sturm and others, 2009). We assume
that if the volume fraction of retained melt water to total liquid
content</p>
<div class="math" id="equation-snowinf2">
<span class="eqno">(89)<a class="headerlink" href="#equation-snowinf2" title="Permalink to this equation">¶</a></span>\[r_p = {V_p\over V_p + V_s \rho_s / \rho_0} &lt; 0.15,\]</div>
<p>then effectively there are no meltponds present, that is,
<span class="math">\(a_{pnd}^{eff}=h_{pnd}^{eff}=0\)</span>. Otherwise, we
assume that the snowpack is saturated with liquid water.</p>
<p>We assume that all of the liquid water accumulates at the base of the
snow pack and would eventually melt the surrounding snow. Two
configurations are therefore possible, (1) the top of the liquid lies
below the snow surface and (2) the liquid water volume overtops the
snow, and all of the snow is assumed to have melted into the pond. The
volume of void space within the snow that can be filled with liquid melt
water is</p>
<div class="math" id="equation-volmelt">
<span class="eqno">(90)<a class="headerlink" href="#equation-volmelt" title="Permalink to this equation">¶</a></span>\[V_{mx}=h_{mx}a_{p} = {\left(\rho_0-\rho_s\over \rho_0\right)}h_s a_{p},\]</div>
<p>and we compare <span class="math">\(V_p\)</span> with <span class="math">\(V_{mx}\)</span>.</p>
<p>Case 1: For <span class="math">\(V_p &lt; V_{mx}\)</span>, we define <span class="math">\(V_p^{eff}\)</span> to
be the volume of void space filled by the volume <span class="math">\(V_p\)</span> of melt
water: <span class="math">\(\rho_0 V_p =  (\rho_0-\rho_s) V_p^{eff},\)</span> or in
terms of depths,</p>
<div class="math" id="equation-hpndeff">
<span class="eqno">(91)<a class="headerlink" href="#equation-hpndeff" title="Permalink to this equation">¶</a></span>\[h_p^{eff} = {\left(\rho_0  \over \rho_0 - \rho_s\right)}h_{pnd}.\]</div>
<p>The liquid water under the snow layer is not visible and therefore the
ponds themselves have no direct impact on the radiation
(<span class="math">\(a_{pnd}^{eff}=h_{pnd}^{eff}=0\)</span>), but the
effective snow thickness used for the radiation scheme is reduced to</p>
<div class="math" id="equation-hseff">
<span class="eqno">(92)<a class="headerlink" href="#equation-hseff" title="Permalink to this equation">¶</a></span>\[h_s^{eff} = h_s - h_p^{eff}a_p = h_s - {\rho_0 \over \rho_0 - \rho_s}h_{pnd} a_p.\]</div>
<p>Here, the factor <span class="math">\(a_p=a_{pnd}a_{lvl}\)</span> averages the reduced snow
depth over the ponds with the full snow depth over the remainder of the
ice; that is, <span class="math">\(h_s^{eff} = h_s(1-a_p) + (h_s -h_p^{eff})a_p.\)</span></p>
<p>Case 2: Similarly, for <span class="math">\(V_p \ge V_{mx}\)</span>, the total mass in the
liquid is <span class="math">\(\rho_0 V_p + \rho_s V_s = \rho_0 V_p^{eff},\)</span> or</p>
<div class="math" id="equation-hpeff">
<span class="eqno">(93)<a class="headerlink" href="#equation-hpeff" title="Permalink to this equation">¶</a></span>\[h_p^{eff} = {\rho_0 h_{pnd} + \rho_s h_{s} \over \rho_0}.\]</div>
<p>Thus the effective depth of the pond is the depth of the whole slush
layer <span class="math">\(h_p^{eff}\)</span>. In this case,
<span class="math">\(a_{pnd}^{eff}=a_{pnd}a_{lvl}\)</span>.</p>
<p><em>Drainage.</em> A portion <span class="math">\(1-r\)</span> of the available melt water drains
immediately into the ocean. Once the volume changes described above have
been applied and the resulting pond area and depth calculated, the pond
depth may be further reduced if the top surface of the ice would be
below sea level or if the sea ice becomes permeable.</p>
<p>We require that the sea ice surface remain at or above sea level. If the
weight of the pond water would push the mean ice–snow interface of a
thickness category below sea level, some or all of the pond water is
removed to bring the interface back to sea level via Archimedes’
Principle written in terms of the draft <span class="math">\(d\)</span>,</p>
<div class="math" id="equation-freeboard">
<span class="eqno">(94)<a class="headerlink" href="#equation-freeboard" title="Permalink to this equation">¶</a></span>\[\rho_i h_i + \rho_s h_s + \rho_0 h_p = \rho_w d \le \rho_w h_i.\]</div>
<p>There is a separate freeboard calculation in the thermodynamics which
considers only the ice and snow and converts flooded snow to sea ice.
Because the current melt ponds are “virtual” in the sense that they only
have a radiative influence, we do not allow the pond mass to change the
sea ice and snow masses at this time, although this issue may need to be
reconsidered in the future, especially for the Antarctic.</p>
<p>The mushy thermodynamics scheme (<cite>ktherm</cite>&nbsp;= 2) handles flushing.
For <cite>ktherm</cite>&nbsp;<span class="math">\(\ne 2\)</span>, the permeability of the sea ice is calculated
using the internal ice temperatures <span class="math">\(T_i\)</span> (computed from the
enthalpies as in the sea ice thermodynamics). The brine salinity and
liquid fraction are given by <a class="reference internal" href="zreferences.html#notz05" id="id63">[39]</a> [eq 3.6]
<span class="math">\(S_{br} = {1/ (10^{-3} - 0.054/T_i)}\)</span> and <span class="math">\(\phi = S/S_{br}\)</span>,
where <span class="math">\(S\)</span> is the bulk salinity of the combined ice and brine. The
ice is considered permeable if <span class="math">\(\phi \ge 0.05\)</span> with a permeability
of <span class="math">\(p=3\times 10^{-8}\min(\phi^3)\)</span> (the minimum being taken over
all of the ice layers). A hydraulic pressure head is computed as
<span class="math">\(P=g\rho_w\Delta h\)</span> where <span class="math">\(\Delta h\)</span> is the height of the
pond and sea ice above sea level. Then the volume of water drained is
given by</p>
<div class="math" id="equation-vperm">
<span class="eqno">(95)<a class="headerlink" href="#equation-vperm" title="Permalink to this equation">¶</a></span>\[\Delta V_{perm} = -a_{pnd} \min\left(h_{pnd}, {p P d_p \Delta t \over \mu h_i}\right),\]</div>
<p>where <span class="math">\(d_p\)</span> is a scaling factor (dpscale), and
<span class="math">\(\mu=1.79\times 10^{-3}\)</span>&nbsp;kg&nbsp;m <span class="math">\(^{-1}\)</span>&nbsp;s <span class="math">\(^{-1}\)</span> is the
dynamic viscosity.</p>
<p><em>Conservation elsewhere.</em> When ice ridges and when new ice forms in open
water, the level ice area changes and ponds must be handled
appropriately. For example, when sea ice deforms, some of the level ice
is transformed into ridged ice. We assume that pond water (and ice) on
the portion of level ice that ridges is lost to the ocean. All of the
tracer volumes are altered at this point in the code, even though
<span class="math">\(h_{pnd}\)</span> and <span class="math">\(h_{ipnd}\)</span> should not change; compensating
factors in the tracer volumes cancel out (subroutine <em>ridge_shift</em> in
<strong>icepack_mechred.F90</strong>).</p>
<p>When new ice forms in open water, level ice is added to the existing sea
ice, but the new level ice does not yet have ponds on top of it.
Therefore the fractional coverage of ponds on level ice decreases
(thicknesses are unchanged). This is accomplished in
<strong>icepack_therm_itd.F90</strong> (subroutine <em>add_new_ice</em>) by maintaining the
same mean pond area in a grid cell after the addition of new ice,</p>
<div class="math" id="equation-apndprime">
<span class="eqno">(96)<a class="headerlink" href="#equation-apndprime" title="Permalink to this equation">¶</a></span>\[a_{pnd}^\prime (a_{lvl}+\Delta a_{lvl}) (a_i+\Delta a_i)   = a_{pnd} a_{lvl} a_i,\]</div>
<p>and solving for the new pond area tracer <span class="math">\(a_{pnd}^\prime\)</span> given
the newly formed ice area <span class="math">\(\Delta a_i = \Delta a_{lvl}\)</span>.</p>
</div>
<div class="section" id="thermodynamic-surface-forcing-balance">
<span id="sfc-forcing"></span><h4>2.2.4.2. Thermodynamic surface forcing balance<a class="headerlink" href="#thermodynamic-surface-forcing-balance" title="Permalink to this headline">¶</a></h4>
<p>The net surface energy flux from the atmosphere to the ice (with all
fluxes defined as positive downward) is</p>
<div class="math" id="equation-f0">
<span class="eqno">(97)<a class="headerlink" href="#equation-f0" title="Permalink to this equation">¶</a></span>\[F_0 = F_s + F_l + F_{L\downarrow} + F_{L\uparrow} +
         (1-\alpha) (1-i_0) F_{sw},\]</div>
<p>where <span class="math">\(F_s\)</span> is the sensible heat flux, <span class="math">\(F_l\)</span> is the latent
heat flux, <span class="math">\(F_{L\downarrow}\)</span> is the incoming longwave flux,
<span class="math">\(F_{L\uparrow}\)</span> is the outgoing longwave flux, <span class="math">\(F_{sw}\)</span> is
the incoming shortwave flux, <span class="math">\(\alpha\)</span> is the shortwave albedo, and
<span class="math">\(i_0\)</span> is the fraction of absorbed shortwave flux that penetrates
into the ice. The albedo may be altered by the presence of melt ponds.
Each of the explicit melt pond parameterizations (CESM, topo and
level-ice ponds) should be used in conjunction with the Delta-Eddington
shortwave scheme, described below.</p>
<p><em>Shortwave radiation: Delta-Eddington</em></p>
<p>Two methods for computing albedo and shortwave fluxes are available, the
“ccsm3” method, described below, and a multiple scattering
radiative transfer scheme that uses a Delta-Eddington approach.
“Inherent” optical properties (IOPs) for snow and sea ice, such as
extinction coefficient and single scattering albedo, are prescribed
based on physical measurements; reflected, absorbed and transmitted
shortwave radiation (“apparent” optical properties) are then computed
for each snow and ice layer in a self-consistent manner. Absorptive
effects of inclusions in the ice/snow matrix such as dust and algae can
also be included, along with radiative treatment of melt ponds and other
changes in physical properties, for example granularization associated
with snow aging. The Delta-Eddington formulation is described in detail
in <a class="reference internal" href="zreferences.html#bl07" id="id64">[8]</a>. Since publication of this technical paper,
a number of improvements have been made to the Delta-Eddington scheme,
including a surface scattering layer and internal shortwave absorption
for snow, generalization for multiple snow layers and more than four
layers of ice, and updated IOP values.</p>
<p>The namelist parameters <code class="docutils literal"><span class="pre">R_ice</span></code> and <code class="docutils literal"><span class="pre">R_pnd</span></code> adjust the albedo of bare or
ponded ice by the product of the namelist value and one standard
deviation. For example, if <code class="docutils literal"><span class="pre">R_ice</span></code> = 0.1, the albedo increases by
<span class="math">\(0.1\sigma\)</span>. Similarly, setting <code class="docutils literal"><span class="pre">R_snw</span></code> = 0.1 decreases the snow
grain radius by <span class="math">\(0.1\sigma\)</span> (thus increasing the albedo). Two
additional tuning parameters are available for this scheme, <code class="docutils literal"><span class="pre">dT_mlt</span></code> and
<code class="docutils literal"><span class="pre">rsnw_mlt</span></code>. <code class="docutils literal"><span class="pre">dT_mlt</span></code> is the temperature change needed for a change in snow
grain radius from non-melting to melting, and <code class="docutils literal"><span class="pre">rsnw_mlt</span></code> is the maximum
snow grain radius when melting. An absorption coefficient for algae
(<code class="docutils literal"><span class="pre">kalg</span></code>) may also be set. See <a class="reference internal" href="zreferences.html#bl07" id="id65">[8]</a> for details; the
CESM melt pond and Delta-Eddington parameterizations are further
explained and validated in <a class="reference internal" href="zreferences.html#hbblh12" id="id66">[22]</a>.</p>
<p><em>Shortwave radiation: CCSM3</em></p>
<p>In the parameterization used in the previous version of the Community
Climate System Model (CCSM3), the albedo depends on the temperature and
thickness of ice and snow and on the spectral distribution of the
incoming solar radiation. Albedo parameters have been chosen to fit
observations from the SHEBA field experiment. For
<span class="math">\(T_{sf} &lt; -1^{\circ}C\)</span> and <span class="math">\(h_i &gt; ` ``ahmax`\)</span>, the bare ice
albedo is 0.78 for visible wavelengths (<span class="math">\(&lt;700\)</span>nm) and 0.36 for
near IR wavelengths (<span class="math">\(&gt;700\)</span>nm). As <span class="math">\(h_i\)</span> decreases from
ahmax to zero, the ice albedo decreases smoothly (using an arctangent
function) to the ocean albedo, 0.06. The ice albedo in both spectral
bands decreases by 0.075 as <span class="math">\(T_{sf}\)</span> rises from
<span class="math">\(-1^{\circ}C\)</span> to . The albedo of cold snow (<span class="math">\(T_{sf} &lt;
-1^{\circ}C\)</span>) is 0.98 for visible wavelengths and 0.70 for near IR
wavelengths. The visible snow albedo decreases by 0.10 and the near IR
albedo by 0.15 as <span class="math">\(T_{sf}\)</span> increases from <span class="math">\(-1^{\circ}C\)</span>
to <span class="math">\(0^{\circ}C\)</span>. The total albedo is an area-weighted average of the ice and snow
albedos, where the fractional snow-covered area is</p>
<div class="math" id="equation-snowfrac">
<span class="eqno">(98)<a class="headerlink" href="#equation-snowfrac" title="Permalink to this equation">¶</a></span>\[f_{snow} = \frac{h_s}{h_s + h_{snowpatch}},\]</div>
<p>and <span class="math">\(h_{snowpatch} = 0.02 \ {\mathrm m}\)</span>. The envelope
of albedo values is shown in <a class="reference internal" href="#fig-albedo"><span class="std std-ref">Figure 7</span></a>. This albedo
formulation incorporates the effects of melt ponds implicitly; the
explicit melt pond parameterization is not used in this case.</p>
<div class="figure align-center" id="id124">
<span id="fig-albedo"></span><a class="reference internal image-reference" href="_images/albedo.png"><img alt="_images/albedo.png" src="_images/albedo.png" style="width: 586.6px; height: 441.6px;" /></a>
<p class="caption"><span class="caption-text">Figure 7</span></p>
</div>
<p><a class="reference internal" href="#fig-albedo"><span class="std std-ref">Figure 7</span></a> : Albedo as a function of ice thickness and temperature,
for the two extrema in snow depth, for the default (CCSM3) shortwave
option. Maximum snow depth is computed based on Archimedes’ Principle
for the given ice thickness. These curves represent the envelope of
possible albedo values.</p>
<p>The net absorbed shortwave flux is <span class="math">\(F_{swabs} = \sum
(1-\alpha_j) F_{sw\downarrow}\)</span>, where the summation is over four
radiative categories (direct and diffuse visible, direct and diffuse
near infrared). The flux penetrating into the ice is <span class="math">\(I_0
= i_0 \, F_{swabs}\)</span>, where <span class="math">\(i_0 = 0.70 \, (1-f_{snow})\)</span>
for visible radiation and <span class="math">\(i_0 = 0\)</span> for near IR. Radiation
penetrating into the ice is attenuated according to Beer’s Law:</p>
<div class="math" id="equation-Beers-law">
<span class="eqno">(99)<a class="headerlink" href="#equation-Beers-law" title="Permalink to this equation">¶</a></span>\[I(z) = I_0 \exp(-\kappa_i z),\]</div>
<p>where <span class="math">\(I(z)\)</span> is the shortwave flux that reaches depth <span class="math">\(z\)</span>
beneath the surface without being absorbed, and <span class="math">\(\kappa_i\)</span> is the
bulk extinction coefficient for solar radiation in ice, set to
<span class="math">\(1.4 \
{\mathrm m^{-1}}\)</span> for visible wavelengths <a class="reference internal" href="zreferences.html#esc95" id="id67">[10]</a>. A
fraction <span class="math">\(\exp(-\kappa_i h_i)\)</span> of the penetrating solar radiation
passes through the ice to the ocean
(<span class="math">\(F_{sw\Downarrow}\)</span>).</p>
<p><em>Longwave radiation, turbulent fluxes</em></p>
<p>While incoming shortwave and longwave radiation are obtained from the
atmosphere, outgoing longwave radiation and the turbulent heat fluxes
are derived quantities. Outgoing longwave takes the standard blackbody
form, <span class="math">\(F_{L\uparrow}=\epsilon\sigma
\left(T_{sf}^{K}\right)^4\)</span>, where <span class="math">\(\epsilon=0.95\)</span> is the
emissivity of snow or ice, <span class="math">\(\sigma\)</span> is the Stefan-Boltzmann
constant and <span class="math">\(T_{sf}^{K}\)</span> is the surface temperature in
Kelvin. (The longwave fluxes are partitioned such that
<span class="math">\(\epsilon F_{L\downarrow}\)</span> is absorbed at the surface, the
remaining <span class="math">\(\left(1-\epsilon\right)F_{L\downarrow}\)</span> being returned
to the atmosphere via <span class="math">\(F_{L\uparrow}\)</span>.) The sensible heat flux is
proportional to the difference between air potential temperature and the
surface temperature of the snow or snow-free ice,</p>
<div class="math" id="equation-flux1">
<span class="eqno">(100)<a class="headerlink" href="#equation-flux1" title="Permalink to this equation">¶</a></span>\[F_s = C_s \left(\Theta_a - T_{sf}^K\right).\]</div>
<p><span class="math">\(C_s\)</span> and <span class="math">\(C_l\)</span> (below) are nonlinear turbulent heat
transfer coefficients described in the&nbsp;<a class="reference internal" href="#atmo"><span class="std std-ref">Atmosphere</span></a> section. Similarly,
the latent heat flux is proportional to the difference between
<span class="math">\(Q_a\)</span> and the surface saturation specific humidity <span class="math">\(Q_{sf}\)</span>:</p>
<div class="math">
\[\begin{split}\begin{aligned}
F_l&amp;=&amp; C_l\left(Q_a - Q_{sf}\right),\\
Q_{sf}&amp;=&amp;(q_1 / \rho_a)  \exp(-q_2 / T_{sf}^K),\end{aligned}\end{split}\]</div>
<p>where <span class="math">\(q_1 = 1.16378 \times 10^7 \, \mathrm{kg/m^3}\)</span>,
<span class="math">\(q_2 =
5897.8 \, \mathrm{K}\)</span>, <span class="math">\(T_{sf}^K\)</span> is the surface temperature in
Kelvin, and <span class="math">\(\rho_a\)</span> is the surface air density.</p>
<p>The net downward heat flux from the ice to the ocean is given by
<a class="reference internal" href="zreferences.html#mm95" id="id68">[36]</a>:</p>
<div class="math" id="equation-fbot">
<span class="eqno">(101)<a class="headerlink" href="#equation-fbot" title="Permalink to this equation">¶</a></span>\[F_{bot} = -\rho_w c_w c_h u_* (T_w - T_f),\]</div>
<p>where <span class="math">\(\rho_w\)</span> is the density of seawater, <span class="math">\(c_w\)</span> is the
specific heat of seawater, <span class="math">\(c_h = 0.006\)</span> is a heat transfer
coefficient, <span class="math">\(u_*=\sqrt{\left|\vec{\tau}_w\right|/\rho_w}\)</span> is the
friction velocity, and <span class="math">\(T_w\)</span> is the sea surface temperature. A
minimum value of <span class="math">\(u_*\)</span> is available; we recommend
<span class="math">\(u_{*\min} = 5\times 10^{-4}\)</span>&nbsp;m/s, but the optimal value may
depend on the ocean forcing used and can be as low as 0.</p>
<p><span class="math">\(F_{bot}\)</span> is limited by the total amount of heat available from
the ocean, <span class="math">\(F_{frzmlt}\)</span>. Additional heat,
<span class="math">\(F_{side}\)</span>, is used to melt the ice laterally following
<a class="reference internal" href="zreferences.html#mp87" id="id69">[37]</a> and <a class="reference internal" href="zreferences.html#steele92" id="id70">[46]</a>.
<span class="math">\(F_{bot}\)</span> and the fraction of ice melting laterally are scaled so
that <span class="math">\(F_{bot} + F_{side} \ge F_{frzmlt}\)</span> in the case that
<span class="math">\(F_{frzmlt}&lt;0\)</span> (melting; see
<a class="reference internal" href="#thermo-growth"><span class="std std-ref">Growth and melting</span></a>).</p>
</div>
<div class="section" id="new-temperatures">
<span id="thermo-temp"></span><h4>2.2.4.3. New temperatures<a class="headerlink" href="#new-temperatures" title="Permalink to this headline">¶</a></h4>
<p><strong>Zero-layer thermodynamics</strong> (<code class="docutils literal"><span class="pre">ktherm</span></code> = 0)
An option for zero-layer thermodynamics <a class="reference internal" href="zreferences.html#semtner76" id="id71">[44]</a> is
available in this version of Icepack by setting the namelist parameter
<code class="docutils literal"><span class="pre">ktherm</span></code> to 0 and changing the number of ice layers, nilyr, in
<strong>icepack_domain_size.F90</strong> to 1. In the zero-layer case, the ice is
fresh and the thermodynamic calculations are much simpler than in the
other configurations, which we describe here.</p>
<p><strong>Bitz and Lipscomb thermodynamics</strong> (<code class="docutils literal"><span class="pre">ktherm</span></code> = 1)</p>
<p>The “BL99” thermodynamic sea ice model is based on
<a class="reference internal" href="zreferences.html#mu71" id="id72">[38]</a> and <a class="reference internal" href="zreferences.html#bl99" id="id73">[7]</a>, and is
described more fully in <a class="reference internal" href="zreferences.html#lipscomb98" id="id74">[30]</a>. The vertical
salinity profile is prescribed and is unchanging in time. The snow is
assumed to be fresh, and the midpoint salinity <span class="math">\(S_{ik}\)</span> in each
ice layer is given by</p>
<div class="math" id="equation-salinity">
<span class="eqno">(102)<a class="headerlink" href="#equation-salinity" title="Permalink to this equation">¶</a></span>\[S_{ik} = {1\over 2}S_{\max} [1-\cos(\pi z^{(\frac{a}{z+b})})],\]</div>
<p>where <span class="math">\(z \equiv (k-1/2)/N_i\)</span>, <span class="math">\(S_{\max} = 3.2\)</span> ppt, and
<span class="math">\(a=0.407\)</span> and <span class="math">\(b=0.573\)</span> are determined from a
least-squares fit to the salinity profile observed in multiyear sea
ice by <a class="reference internal" href="zreferences.html#schwarzacher59" id="id75">[43]</a>. This profile varies from
<span class="math">\(S=0\)</span> at the top surface (<span class="math">\(z = 0\)</span>) to <span class="math">\(S=S_{\max}\)</span>
at the bottom surface (<span class="math">\(z=1\)</span>) and is similar to that used by
<a class="reference internal" href="zreferences.html#mu71" id="id76">[38]</a>. Equation <a class="reference internal" href="#equation-salinity">(102)</a> is fairly accurate
for ice that has drained at the top surface due to summer melting. It
is not a good approximation for cold first-year ice, which has a more
vertically uniform salinity because it has not yet drained. However,
the effects of salinity on heat capacity are small for temperatures
well below freezing, so the salinity error does not lead to
significant temperature errors.</p>
<p><em>Temperature updates.</em></p>
<p>Given the temperatures <span class="math">\(T_{sf}^m\)</span>,
<span class="math">\(T_s^m\)</span>, and <span class="math">\(T_{ik}^m\)</span> at time&nbsp;<span class="math">\(m\)</span>, we solve a set
of finite-difference equations to obtain the new temperatures at
time&nbsp;<span class="math">\(m+1\)</span>. Each temperature is coupled to the temperatures of
the layers immediately above and below by heat conduction terms that are
treated implicitly. For example, the rate of change of <span class="math">\(T_{ik}\)</span>
depends on the new temperatures in layers <span class="math">\(k-1\)</span>, <span class="math">\(k\)</span>, and
<span class="math">\(k+1\)</span>. Thus we have a set of equations of the form</p>
<div class="math" id="equation-tridiag">
<span class="eqno">(103)<a class="headerlink" href="#equation-tridiag" title="Permalink to this equation">¶</a></span>\[{\bf A} {\bf x} = {\bf b},\]</div>
<p>where <span class="math">\({\bf A}\)</span> is a tridiagonal matrix, <span class="math">\({\bf x}\)</span> is a
column vector whose components are the unknown new temperatures, and
<span class="math">\({\bf b}\)</span> is another column vector. Given <span class="math">\({\bf A}\)</span> and
<span class="math">\({\bf b}\)</span>, we can compute <span class="math">\({\bf x}\)</span> with a standard
tridiagonal solver.</p>
<p>There are four general cases: (1)&nbsp;<span class="math">\(T_{sf} &lt; 0^{\circ}C\)</span>, snow
present; (2)&nbsp;<span class="math">\(T_{sf} = 0^{\circ}C\)</span>, snow present;
(3)&nbsp;<span class="math">\(T_{sf} &lt; 0^{\circ}C\)</span>, snow absent; and
(4)&nbsp;<span class="math">\(T_{sf} = 0^{\circ}C\)</span>, snow absent. For case 1 we have
one equation (the top row of the matrix) for the new surface
temperature, <span class="math">\(N_s\)</span> equations for the new snow temperatures, and
<span class="math">\(N_i\)</span> equations for the new ice temperatures. For cases 2 and 4 we
omit the equation for the surface temperature, which is held at , and
for cases 3 and 4 we omit the snow temperature equations. Snow is
considered absent if the snow depth is less than a user-specified
minimum value, <code class="docutils literal"><span class="pre">hs_min</span></code>. (Very thin snow layers are still transported
conservatively by the transport modules; they are simply ignored by the
thermodynamics.)</p>
<p>The rate of temperature change in the ice interior is given by
<a class="reference internal" href="zreferences.html#mu71" id="id77">[38]</a>:</p>
<div class="math" id="equation-ice-temp-change">
<span class="eqno">(104)<a class="headerlink" href="#equation-ice-temp-change" title="Permalink to this equation">¶</a></span>\[\rho_i c_i \frac{\partial T_i}{\partial t} =
 \frac{\partial}{\partial z} \left(K_i \frac{\partial T_i}{\partial z}\right)
 - \frac{\partial}{\partial z} [I_{pen}(z)],\]</div>
<p>where <span class="math">\(\rho_i = 917 \ \mathrm {kg/m^{3}}\)</span> is the sea ice density
(assumed to be uniform), <span class="math">\(c_i(T,S)\)</span> is the specific heat of sea
ice, <span class="math">\(K_i(T,S)\)</span> is the thermal conductivity of sea ice,
<span class="math">\(I_{pen}\)</span> is the flux of penetrating solar radiation at
depth <span class="math">\(z\)</span>, and <span class="math">\(z\)</span> is the vertical coordinate, defined to be
positive downward with <span class="math">\(z = 0\)</span> at the top surface. If <code class="docutils literal"><span class="pre">shortwave</span></code> =
‘default’, the penetrating radiation is given by Beer’s Law:</p>
<div class="math">
\[I_{pen}(z) = I_0 \exp(-\kappa_i z),\]</div>
<p>where <span class="math">\(I_0\)</span> is the penetrating solar flux at the top ice surface
and <span class="math">\(\kappa_i\)</span> is an extinction coefficient. If <code class="docutils literal"><span class="pre">shortwave</span></code> =
‘dEdd’, then solar absorption is computed by the Delta-Eddington scheme.</p>
<p>The specific heat of sea ice is given to an excellent approximation by
<a class="reference internal" href="zreferences.html#ono67" id="id78">[40]</a></p>
<div class="math" id="equation-heat-capacity">
<span class="eqno">(105)<a class="headerlink" href="#equation-heat-capacity" title="Permalink to this equation">¶</a></span>\[c_i(T,S) = c_0 + \frac{L_0 \mu S}{T^2},\]</div>
<p>where <span class="math">\(c_0 = 2106\)</span>&nbsp;J/kg/deg is the specific heat of fresh ice at
, <span class="math">\(L_0 = 3.34 \times 10^5\)</span>&nbsp;J/kg is the latent heat of fusion of
fresh ice at , and <span class="math">\(\mu = 0.054\)</span>&nbsp;deg/ppt is the (liquidus) ratio
between the freezing temperature and salinity of brine.</p>
<p>Following <a class="reference internal" href="zreferences.html#untersteiner64" id="id79">[53]</a> and
<a class="reference internal" href="zreferences.html#mu71" id="id80">[38]</a>, the standard thermal conductivity
(<code class="docutils literal"><span class="pre">conduct</span></code> = ‘MU71’) is given by</p>
<div class="math" id="equation-conductivity">
<span class="eqno">(106)<a class="headerlink" href="#equation-conductivity" title="Permalink to this equation">¶</a></span>\[K_i(T,S) = K_0 + \frac{\beta S}{T},\]</div>
<p>where <span class="math">\(K_0 = 2.03\)</span>&nbsp;W/m/deg is the conductivity of fresh ice and
<span class="math">\(\beta = 0.13\)</span>&nbsp;W/m/ppt is an empirical constant. Experimental
results <a class="reference internal" href="zreferences.html#twmh01" id="id81">[50]</a> suggest that Equation <a class="reference internal" href="#equation-conductivity">(106)</a> may
not be a good description of the thermal conductivity of sea ice. In
particular, the measured conductivity does not markedly decrease as
<span class="math">\(T\)</span> approaches <span class="math">\(0^{\circ}C\)</span>, but does decrease near the top surface
(regardless of temperature).</p>
<p>An alternative parameterization based on the “bubbly brine” model of
<a class="reference internal" href="zreferences.html#petb07" id="id82">[41]</a> for conductivity is available
(<code class="docutils literal"><span class="pre">conduct</span></code> = ‘bubbly’):</p>
<div class="math" id="equation-Pringle">
<span class="eqno">(107)<a class="headerlink" href="#equation-Pringle" title="Permalink to this equation">¶</a></span>\[K_i={\rho_i\over\rho_0}\left(2.11-0.011T+0.09 S/T\right),\]</div>
<p>where <span class="math">\(\rho_i\)</span> and <span class="math">\(\rho_0=917\)</span>&nbsp;kg/m <span class="math">\(^3\)</span> are
densities of sea ice and pure ice. Whereas the parameterization in
Equation <a class="reference internal" href="#equation-conductivity">(106)</a> asymptotes to a constant conductivity of
2.03&nbsp;W&nbsp;m<span class="math">\(^{-1}\)</span>&nbsp;K <span class="math">\(^{-1}\)</span> with decreasing <span class="math">\(T\)</span>,
<span class="math">\(K_i\)</span> in Equation <a class="reference internal" href="#equation-Pringle">(107)</a> continues to increase with colder
temperatures.</p>
<p>The equation for temperature changes in snow is analogous to
Equation <a class="reference internal" href="#equation-ice-temp-change">(104)</a>, with <span class="math">\(\rho_s = 330\)</span>&nbsp;kg/m <span class="math">\(^3\)</span>,
<span class="math">\(c_s = c_0\)</span>, and <span class="math">\(K_s = 0.30\)</span>&nbsp;W/m/deg replacing the
corresponding ice values. If shortwave = ‘default’, then the penetrating
solar radiation is equal to zero for snow-covered ice, since most of the
incoming sunlight is absorbed near the top surface. If shortwave =
‘dEdd’, however, then <span class="math">\(I_{pen}\)</span> is nonzero in snow layers.</p>
<p>It is possible that more shortwave penetrates into an ice layer than is
needed to completely melt the layer, or else it causes the computed
temperature to be greater than the melting temperature, which until now
has caused the vertical thermodynamics code to abort. A parameter
<code class="docutils literal"><span class="pre">frac</span></code> = 0.9 sets the fraction of the ice layer than can be melted through.
A minimum temperature difference for absorption of radiation is also
set, currently <code class="docutils literal"><span class="pre">dTemp</span></code> = 0.02 (K). The limiting occurs in
<strong>icepack_therm_vertical.F90</strong>, for both the default and delta Eddington
radiation schemes. If the available energy would melt through a layer,
then penetrating shortwave is first reduced, possibly to zero, and if
that is insufficient then the local conductivity is also reduced to
bring the layer temperature just to the melting point.</p>
<p>We now convert Equation <a class="reference internal" href="#equation-ice-temp-change">(104)</a> to finite-difference form. The
resulting equations are second-order accurate in space, except possibly
at material boundaries, and first-order accurate in time. Before writing
the equations in full we give finite-difference expressions for some of
the terms.</p>
<p>First consider the terms on the left-hand side of
Equation <a class="reference internal" href="#equation-ice-temp-change">(104)</a>. We write the time derivatives as</p>
<div class="math">
\[\frac{\partial T}{\partial t} =
   \frac{T^{m+1} - T^m}{\Delta t},\]</div>
<p>where <span class="math">\(T\)</span> is the temperature of either ice or snow and <span class="math">\(m\)</span>
is a time index. The specific heat of ice layer <span class="math">\(k\)</span> is
approximated as</p>
<div class="math" id="equation-heat-capacity-fd">
<span class="eqno">(108)<a class="headerlink" href="#equation-heat-capacity-fd" title="Permalink to this equation">¶</a></span>\[c_{ik} = c_0 + \frac{L_0 \mu S_{ik}} {T_{ik}^m \, T_{ik}^{m+1}},\]</div>
<p>which ensures that energy is conserved during a change in temperature.
This can be shown by using Equation <a class="reference internal" href="#equation-heat-capacity">(105)</a> to integrate
<span class="math">\(c_i \, dT\)</span> from <span class="math">\(T_{ik}^m\)</span> to <span class="math">\(T_{ik}^{m+1}\)</span>; the
result is <span class="math">\(c_{ik}(T_{ik}^{m+1} - T_{ik}^m)\)</span>, where <span class="math">\(c_{ik}\)</span>
is given by Equation <a class="reference internal" href="#equation-heat-capacity-fd">(108)</a>. The specific heat is a nonlinear
function of <span class="math">\(T_{ik}^{m+1}\)</span>, the unknown new temperature. We can
retain a set of linear equations, however, by initially guessing
<span class="math">\(T_{ik}^{m+1} = T_{ik}^m\)</span> and then iterating the solution,
updating <span class="math">\(T_{ik}^{m+1}\)</span> in Equation <a class="reference internal" href="#equation-heat-capacity-fd">(108)</a> with each
iteration until the solution converges.</p>
<p>Next consider the first term on the right-hand side of
Equation <a class="reference internal" href="#equation-ice-temp-change">(104)</a>. The first term describes heat diffusion and is
discretized for a given ice or snow layer <span class="math">\(k\)</span> as</p>
<div class="math" id="equation-ice-dT-dz">
<span class="eqno">(109)<a class="headerlink" href="#equation-ice-dT-dz" title="Permalink to this equation">¶</a></span>\[\frac{\partial}{\partial z} \left(K \frac{\partial T}{\partial z}\right) =
 \frac{1}{\Delta h}
  \left[ {K_k^*(T_{k-1}^{m+1} - T_{k}^{m+1})} - K_{k+1}^*(T_{k}^{m+1} - T_{k+1}^{m+1}) \right],\]</div>
<p>where <span class="math">\(\Delta h\)</span> is the layer thickness and <span class="math">\(K_{k}\)</span> is the
effective conductivity at the upper boundary of layer <span class="math">\(k\)</span>. This
discretization is centered and second-order accurate in space, except at
the boundaries. The flux terms on the right-hand side (RHS) are treated
implicitly; i.e., they depend on the temperatures at the new time
<span class="math">\(m+1\)</span>. The resulting scheme is first-order accurate in time and
unconditionally stable. The effective conductivity <span class="math">\(K^*\)</span> at the
interface of layers <span class="math">\(k-1\)</span> and <span class="math">\(k\)</span> is defined as</p>
<div class="math">
\[K_k^* = {2K_{k-1}K_k\over{K_{k-1}h_k + K_k h_{k-1}}},\]</div>
<p>which reduces to the appropriate values in the limits
<span class="math">\(K_k \gg K_{k-1}\)</span> (or vice versa) and <span class="math">\(h_k \gg h_{k-1}\)</span> (or
vice versa). The effective conductivity at the top (bottom) interface of
the ice-snow column is given by <span class="math">\(K^*=2K/\Delta h\)</span>, where <span class="math">\(K\)</span>
and <span class="math">\(\Delta h\)</span> are the thermal conductivity and thickness of the
top (bottom) layer. The second term on the RHS of
Equation <a class="reference internal" href="#equation-ice-temp-change">(104)</a> is discretized as</p>
<div class="math">
\[{\partial\over\partial z}\left[I_{pen}(z)\right] = I_0{{\tau_{k-1}-\tau_k}\over \Delta h} = {I_k\over\Delta h}\]</div>
<p>where <span class="math">\(\tau_k\)</span> is the fraction of the penetrating solar radiation
<span class="math">\(I_0\)</span> that is transmitted through layer <span class="math">\(k\)</span> without being
absorbed.</p>
<p>We now construct a system of equations for the new temperatures. For
<span class="math">\(T_{sf}&lt;0^{\circ}C\)</span> we require</p>
<div class="math" id="equation-top-surface">
<span class="eqno">(110)<a class="headerlink" href="#equation-top-surface" title="Permalink to this equation">¶</a></span>\[F_0 = F_{ct},\]</div>
<p>where <span class="math">\(F_{ct}\)</span> is the conductive flux from the top surface to the
ice interior, and both fluxes are evaluated at time <span class="math">\(m+1\)</span>.
Although <span class="math">\(F_0\)</span> is a nonlinear function of <span class="math">\(T_{sf}\)</span>,
we can make the linear approximation</p>
<div class="math">
\[F_0^{m+1} = F_0^* + \left( \frac{dF_0}{dT_{sf}} \right)^* \,
                           (T_{sf}^{m+1} - T_{sf}^*),\]</div>
<p>where <span class="math">\(T_{sf}^*\)</span> is the surface temperature from the
most recent iteration, and <span class="math">\(F_0^*\)</span> and
<span class="math">\((dF_0/dT_{sf})^*\)</span> are functions of
<span class="math">\(T_{sf}^*\)</span>. We initialize
<span class="math">\(T_{sf}^* = T_{sf}^m\)</span> and update it with each
iteration. Thus we can rewrite&nbsp;Equation <a class="reference internal" href="#equation-top-surface">(110)</a> as</p>
<div class="math">
\[F_0^* + \left(\frac{dF_0}{dT_{sf}}\right)^* \, (T_
{sf}^{m+1} - T_{sf}^*) =    K_1^* (T_{sf}^{m+1} - T_1^{m+1}),\]</div>
<p>Rearranging terms, we obtain</p>
<div class="math" id="equation-surface-case1">
<span class="eqno">(111)<a class="headerlink" href="#equation-surface-case1" title="Permalink to this equation">¶</a></span>\[\left[ \left(\frac{dF_0}{dT_{sf}}\right)^* - K_1^* \right]
T_{sf}^{m+1} +  K_1^* T_1^{m+1} =
\left(\frac{dF_0}{dT_{sf}}\right)^* \, T_{sf}^* - F_0^*,\]</div>
<p>the first equation in the set of equations&nbsp;<a class="reference internal" href="#equation-tridiag">(103)</a>. The
temperature change in ice/snow layer <span class="math">\(k\)</span> is</p>
<div class="math" id="equation-case1-prelim">
<span class="eqno">(112)<a class="headerlink" href="#equation-case1-prelim" title="Permalink to this equation">¶</a></span>\[\rho_k c_k \frac{(T_k^{m+1} - T_k^m)}{\Delta t} =
   \frac{1}{\Delta h_k} [K_k^*    (T_{k-1}^{m+1} - T_k^{m+1})
                - K_{k+1}(T_k^{m+1} - T_{k+1}^{m+1})],\]</div>
<p>where <span class="math">\(T_0 = T_{sf}\)</span> in the equation for layer 1. In
tridiagonal matrix form, Equation <a class="reference internal" href="#equation-case1-prelim">(112)</a> becomes</p>
<div class="math" id="equation-tridiag-form">
<span class="eqno">(113)<a class="headerlink" href="#equation-tridiag-form" title="Permalink to this equation">¶</a></span>\[-\eta_k K_k T_{k-1}^{m+1} + \left[ 1 + \eta_k(K_k+K_{k+1}) \right]T_k^{m+1} -\eta_k K_{k+1} T_{k+1}^{m+1} = T_k^m + \eta_k I_k,\]</div>
<p>where <span class="math">\(\eta_k = \Delta t/(\rho_k c_k \Delta h_k)\)</span>. In the
equation for the bottom ice layer, the temperature at the ice–ocean
interface is held fixed at <span class="math">\(T_f\)</span>, the freezing temperature of the
mixed layer; thus the last term on the LHS is known and is moved to the
RHS. If <span class="math">\(T_{sf} = 0^{\circ}C\)</span> , then there is no surface flux
equation. In this case the first equation in Equation <a class="reference internal" href="#equation-tridiag">(103)</a> is similar
to Equation <a class="reference internal" href="#equation-tridiag-form">(113)</a>, but with the first term on the LHS moved to the
RHS.</p>
<p>These equations are modified if <span class="math">\(T_{sf}\)</span> and
<span class="math">\(F_{ct}\)</span> are computed within the atmospheric model and
passed to the host sea ice model (calc_Tsfc = false; see <a class="reference internal" href="#atmo"><span class="std std-ref">Atmosphere</span></a>). In this case there
is no surface flux equation. The top layer temperature is computed by an
equation similar to Equation <a class="reference internal" href="#equation-tridiag-form">(113)</a> but with the first term on the
LHS replaced by <span class="math">\(\eta_1 F_{ct}\)</span> and moved to the RHS. The
main drawback of treating the surface temperature and fluxes explicitly
is that the solution scheme is no longer unconditionally stable.
Instead, the effective conductivity in the top layer must satisfy a
diffusive CFL condition:</p>
<div class="math">
\[K^* \le {\rho ch \over \Delta t}.\]</div>
<p>For thin layers and typical coupling intervals (<span class="math">\(\sim 1\)</span> hr),
<span class="math">\(K^*\)</span> may need to be limited before being passed to the atmosphere
via the coupler. Otherwise, the fluxes that are returned to the host sea ice model may
result in oscillating, highly inaccurate temperatures. The effect of
limiting is to treat the ice as a poor heat conductor. As a result,
winter growth rates are reduced, and the ice is likely to be too thin
(other things being equal). The values of <code class="docutils literal"><span class="pre">hs_min</span></code> and <span class="math">\(\Delta t\)</span>
must therefore be chosen with care. If <code class="docutils literal"><span class="pre">hs_min</span></code> is too small, frequent
limiting is required, but if <code class="docutils literal"><span class="pre">hs_min</span></code> is too large, snow will be ignored
when its thermodynamic effects are significant. Likewise, infrequent
coupling requires more limiting, whereas frequent coupling is
computationally expensive.</p>
<p>This completes the specification of the matrix equations for the four
cases. We compute the new temperatures using a tridiagonal solver. After
each iteration we check to see whether the following conditions hold:</p>
<ol class="arabic simple">
<li><span class="math">\(T_{sf} \leq 0^{\circ}C\)</span>.</li>
<li>The change in <span class="math">\(T_{sf}\)</span> since the previous iteration is
less than a prescribed limit, <span class="math">\(\Delta T_{\max}\)</span>.</li>
<li><span class="math">\(F_0 \geq F_{ct}\)</span>. (If <span class="math">\(F_0 &lt; F_{ct}\)</span>, ice would be
growing at the top surface, which is not allowed.)</li>
<li>The rate at which energy is added to the ice by the external fluxes
equals the rate at which the internal ice energy is changing, to
within a prescribed limit <span class="math">\(\Delta F_{\max}\)</span>.</li>
</ol>
<p>We also check the convergence rate of <span class="math">\(T_{sf}\)</span>. If <span class="math">\(T_{sf}\)</span>
is oscillating and failing to converge, we average temperatures from
successive iterations to improve convergence. When all these conditions
are satisfied—usually within two to four iterations for
<span class="math">\(\Delta T_{\max} \approx 0.01^{\circ}C\)</span> and <span class="math">\(\Delta F_{max}
\approx 0.01 \ \mathrm{W/m^2}\)</span>—the calculation is complete.</p>
<p>To compute growth and melt rates (<a class="reference internal" href="#thermo-growth"><span class="std std-ref">Growth and melting</span></a>,
we derive expressions for the enthalpy <span class="math">\(q\)</span>. The enthalpy of snow
(or fresh ice) is given by</p>
<div class="math">
\[q_s(T) = - \rho_s (-c_0 T + L_0).\]</div>
<p>Sea ice enthalpy is more complex, because of brine pockets whose
salinity varies inversely with temperature. Since the salinity is
prescribed, there is a one-to-one relationship between temperature and
enthalpy. The specific heat of sea ice, given by
Equation <a class="reference internal" href="#equation-heat-capacity">(105)</a>, includes not only the energy needed to warm or
cool ice, but also the energy used to freeze or melt ice adjacent to
brine pockets. Equation&nbsp;<a class="reference internal" href="#equation-heat-capacity">(105)</a> can be integrated to
give the energy <span class="math">\(\delta_e\)</span> required to raise the temperature of
a unit mass of sea ice of salinity <span class="math">\(S\)</span> from <span class="math">\(T\)</span> to
<span class="math">\(T^\prime\)</span>:</p>
<div class="math">
\[\delta_e(T,T^\prime) = c_0 (T^\prime - T)
          + L_0 \mu S \left(\frac{1}{T} - \frac{1}{T^\prime}\right).\]</div>
<p>If we let <span class="math">\(T^\prime = T_{m} \equiv -\mu S\)</span>, the temperature at
which the ice is completely melted, we have</p>
<div class="math">
\[\delta_e(T,T_m) = c_0 (T_{m} - T)
                + L_0 \left(1 - \frac{T_m}{T}\right).\]</div>
<p>Multiplying by <span class="math">\(\rho_i\)</span> to change the units from
<span class="math">\(\mathrm {J/kg}\)</span> to <span class="math">\(\mathrm {J/m^{3}}\)</span> and adding a term
for the energy needed to raise the meltwater temperature to , we
obtain the sea ice enthalpy:</p>
<div class="math" id="equation-ice-enthalpy">
<span class="eqno">(114)<a class="headerlink" href="#equation-ice-enthalpy" title="Permalink to this equation">¶</a></span>\[q_i(T,S) = - \rho_i \left[ c_0(T_m-T)
           + L_0 \left(1-\frac{T_m}{T}\right) - c_w T_m.
                  \right]\]</div>
<p>Note that Equation <a class="reference internal" href="#equation-ice-enthalpy">(114)</a> is a quadratic equation in <span class="math">\(T\)</span>.
Given the layer enthalpies we can compute the temperatures using the
quadratic formula:</p>
<div class="math">
\[T = \frac{-b - \sqrt{b^2 - 4 a c}} {2 a},\]</div>
<p>where</p>
<div class="math">
\[\begin{split}\begin{aligned}
a &amp; = &amp; c_0,  \\
b &amp; = &amp; (c_w - c_0) \, T_m - \frac{q_i}{\rho_i} - L_0, \\
c &amp; = &amp; L_0 T_m.\end{aligned}\end{split}\]</div>
<p>The other root is unphysical.</p>
<p><strong>Mushy thermodynamics</strong> (<code class="docutils literal"><span class="pre">ktherm</span></code> = 2)</p>
<p>The “mushy” thermodynamics option treats the sea ice as a mushy layer
<a class="reference internal" href="zreferences.html#fuww06" id="id83">[13]</a> in which the ice is assumed to be composed
of microscopic brine inclusions surrounded by a matrix of pure water
ice. Both enthalpy and salinity are prognostic variables. The size of
the brine inclusions is assumed to be much smaller than the size of
the ice layers, allowing a continuum approximation: a bulk sea-ice
quantity is taken to be the liquid-fraction-weighted average of that
quantity in the ice and in the brine.</p>
<p><em>Enthalpy and mushy physics.</em></p>
<p>The mush enthalpy, <span class="math">\(q\)</span>, is related
to the temperature, <span class="math">\(T\)</span>, and the brine volume, <span class="math">\(\phi\)</span>, by</p>
<div class="math" id="equation-enth-def">
<span class="eqno">(115)<a class="headerlink" href="#equation-enth-def" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
q =&amp; \phi q_{br} &amp;+\, (1-\phi) q_{i}
=&amp; \phi \rho_{w} c_{w} T &amp;+\, (1-\phi) (\rho_i c_i T - \rho_i L_0)
\end{aligned}\]</div>
<p>where <span class="math">\(q_{br}\)</span> is the brine enthalpy, <span class="math">\(q_i\)</span> is the pure ice
enthalpy, <span class="math">\(\rho_i\)</span> and <span class="math">\(c_i\)</span> are density and heat capacity
of the ice, <span class="math">\(\rho_{w}\)</span> and <span class="math">\(c_{w}\)</span> are density and heat
capacity of the brine and <span class="math">\(L_0\)</span> is the latent heat of melting of
pure ice. We assume that the specific heats of the ice and brine are
fixed at the values of cp_ice and cp_ocn, respectively. The enthalpy
is the energy required to raise the temperature of the sea ice to ,
including both sensible and latent heat changes. Since the sea ice
contains salt, it usually will be fully melted at a temperature below
<span class="math">\(0^{\circ}C\)</span>.
Equations <a class="reference internal" href="#equation-ice-enthalpy">(114)</a> and <a class="reference internal" href="#equation-enth-def">(115)</a> are
equivalent except for the density used in the term representing the
energy required to bring the melt water temperature to (<span class="math">\(\rho_i\)</span>
and <span class="math">\(\rho_w\)</span> in equations&nbsp;<a class="reference internal" href="#equation-ice-enthalpy">(114)</a> and
<a class="reference internal" href="#equation-enth-def">(115)</a>, respectively).</p>
<p>The liquid fraction, <span class="math">\(\phi\)</span>, of sea ice is given by</p>
<div class="math">
\[\phi = \frac{S}{S_{br}}\]</div>
<p>where the brine salinity, <span class="math">\(S_{br}\)</span>, is given by the liquidus
relation using the ice temperature.</p>
<p>Within the parameterizations of brine drainage the brine density is a
function of brine salinity <a class="reference internal" href="zreferences.html#notz05" id="id84">[39]</a>:</p>
<div class="math">
\[\rho(S_{br})=1000.3 + 0.78237 S_{br} + 2.8008\times10^{-4} S_{br}^2.\]</div>
<p>Outside the parameterizations of brine drainage the densities of brine
and ice are fixed at the values of <span class="math">\(\rho_w\)</span> and <span class="math">\(\rho_i\)</span>,
respectively.</p>
<p>The permeability of ice is computed from the liquid fraction as in
<a class="reference internal" href="zreferences.html#gehmpz07" id="id85">[19]</a>:</p>
<div class="math">
\[\Pi(\phi) = 3\times10^{-8} (\phi - \phi_\Pi)^3\]</div>
<p>where <span class="math">\(\phi_\Pi\)</span> is 0.05.</p>
<p>The liquidus relation used in the mushy layer module is based on
observations of <a class="reference internal" href="zreferences.html#assur58" id="id86">[5]</a>. A piecewise linear
relation can be fitted to observations of Z (the ratio of mass of salt
(in g) to mass of pure water (in kg) in brine) to the melting
temperature: <span class="math">\(Z = aT + b\)</span>. Salinity is the mass of salt (in g) per
mass of brine (in kg) so is related to Z by</p>
<div class="math">
\[\frac{1}{S} = \frac{1}{1000} + \frac{1}{Z}.\]</div>
<p>The data is well fitted with two linear regions,</p>
<div class="math">
\[S_{br} = \frac{(T+J_1)}{(T/1000 + L_1)}l_0 + \frac{(T+J_2)}{(T/1000 + L_2)}(1-l_0)\]</div>
<p>where</p>
<div class="math">
\[\begin{split}l_0 = \left\lbrace \begin{array}{lcl}
1 &amp; \mathrm{if} &amp; T \ge T_0 \\
0 &amp; \mathrm{if} &amp; T &lt;  T_0\end{array} \right.,\end{split}\]</div>
<div class="math">
\[J_{1,2} = \frac{b_{1,2}}{a_{1,2}},\]</div>
<div class="math">
\[L_{1,2} =  \frac{(1 + b_{1,2}/1000)}{a_{1,2}}.\]</div>
<p><span class="math">\(T_0\)</span> is the temperature at which the two linear regions meet.
Fitting to the data, <span class="math">\(T_0=-7.636^\circ\)</span>C,
<span class="math">\(a_1=-18.48 \;\mathrm{g} \;\mathrm{kg}^{-1} \;\mathrm{K}^{-1}\)</span>,
<span class="math">\(a_2=-10.3085\;\mathrm{g} \;\mathrm{kg}^{-1} \;\mathrm{K}^{-1}\)</span>,
<span class="math">\(b_1=0\)</span> and <span class="math">\(b_2=62.4 \;\mathrm{g}\;\mathrm{kg}^{-1}\)</span>.</p>
<p><em>Two stage outer iteration.</em></p>
<p>As for the BL99 thermodynamics
<a class="reference internal" href="zreferences.html#bl99" id="id87">[7]</a> there are two qualitatively different
situations that must be considered when solving for the vertical
thermodynamics: the surface can be melting and at the melting
temperature, or the surface can be colder than the melting temperature
and not melting. In the BL99 thermodynamics these two situations were
treated within the same iterative loop, but here they are dealt with
separately. If at the beginning of the time step the ice surface is cold
and not melting, we solve the ice temperatures assuming that this is
also true at the end of the time step. Once we have solved for the new
temperatures we test to see if the answer is consistent with this
assumption. If the surface temperature is below the melting temperature
then we have found the appropriate consistent solution. If the surface
is above the melting temperature at the end of the initial solution
attempt, we recalculate the new temperatures assuming the surface
temperature is fixed at the melting temperature. Alternatively if the
surface is at the melting temperature at the start of a time step, we
assume initially that this is also the case at the end of the time step,
solve for the new temperatures and then check that the surface
conductive heat flux is less than the surface atmospheric heat flux as
is required for a melting surface. If this is not the case, the
temperatures are recalculated assuming the surface is colder than
melting. We have found that solutions of the temperature equations that
only treat one of the two qualitatively different solutions at a time
are more numerically robust than if both are solved together. The
surface state rarely changes qualitatively during the solution so the
method is also numerically efficient.</p>
<p><em>Temperature updates.</em></p>
<p>During the calculation of the new temperatures
and salinities, the liquid fraction is held fixed at the value from the
previous time step. Updating the liquid fraction during the Picard
iteration described below was found to be numerically unstable. Keeping
the liquid fraction fixed drastically improves the numerical stability
of the method without significantly changing the solution.</p>
<p>Temperatures are calculated in a similar way to BL99 with an outer
Picard iteration of an inner tridiagonal matrix solve. The conservation
equation for the internal ice temperatures is</p>
<div class="math">
\[\frac{\partial{q}}{\partial{t}}=\frac{\partial{}}{\partial{z}} \left( K \frac{\partial{T}}{\partial{z}} \right) + w \frac{\partial{q_{br}}}{\partial{z}} + F\]</div>
<p>where <span class="math">\(q\)</span> is the sea ice enthalpy, <span class="math">\(K\)</span> is the bulk thermal
conductivity of the ice, <span class="math">\(w\)</span> is the vertical Darcy velocity of the
brine, <span class="math">\(q_{br}\)</span> is the brine enthalpy and <span class="math">\(F\)</span> is the
internally absorbed shortwave radiation. The first term on the right
represents heat conduction and the second term represents the vertical
advection of heat by gravity drainage and flushing.</p>
<p>The conductivity of the mush is given by</p>
<div class="math">
\[K = \phi K_{br} + (1-\phi) K_{i}\]</div>
<p>where <span class="math">\(K_i = 2.3\)</span>&nbsp;Wm:math:<cite>^{-1}`K:math:`^{-1}</cite> is the
conductivity of pure ice and
<span class="math">\(K_{br}=0.5375\)</span>&nbsp;Wm:math:<cite>^{-1}`K:math:`^{-1}</cite> is the
conductivity of the brine. The thermal conductivity of brine is a
function of temperature and salinity, but here we take it as a constant
value for the middle of the temperature range experienced by sea ice,
<span class="math">\(-10^\circ\)</span>C <a class="reference internal" href="zreferences.html#sp86" id="id88">[45]</a>, assuming the brine
liquidus salinity at <span class="math">\(-10^\circ\)</span>C.</p>
<p>We discretize the terms that include temperature in the heat
conservation equation as</p>
<div class="math" id="equation-mushyheat">
<span class="eqno">(116)<a class="headerlink" href="#equation-mushyheat" title="Permalink to this equation">¶</a></span>\[\frac{q^{t}_k - q^{t_0}_k}{\Delta t} = \frac{\frac{K^*_{k+1}}{\Delta z^\prime_{k+1}} (T^t_{k+1} - T^t_k) - \frac{K^*_k}{\Delta z^\prime_k} (T^t_k - T^t_{k-1})}{\Delta h}\]</div>
<p>where the superscript signifies whether the quantity is evaluated at
the start (<span class="math">\(t_0\)</span>) or the end (<span class="math">\(t\)</span>) of the time step and the
subscript indicates the vertical layer. Writing out the temperature
dependence of the enthalpy term we have</p>
<div class="math">
\[\frac{\left(\phi (c_w \rho_w - c_i \rho_i) + c_i \rho_i\right) T^t_k - (1-\phi) \rho_i L - q^{t_0}_k}{\Delta t} = \frac{ \frac{K^*_{k+1}}{\Delta z^\prime_{k+1}} (T^t_{k+1} - T^t_k) - \frac{K^*_k}{\Delta z^\prime_k} (T^t_k - T^t_{k-1})}{\Delta h}.\]</div>
<p>The mush thermal conductivities are fixed at the start of the timestep.
For the lowest ice layer <span class="math">\(T_{k+1}\)</span> is replaced with
<span class="math">\(T_{bot}\)</span>, the temperature of the ice base. <span class="math">\(\Delta h\)</span> is
the layer thickness and <span class="math">\(z^\prime_k\)</span> is the distance between the
<span class="math">\(k-1\)</span> and <span class="math">\(k\)</span> layer centers.</p>
<p>Similarly, for the snow layer temperatures we have the following
discretized equation:</p>
<div class="math">
\[\frac{c_i \rho_s T^t_k - \rho_s L_0- q^{t_0}_k}{\Delta t} = \frac{ \frac{K^*_{k+1}}{\Delta z^\prime_{k+1}} (T^t_{k+1} - T^t_k) - \frac{K^*_k}{\Delta z^\prime_k} (T^t_k - T^t_{k-1})}{\Delta h}.\]</div>
<p>For the upper-most layer (either ice layer or snow layer if it present)
<span class="math">\(T_{k-1}\)</span> is replaced with <span class="math">\(T_{sf}\)</span>, the temperature of the
surface.</p>
<p>If the surface is colder than the melting temperature then we also have
to solve for the surface temperature, <span class="math">\(T_{sf}\)</span>. Here we follow the
methodology of BL99 described above.</p>
<p>These discretized temperature equations form a tridiagional matrix for
the new temperatures and are solved with a standard tridiagonal solver.
A Picard iteration is used to incorporate nonlinearity in the equations.
The surface heat flux is a function of surface temperature and with each
iteration, the surface heat flux is calculated with the new surface
temperature until convergence is achieved. Convergence normally occurs
after a few iterations once the temperature changes during an iteration
fall below <span class="math">\(5\times10^{-4}\;^\circ\mathrm{C}\)</span> and the energy
conservation error falls below 0.9``ferrmax``.</p>
<p><em>Salinity updates.</em></p>
<p>Several physical processes alter the sea ice bulk
salinity. New ice forms with the salinity of the sea water from which it
formed. Gravity drainage reduces the bulk salinity of newly formed sea
ice, while flushing of melt water through the ice also alters the
salinity profile.</p>
<p>The salinity equation takes the form</p>
<div class="math">
\[\frac{\partial{S}}{\partial{t}} = w \frac{\partial{S_{br}}}{\partial{z}} + G\]</div>
<p>where <span class="math">\(w\)</span> is a vertical Darcy velocity and <span class="math">\(G\)</span> is a source
term. The right-hand side depends indirectly on the bulk salinity
through the liquid fraction (<span class="math">\(S = \phi S_{br}\)</span>). Since
<span class="math">\(\phi\)</span> is fixed for the time step, we solve the salinity equation
explicitly after the temperature equation is solved.</p>
<p>A. Gravity drainage. Sea ice initially retains all the salt present in
the sea water from which it formed. Cold temperatures near the top
surface of forming sea ice result in higher brine salinities there,
because the brine is always at its melting temperature. This colder,
saltier brine is denser than the underlying sea water and the brine
undergoes convective overturning with the ocean. As the dense, cold
brine drains out of the ice, it is replaced by fresher seawater,
lowering the bulk salinity of the ice. Following
<a class="reference internal" href="zreferences.html#thb13" id="id89">[52]</a>, gravity drainage is assumed to occur as two
simultaneously operating modes: a rapid mode operating principally near
the ice base and a slow mode occurring everywhere.</p>
<p><em>Rapid drainage</em> takes the form of a vertically varying upward Darcy
flow. The contribution to the bulk salinity equation for the rapid mode
is</p>
<div class="math">
\[\left. \frac{\partial{S}}{\partial{t}} \right|_{rapid} = w(z) \frac{\partial{S_{br}}}{\partial{z}}\]</div>
<p>where <span class="math">\(S\)</span> is the bulk salinity and <span class="math">\(B_{br}\)</span> is the brine
salinity, specified by the liquidus relation with ice temperature. This
equation is discretized using an upwind advection scheme,</p>
<div class="math">
\[\frac{S_k^t - S_k^{t_0}}{\Delta t} = w_k \frac{S_{br k+1} - S_{br k}}{\Delta z}.\]</div>
<p>The upward advective flow also carries heat, contributing a term to the
heat conservation Equation <a class="reference internal" href="#equation-mushyheat">(116)</a>,</p>
<div class="math">
\[\left. \frac{\partial{q}}{\partial{t}}  \right|_{rapid} = w(z) \frac{\partial{q_{br}}}{\partial{z}}\]</div>
<p>where <span class="math">\(q_{br}\)</span> is the brine enthalpy. This term is discretized as</p>
<div class="math">
\[\left.\frac{q_k^t - q_k^{t_0}}{\Delta t}  \right|_{rapid} = w_k \frac{q_{br\,k+1} - q_{br\,k}}{\Delta z}.\]</div>
<div class="math">
\[w_k = \max_{j=k,n}\left(\tilde{w}_j \right)\]</div>
<p>where the maximum is taken over all the ice layers between layer
<span class="math">\(k\)</span> and the ice base. <span class="math">\(\tilde{w}_j\)</span> is given by</p>
<div class="math" id="equation-mushyvel">
<span class="eqno">(117)<a class="headerlink" href="#equation-mushyvel" title="Permalink to this equation">¶</a></span>\[\tilde{w}(z) = w \left( \frac{Ra(z) - Ra_c}{Ra(z)} \right).\]</div>
<p>where <span class="math">\(Ra_c\)</span> is a critical Rayleigh number and <span class="math">\(Ra(z)\)</span> is
the local Rayleigh number at a particular level,</p>
<div class="math">
\[Ra(z) = \frac{g \Delta \rho \Pi (h-z)}{\kappa \eta}\]</div>
<p>where <span class="math">\(\Delta \rho\)</span> is the difference in density between the
brine at <span class="math">\(z\)</span> and the ocean, <span class="math">\(\Pi\)</span> is the minimum
permeability between <span class="math">\(z\)</span> and the ocean, <span class="math">\(h\)</span> is the ice
thickness, <span class="math">\(\kappa\)</span> is the brine thermal diffusivity and
<span class="math">\(\eta\)</span> is the brine dynamic viscosity. Equation ([eq:mushyvel])
reduces the flow rate for Rayleigh numbers below the critical Rayleigh
number.</p>
<p>The unmodified flow rate, <span class="math">\(w\)</span>, is determined from a hydraulic
pressure balance argument for upward flow through the mush and returning
downward flow through ice free channels:</p>
<div class="math">
\[w(z) \Delta x^2=A_m \left(-\frac{\Delta P}{l} + B_m\right)\]</div>
<p>where</p>
<div class="math">
\[\begin{split}\begin{aligned}
\frac{\Delta P}{l} &amp;=&amp; \frac{A_p B_p + A_mB_m}{A_m+A_p},\\
A_m&amp;=&amp; \frac{\Delta x^2}{\eta} \frac{n}{\sum^n_{k=1}\frac{1}{\Pi(k)}},\\
B_m&amp;=&amp; -\frac{g}{n}\sum_{k=1}^n \rho(k),\\
A_p&amp;=&amp; \frac{\pi a^4}{8 \eta},\\
B_p&amp;=&amp; -\rho_p g.\end{aligned}\end{split}\]</div>
<p>There are three tunable parameters in the above parameterization,
<span class="math">\(a\)</span>, the diameter of the channel, <span class="math">\(\Delta x\)</span>, the horizontal
size of the mush draining through each channel, and <span class="math">\(Ra_c\)</span>, the
critical Rayleigh number. <span class="math">\(\rho_p\)</span> is the density of brine in the
channel which we take to be the density of brine in the mush at the
level that the brine is draining from. <span class="math">\(l\)</span> is the thickness of
mush from the ice base to the top of the layer in question. We assume
that <span class="math">\(\Delta x\)</span> is proportional to <span class="math">\(l\)</span> so that
<span class="math">\(\Delta x = 2 \beta l\)</span>. <span class="math">\(a\)</span> (<code class="docutils literal"><span class="pre">a_rapid_mode</span></code>), <span class="math">\(\beta\)</span>
(<code class="docutils literal"><span class="pre">aspect_rapid_mode</span></code>) and <span class="math">\(Ra_c\)</span> (<code class="docutils literal"><span class="pre">Ra_c_rapid_mode</span></code>) are all
namelist parameters with default values of <span class="math">\(0.5\;\mathrm{mm}\)</span>, 1
and 10, respectively. The value <span class="math">\(\beta=1\)</span> gives a square aspect
ratio for the convective flow in the mush.</p>
<p>The <em>slow drainage</em> mode takes the form of a simple relaxation of bulk
salinity:</p>
<div class="math">
\[\left.\frac{\partial{S(z)}}{\partial{t}}\right|_{slow} = -\lambda (S(z) - S_c).\]</div>
<p>The decay constant, <span class="math">\(\lambda\)</span>, is modeled as</p>
<div class="math">
\[\lambda =S^\ast \max \left( \frac{T_{bot} - T_{sf}}{h},0\right)\]</div>
<p>where <span class="math">\(S^\ast\)</span> is a tuning parameter for the drainage strength,
<span class="math">\(T_{bot}\)</span> is the basal ice temperature, <span class="math">\(T_{sf}\)</span> is the
upper surface temperature and <span class="math">\(h\)</span> is the ice thickness. The bulk
salinity relaxes to a value, <span class="math">\(S_c(z)\)</span>, given by</p>
<div class="math">
\[S_c(z) = \phi_c S_{br}(z)\]</div>
<p>where <span class="math">\(S_{br}(z)\)</span> is the brine salinity at depth <span class="math">\(z\)</span> and
<span class="math">\(\phi_c\)</span> is a critical liquid fraction. Both <span class="math">\(S^\ast\)</span> and
<span class="math">\(\phi_c\)</span> are namelist parameters,
<code class="docutils literal"><span class="pre">dSdt_slow_mode</span></code> <span class="math">\(=1.5\times10^{-7}\;\mathrm{m}\;\mathrm{s}^{-1}\;\mathrm{K}^{-1}\)</span>
and <code class="docutils literal"><span class="pre">phi_c_slow_mode</span></code> <span class="math">\(=0.05\)</span>.</p>
<p>B. Downwards flushing. Melt pond water drains through sea ice and
flushes out brine, reducing the bulk salinity of the sea ice. This is
modeled with the mushy physics option as a vertical Darcy flow through
the ice that affects both the enthalpy and bulk salinity of the sea ice:</p>
<div class="math">
\[\left.\frac{\partial{q}}{\partial{t}}\right|_{flush} = w_f \frac{\partial{q_{br}}}{\partial{z}}\]</div>
<div class="math">
\[\left.\frac{\partial{S}}{\partial{t}} \right|_{flush}= w_f \frac{\partial{S_{br}}}{\partial{z}}\]</div>
<p>These equations are discretized with an upwind advection scheme. The
flushing Darcy flow, <span class="math">\(w_f\)</span>, is given by</p>
<div class="math">
\[w_f=\frac{\overline{\Pi} \rho_w g \Delta h}{h \eta},\]</div>
<p>where <span class="math">\(\overline{\Pi}\)</span> is the harmonic mean of the ice layer
permeabilities and <span class="math">\(\Delta h\)</span> is the hydraulic head driving melt
water through the sea ice. It is the difference in height between the
top of the melt pond and sea level.</p>
<p><em>Basal boundary condition.</em></p>
<p>In traditional Stefan problems the ice
growth rate is calculated by determining the difference in heat flux on
either side of the ice/ocean interface and equating this energy
difference to the latent heat of new ice formed. Thus,</p>
<div class="math" id="equation-growth-stefan">
<span class="eqno">(118)<a class="headerlink" href="#equation-growth-stefan" title="Permalink to this equation">¶</a></span>\[(1-\phi_i) L_0 \rho_i \frac{\partial{h}}{\partial{t}} = K \left. \frac{\partial{T}}{\partial{z}} \right|_i - K_w \left. \frac{\partial{T}}{\partial{z}} \right|_w\]</div>
<p>where <span class="math">\((1-\phi_i)\)</span> is the solid fraction of new ice formed and
the right hand is the difference in heat flux at the ice–ocean interface
between the ice side and the ocean side of the interface. However, with
mushy layers there is usually no discontinuity in solid fraction across
the interface, so <span class="math">\(\phi_i=1\)</span> and Equation <a class="reference internal" href="#equation-growth-stefan">(118)</a>
cannot be used explicitly. To circumvent this problem we set the
interface solid fraction to be 0.15, a value that reproduces
observations. <span class="math">\(\phi_i\)</span> is a namelist parameter (<code class="docutils literal"><span class="pre">phi_i_mushy</span></code> =
0.85). The basal ice temperature is set to the liquidus temperature
<span class="math">\(T_f\)</span> of the ocean surface salinity.</p>
<p><em>Tracer consistency.</em></p>
<p>In order to ensure conservation of energy and salt
content, the advection routines will occasionally limit changes to
either enthalpy or bulk salinity. The mushy thermodynamics routine
determines temperature from both enthalpy and bulk salinity. Since the
limiting changes performed in the advection routine are not applied
consistently (from a mushy physics point of view) to both enthalpy and
bulk salinity, the resulting temperature may be changed to be greater
than the limit allowed in the thermodynamics routines. If this situation
is detected, the code corrects the enthalpy so the temperature is below
the limiting value. Conservation of energy is ensured by placing the
excess energy in the ocean, and the code writes a warning that this has
occurred to the diagnostics file. This situation only occurs with the
mushy thermodynamics, and it should only occur very infrequently and
have a minimal effect on results. The addition of the heat to the ocean
may reduce ice formation by a small amount afterwards.</p>
</div>
<div class="section" id="growth-and-melting">
<span id="thermo-growth"></span><h4>2.2.4.4. Growth and melting<a class="headerlink" href="#growth-and-melting" title="Permalink to this headline">¶</a></h4>
<p>Melting at the top surface is given by</p>
<div class="math" id="equation-top-melting">
<span class="eqno">(119)<a class="headerlink" href="#equation-top-melting" title="Permalink to this equation">¶</a></span>\[\begin{split}q \, \delta h = \left\{\begin{array}{ll}
(F_0-F_{ct}) \, \Delta t &amp; \mbox{if $F_0&gt;F_{ct}$} \\
0                   &amp; \mbox{otherwise}
         \end{array}
         \right.\end{split}\]</div>
<p>where <span class="math">\(q\)</span> is the enthalpy of the surface ice or snow layer <a class="footnote-reference" href="#id93" id="id90">[1]</a>
(recall that <span class="math">\(q &lt; 0\)</span>) and <span class="math">\(\delta h\)</span> is the change in
thickness. If the layer melts completely, the remaining flux is used to
melt the layers beneath. Any energy left over when the ice and snow are
gone is added to the ocean mixed layer. Ice cannot grow at the top
surface due to conductive fluxes; however, snow–ice can form. New
snowfall is added at the end of the thermodynamic time step.</p>
<p>Growth and melting at the bottom ice surface are governed by</p>
<div class="math" id="equation-bottom-melting">
<span class="eqno">(120)<a class="headerlink" href="#equation-bottom-melting" title="Permalink to this equation">¶</a></span>\[q \, \delta h = (F_{cb} - F_{bot}) \,
\Delta t,\]</div>
<p>where <span class="math">\(F_{bot}\)</span> is given by Equation <a class="reference internal" href="#equation-fbot">(101)</a> and <span class="math">\(F_{cb}\)</span> is the
conductive heat flux at the bottom surface:</p>
<div class="math">
\[F_{cb} =   \frac{K_{i,N+1}}{\Delta h_i}  (T_{iN} - T_f).\]</div>
<p>If ice is melting at the bottom surface, <span class="math">\(q\)</span>
in&nbsp;Equation <a class="reference internal" href="#equation-bottom-melting">(120)</a> is the enthalpy of the bottom ice layer. If
ice is growing, <span class="math">\(q\)</span> is the enthalpy of new ice with temperature
<span class="math">\(T_f\)</span> and salinity <span class="math">\(S_{max}\)</span> (<code class="docutils literal"><span class="pre">ktherm</span></code> = 1) or ocean surface
salinity (<code class="docutils literal"><span class="pre">ktherm</span></code> = 2). This ice is added to the bottom layer.</p>
<p>In general, frazil ice formed in the ocean is added to the thinnest ice
category. The new ice is grown in the open water area of the grid cell
to a specified minimum thickness; if the open water area is nearly zero
or if there is more new ice than will fit into the thinnest ice
category, then the new ice is spread over the entire cell.</p>
<p>If the latent heat flux is negative (i.e., latent heat is transferred
from the ice to the atmosphere), snow or snow-free ice sublimates at the
top surface. If the latent heat flux is positive, vapor from the
atmosphere is deposited at the surface as snow or ice. The thickness
change of the surface layer is given by</p>
<div class="math" id="equation-latent-heat">
<span class="eqno">(121)<a class="headerlink" href="#equation-latent-heat" title="Permalink to this equation">¶</a></span>\[(\rho L_v - q) \delta h = F_l \Delta t,\]</div>
<p>where <span class="math">\(\rho\)</span> is the density of the surface material (snow or
ice), and <span class="math">\(L_v = 2.501 \times 10^6 \ \mathrm{J/kg}\)</span> is the latent
heat of vaporization of liquid water at . Note that <span class="math">\(\rho L_v\)</span> is
nearly an order of magnitude larger than typical values of <span class="math">\(q\)</span>.
For positive latent heat fluxes, the deposited snow or ice is assumed to
have the same enthalpy as the existing surface layer.</p>
<p>After growth and melting, the various ice layers no longer have equal
thicknesses. We therefore adjust the layer interfaces, conserving
energy, so as to restore layers of equal thickness
<span class="math">\(\Delta h_i = h_i / N_i\)</span>. This is done by computing the overlap
<span class="math">\(\eta_{km}\)</span> of each new layer <span class="math">\(k\)</span> with each old layer
<span class="math">\(m\)</span>:</p>
<div class="math">
\[\eta_{km} = \min(z_m,z_k) - \max(z_{m-1},z_{k-1}),\]</div>
<p>where <span class="math">\(z_m\)</span> and <span class="math">\(z_k\)</span> are the vertical coordinates of the
old and new layers, respectively. The enthalpies of the new layers are</p>
<div class="math">
\[q_k = \frac{1}{\Delta h_i} \sum_{m=1}^{N_i} \eta_{km} q_m.\]</div>
<p>Lateral melting is accomplished by multiplying the state variables by
<span class="math">\(1-r_{side}\)</span>, where <span class="math">\(r_{side}\)</span> is the fraction of ice melted
laterally <a class="reference internal" href="zreferences.html#mp87" id="id91">[37]</a><a class="reference internal" href="zreferences.html#steele92" id="id92">[46]</a>, and adjusting the ice
energy and fluxes as appropriate. We assume a floe diameter of 300&nbsp;m.</p>
<p><em>Snow ice formation.</em></p>
<p>At the end of the time step we check whether the
snow is deep enough to lie partially below the surface of the ocean
(freeboard). From Archimedes’ principle, the base of the snow is at sea
level when</p>
<div class="math">
\[\rho_i h_i + \rho_s h_s = \rho_w h_i.\]</div>
<p>Thus the snow base lies below sea level when</p>
<div class="math">
\[h^* \equiv h_s - \frac {(\rho_w-\rho_i) h_i}{\rho_s} &gt; 0.\]</div>
<p>In this case, for <code class="docutils literal"><span class="pre">ktherm</span></code> = 1 (BL99) we raise the snow base to sea level
by converting some snow to ice:</p>
<div class="math">
\[\begin{split}\begin{aligned}
\delta h_s &amp; = &amp; \frac{-\rho_i h^*}{\rho_w},  \\
\delta h_i &amp; = &amp; \frac{\rho_s h^*}{\rho_w}.\end{aligned}\end{split}\]</div>
<p>In rare cases this process can increase the ice thickness
substantially. For this reason snow–ice conversions are postponed until
after the remapping in thickness space
(<a class="reference internal" href="#itd-trans"><span class="std std-ref">Transport in thickness space</span></a>), which assumes that ice growth during
a single time step is fairly small.</p>
<p>For <code class="docutils literal"><span class="pre">ktherm</span></code> = 2 (mushy), we model the snow–ice formation process as
follows: If the ice surface is below sea level then we replace some snow
with the same thickness of sea ice. The thickness change chosen is that
which brings the ice surface to sea level. The new ice has a porosity of
the snow, which is calculated as</p>
<div class="math">
\[\phi = 1 - \frac{\rho_s}{\rho_i}\]</div>
<p>where <span class="math">\(\rho_s\)</span> is the density of snow and <span class="math">\(\rho_i\)</span> is the
density of fresh ice. The salinity of the brine occupying the above
porosity within the new ice is taken as the sea surface salinity. Once
the new ice is formed, the vertical ice and snow layers are regridded
into equal thicknesses while conserving energy and salt.</p>
<table class="docutils footnote" frame="void" id="id93" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id90">[1]</a></td><td>The mushy thermodynamics option does not include the enthalpy
associated with raising the meltwater temperature to in these
calculations, unlike BL99, which does include it. This extra heat is
returned to the ocean (or the atmosphere, in the case of evaporation)
with the melt water.</td></tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="biogeochemistry-ech">
<span id="ice-bgc"></span><h3>2.2.5. Biogeochemistry - ECH<a class="headerlink" href="#biogeochemistry-ech" title="Permalink to this headline">¶</a></h3>
<p>CHECK: refer to section <a class="reference internal" href="#ice-bgc-tracers"><span class="std std-ref">Biogeochemistry</span></a> for description
of how tracers are carried (on brine volume, etc), units, tracer flags</p>
<p>Provide broad overview of kinds of BGC configurations available, in intro paragraph.
Bottom layer, vertical BGC, aerosols, connection (or not) with brine height tracer.</p>
<div class="section" id="bottom-layer">
<h4>2.2.5.1. Bottom layer<a class="headerlink" href="#bottom-layer" title="Permalink to this headline">¶</a></h4>
<p>Ice algal photosynthesis leads to carbon fixation and pigment buildup
throughout much of the pack ice in springtime, including warm layers in
contact with seawater and the central ice matrix. Turbulence moves seed
organisms and trace elements upward across the ocean interface from the
mixed layer <a class="reference internal" href="zreferences.html#aks93" id="id94">[3]</a>, and convection allows them to
penetrate deep into the brine channel network. Gravity drainage is
strongly coupled to carbonate and alkalinity relationships; bio-active
gases including molecular oxygen, dimethyl sulfide (DMS) and methane
exhibit dynamic cycling within and around the ice matrix. All may
ultimately be transferred across the upper interface, into snow cover
and toward the atmosphere. Chlorophyll is often concentrated in thin
layers, capable of absorbing downwelling radiation and redistributing
the implied heat locally.</p>
<p>Although biogeochemical activity occurs throughout the sea ice column,
in the skeletal layer configuration we restrict ourselves to simulations of activity
taking place in the lowest few vertical centimeters. A thin intermediate
zone located in this vicinity can be considered distinct because it is
relatively warm, extremely porous and necessarily in close contact with
the seawater nutrient supply. The ecosystems supported are therefore
especially intense, so that they constitute a logical starting point for
code development. The resulting band of biological activity will be
referred to most often in what follows as the ‘bottom zone.’ It
constitutes the dominant habitat for ice algae across most of the
noncoastal Arctic and among land fast ice systems of the Southern
Hemisphere. In the literature and some portions of the code, however,
the alternate term ‘skeletal layer’ is used. For many purposes, the two
are interchangeable. But in fact, the latter is a reference to dendritic
structures more typically observable in the wintertime; ‘bottom zone’ is
the more general term.</p>
<p>Ecological succession in the bottom zone interacts intimately with
chemistry of the upper ocean–atmosphere system. Photosynthesis is
constrained initially by light limitation but soon becomes a matter of
resource availability <a class="reference internal" href="zreferences.html#aks93" id="id95">[3]</a><a class="reference internal" href="zreferences.html#djehmj11" id="id96">[9]</a>. Radiation
intensity dictates the timing of bloom inception. The direct inflow of
salt laden water can then be filtered immediately for the dissolved
nutrient forms, which are converted locally into biomass. In association
with the carbon storage, considerable DMS and molecular oxygen are
generated <a class="reference internal" href="zreferences.html#edhhjjls12" id="id97">[12]</a>. Melt and flush periods cause
bottom ice organisms to be rejected from the matrix mechanically. The
dominant primary producers among them are pennate diatoms, a class
subject to rapid sinking <a class="reference internal" href="zreferences.html#ldm05" id="id98">[29]</a>. Hence the amount of
bottom layer biological activity dictates high latitude nutrient and
trace gas levels in the early spring, then carbon drawdown moving into
the period of breakup.</p>
<p>Light transmission passes into the bottom zone through overlying layers
of snow and ice. Attenuation by the ice algae is integrated and averaged
over the bottom three centimeters in which they reside. Our current
release treats inflow of the primary Arctic nutrients nitrate and
silicate, along with the major pathway for nitrogen recycling via
ammonia. Both fertilizers and byproducts are permitted to exchange back
out of the porous bottom volume on a time scale of order hours
<a class="reference internal" href="zreferences.html#aks93" id="id99">[3]</a><a class="reference internal" href="zreferences.html#ldm05" id="id100">[29]</a>. Biomass multiplies exponentially as
light and nutrient restrictions are lifted, following the rising polar
sun. Uptake accelerates until there is a transition to flux limitation
<a class="reference internal" href="zreferences.html#edhhjjls12" id="id101">[12]</a>. At variable times and locations, a
kinetic balance is often reached in which dissolved nitrogen is
sequestered faster than it can leave the porous volume. Computational
terms involved in the ecodynamic simulation resemble Michaelis-Menten
enzyme kinetics, and have been adapted here from a series of pioneering
ice biogeochemistry models
<a class="reference internal" href="zreferences.html#aks93" id="id102">[3]</a><a class="reference internal" href="zreferences.html#jdwstwlg06" id="id103">[26]</a><a class="reference internal" href="zreferences.html#ldm05" id="id104">[29]</a>.</p>
<p>The bottom ice biogeochemistry module described here is designed for
ready attachment of extra-nutrient cycling, including byproduct and
detrital processing. Our own mechanism for the generation of DMS is
included in the release as an example. For full details please see
descriptions and schematics in <a class="reference internal" href="zreferences.html#edhhjjls12" id="id105">[12]</a>.
Generally speaking, the primary nutrient flow as nitrogen simultaneously
supports formation of silicate frustules by the ice diatoms, along with
carbon biomass production and the implied chlorophyll buildup. Synthesis
of organosulfur metabolites is handled simultaneously and in direct
proportion. DMS spins off of this subsystem at much higher levels than
those familiar from open water studies, since the ice algae are
especially abundant and suffer strong cryological, osmotic and oxidant
stress in an extreme environmental regime <a class="reference internal" href="zreferences.html#sstmb07" id="id106">[47]</a>.
The sulfur transformations are governed by a typical pattern of routing
kinetics within and below the ice <a class="reference internal" href="zreferences.html#edhhjjls12" id="id107">[12]</a>, which
reduces the net yield of volatile gas but still permits considerable
buildup and release during the spring thaw.</p>
<p>Biogeochemical processing is modelled as a single layer of reactive
tracers attached to the sea ice bottom. Optional settings are available
via the <em>zbgc_nml</em> namelist in <strong>icepack_in</strong>. The prefix <code class="docutils literal"><span class="pre">tr_bgc</span></code>
signifies a biogeochemical tracer, while the postscript <code class="docutils literal"><span class="pre">_sk</span></code> indicates
that a particular quantity is restricted to the band of bottom or
skeletal ice material.</p>
<p>Setting the flag <code class="docutils literal"><span class="pre">skl_bgc</span></code> to true turns on a reduced ‘NP’
(Nitrogen-Plankton) biogeochemistry consisting of nitrate and one algal
tracer. Ammonium (<code class="docutils literal"><span class="pre">tr_bgc_Am_sk</span></code>), silicate (<code class="docutils literal"><span class="pre">tr_bgc_Sil_sk</span></code>),
dimethyl sulfoniopropionate (DMSP) in particulate form
(<code class="docutils literal"><span class="pre">tr_bgc_DMSPp_sk</span></code>), DMSP in dissolved form (<code class="docutils literal"><span class="pre">tr_bgc_DMSPd_sk</span></code>), and
volatile dimethyl sulfide (<code class="docutils literal"><span class="pre">tr_bgc_DMS_sk</span></code>) may also be included by
setting the respective flags to true in <strong>icepack_in</strong>.</p>
<p>All bottom layer tracers (<span class="math">\(T_b\)</span>) are brine concentrations
multiplied by the skeletal layer thickness (<span class="math">\(h_{sk}\)</span>). Bulk tracer
concentrations are written to diagnostic files and are found by the
expression <span class="math">\(T_b \phi_{sk}/h_{sk}\)</span> where <span class="math">\(\phi_{sk}\)</span> is the
skeletal layer porosity. Both <span class="math">\(h_{sk}\)</span> and <span class="math">\(\phi_{sk}\)</span> are
defined in <strong>icepack_zbgc_shared.F90</strong>.</p>
<p>The initial concentrations of
tracers are specified in subroutine <strong>init_bgc</strong> in <strong>icepack_zbgc.F90</strong>.
Silicate and nitrate may be initialized and forced with climatology.
Parameters <code class="docutils literal"><span class="pre">sil_data_type</span></code> and <code class="docutils literal"><span class="pre">nit_data_type</span></code> are set in <strong>icepack_in</strong>
and take the values ‘clim’ (climatology) and ‘default’ (constant).
<code class="docutils literal"><span class="pre">nit_data_type</span></code> may also take the value ‘sss’ which sets nitrate to the
ocean salinity value. For climatology, the data directory <code class="docutils literal"><span class="pre">bgc_data_dir</span></code>
must also be specified. If <cite>restore_bgc</cite> is true, then values are
linearly restored to climatology according to the restoring timescale
<code class="docutils literal"><span class="pre">trestore</span></code>.</p>
<p>For each horizontal grid point, local biogeochemical tracer equations
are solved in <strong>icepack_algae.F90</strong>. There are two types of ice–ocean
tracer flux formulations: ‘Jin2006’ modelled after the growth rate
dependent piston velocity of <a class="reference internal" href="zreferences.html#jdwstwlg06" id="id108">[26]</a>, and
‘constant’ modelled after the constant piston velocity of
<a class="reference internal" href="zreferences.html#edhhjjls12" id="id109">[12]</a>. The formulation is specified in
<strong>icepack_in</strong> by setting <cite>bgc_flux_type</cite> equal to ‘Jin2006’ or ‘constant’.</p>
<p>In addition to horizontal advection and transport among thickness
categories, biogeochemical tracers (<span class="math">\(T_b\)</span> where
<span class="math">\(b = 1,\ldots, N_b\)</span>) satisfy a set of local coupled equations of
the form</p>
<div class="math">
\[\frac{d T_b}{dt}  = w_b \frac{\Delta T_b}{\Delta z} +  R_b({T_j : j = 1,\ldots,N_b})\]</div>
<p>where <span class="math">\(R_b\)</span> represents the nonlinear biochemical reaction terms
detailed in <a class="reference internal" href="zreferences.html#edhhjjls12" id="id110">[12]</a> and <span class="math">\(\Delta z\)</span> is a
length scale representing the molecular sublayer of the ice–ocean
interface. Its value is absorbed in the piston velocity parameters. The
piston velocity <span class="math">\(w_b\)</span> depends on the particular tracer and the
flux formulation.</p>
<p>For ‘Jin2006’, the piston velocity is a function of ice growth and melt
rates. All tracers (algae included) flux with the same piston velocity
during ice growth, <span class="math">\(dh/dt &gt; 0\)</span>:</p>
<div class="math" id="equation-pwJin-growth">
<span class="eqno">(122)<a class="headerlink" href="#equation-pwJin-growth" title="Permalink to this equation">¶</a></span>\[w_b   =   - p_g\left|m_1 + m_2 \frac{dh}{dt} - m_3
  \left(\frac{dh}{dt} \right)^2\right|\]</div>
<p>with parameters <span class="math">\(m_1\)</span>, <span class="math">\(m_2\)</span>, <span class="math">\(m_3\)</span> and <span class="math">\(p_g\)</span>
defined in <strong>skl_biogeochemistry</strong>. For ice melt, <span class="math">\(dh/dt &lt; 0\)</span>,
all tracers with the exception of ice algae flux with</p>
<div class="math" id="equation-pwJin-melt">
<span class="eqno">(123)<a class="headerlink" href="#equation-pwJin-melt" title="Permalink to this equation">¶</a></span>\[w_b  =  p_m\left|m_2 \frac{dh}{dt} - m_3
    \left(\frac{dh}{dt}  \right)^2\right|\]</div>
<p>with <span class="math">\(p_m\)</span> defined in <strong>skl_biogeochemistry</strong>. The ‘Jin2006’
formulation also requires that for both expressions,
<span class="math">\(|w_b| \leq 0.9
h_{sk}/\Delta t\)</span>. The concentration difference at the ice–ocean boundary
for each tracer, <span class="math">\(\Delta
T_b\)</span>, depends on the sign of <span class="math">\(w_b\)</span>. For growing ice,
<span class="math">\(w_b &lt;0\)</span>, <span class="math">\(\Delta T_b  = T_b/h_{sk} - T_{io}\)</span>, where
<span class="math">\(T_{io}\)</span> is the ocean concentration of tracer <span class="math">\(i\)</span>. For
melting ice, <span class="math">\(w_b &gt; 0\)</span>, <span class="math">\(\Delta T_b = T_b/h_{sk}\)</span>.</p>
<p>In ‘Jin2006’, the algal tracer (<span class="math">\(N_a\)</span>) responds to ice melt in the
same manner as the other tracers from Equation <a class="reference internal" href="#equation-pwJin-melt">(123)</a>. However, this is
not the case for ice growth. Unlike dissolved nutrients, algae are able
to cling to the ice matrix and resist expulsion during desalination. For
this reason, algal tracers do not flux between ice and ocean during ice
growth unless the ice algal brine concentration is less than the ocean
algal concentration (<span class="math">\(N_o\)</span>). Then the ocean seeds the sea ice
concentration according to</p>
<div class="math" id="equation-seed1">
<span class="eqno">(124)<a class="headerlink" href="#equation-seed1" title="Permalink to this equation">¶</a></span>\[w_b \frac{\Delta N_a}{\Delta z} = \frac{N_oh_{sk}/\phi_{sk} -
  N_a}{\Delta t}\]</div>
<p>The ‘constant’ formulation uses a fixed piston velocity (PVc) for
positive ice growth rates for all tracers except <span class="math">\(N_a\)</span>. As in
‘Jin2006’, congelation ice growth seeds the sea ice algal population
according to Equation <a class="reference internal" href="#equation-seed1">(124)</a> when <span class="math">\(N_a &lt; N_o
h_{sk}/\phi_{sk}\)</span>. For bottom ice melt, all tracers follow the
prescription</p>
<div class="math" id="equation-constant-melt">
<span class="eqno">(125)<a class="headerlink" href="#equation-constant-melt" title="Permalink to this equation">¶</a></span>\[\begin{split}w_b \frac{\Delta T_b}{\Delta z} =  \left\{ \begin{array}{ll}
   T_b   |dh_i/dt|/h_{sk} \ \ \ \ \ &amp;   \mbox{if }
 |dh_i/dt|\Delta t/h_{sk} &lt; 1  \\
 T_b/\Delta t &amp; \mbox{otherwise.}   \end{array} \right.\end{split}\]</div>
<p>All of the necessary fluxes required for coupling to an ocean model
component are contained in a single array, <cite>flux_bio</cite>.</p>
<p>This bottom-specific biogeochemistry module necessarily simplifies the
full sea ice ecosystem. For the moment, zooplankton comprise an
imaginary tracer of indefinite mass that make their presence felt mainly
through the recycling of ammonia
<a class="reference internal" href="zreferences.html#edhhjjls12" id="id111">[12]</a><a class="reference internal" href="zreferences.html#jdwstwlg06" id="id112">[26]</a>. Consumer organisms are
essentially siphoned off of the standard primary production pathway as
a fixed fraction of overall growth <a class="reference internal" href="zreferences.html#aks93" id="id113">[3]</a>. Transfer
velocities relating the upper water column to ice fluids and solutes are
now parameterized as a function of off-line congelation rates, based on
laboratory brine expulsion data
<a class="reference internal" href="zreferences.html#aks93" id="id114">[3]</a><a class="reference internal" href="zreferences.html#edhhjjls12" id="id115">[12]</a><a class="reference internal" href="zreferences.html#jdwstwlg06" id="id116">[26]</a>.</p>
</div>
</div>
<div class="section" id="biogeochemistry-nj">
<h3>2.2.6. Biogeochemistry - NJ<a class="headerlink" href="#biogeochemistry-nj" title="Permalink to this headline">¶</a></h3>
<p>CHECK: refer to section <a class="reference internal" href="#ice-bgc-tracers"><span class="std std-ref">Biogeochemistry</span></a> for description
of how tracers are carried (on brine volume, etc), units, tracer flags</p>
<p>Provide broad overview of kinds of BGC configurations available, in intro paragraph.
Bottom layer, vertical BGC, aerosols, connection (or not) with brine height tracer.</p>
<p>From: Nicole Jeffery, Scott Elliott, Elizabeth C. Hunke, William H. Lipscomb, and Adrian K. Turner</p>
<div class="section" id="aerosols">
<h4>2.2.6.1. Aerosols<a class="headerlink" href="#aerosols" title="Permalink to this headline">¶</a></h4>
<div class="section" id="default-aerosols">
<h5>2.2.6.1.1. Default Aerosols<a class="headerlink" href="#default-aerosols" title="Permalink to this headline">¶</a></h5>
<p>Aerosols may be deposited on the ice and gradually work their way
through it until the ice melts and they are passed into the ocean. They
are defined as ice and snow volume tracers (Eq.&nbsp;15 and 16 in CICE.v5
documentation), with the snow and ice each having two tracers for each
aerosol species, one in the surface scattering layer (delta-Eddington
SSL) and one in the snow or ice interior below the SSL.</p>
<p>Rather than updating aerosols for each change to ice/snow thickness due
to evaporation, melting, snow-ice formation, etc., during the
thermodynamics calculation, these changes are deduced from the
diagnostic variables (melts, meltb, snoice, etc) in
<strong>ice_aerosol.F90</strong>. Three processes change the volume of ice or snow
but do not change the total amount of aerosol, thus causing the aerosol
concentration (the value of the tracer itself) to increase: evaporation,
snow deposition and basal ice growth. Basal and lateral melting remove
all aerosols in the melted portion. Surface ice and snow melt leave a
significant fraction of the aerosols behind, but they do “scavenge” a
fraction of them given by the parameter kscav = [0.03, 0.2, 0.02, 0.02,
0.01, 0.01] (only the first 3 are used in CESM, for their 3 aerosol
species). Scavenging also applies to snow-ice formation. When sea ice
ridges, a fraction of the snow on the ridging ice is thrown into the
ocean, and any aerosols in that fraction are also lost to the ocean.</p>
<p>As upper SSL or interior layers disappear from the snow or ice, aerosols
are transferred to the next lower layer, or into the ocean when no ice
remains. The atmospheric flux faero_atm contains the rates of aerosol
deposition for each species, while faero_ocn has the rate at which the
aerosols are transferred to the ocean.</p>
<p>The aerosol tracer flag tr_aero must be set to true in <strong>ice_in</strong>, and
the number of aerosol species is set in <strong>comp_ice</strong>; CESM uses 3.
Global diagnostics are available when print_global is true, and history
variables include the mass density for each layer (snow and ice SSL and
interior), and atmospheric and oceanic fluxes, for each species.</p>
</div>
<div class="section" id="z-aerosols">
<h5>2.2.6.1.2. Z-Aerosols<a class="headerlink" href="#z-aerosols" title="Permalink to this headline">¶</a></h5>
<p>zbgc_colpkg offers an alternate scheme for aerosols in sea ice using
the brine motion based transport scheme of the biogeochemical tracers.
All vertically resolved biogeochemical tracers (z-tracers), including
zaerosols, have the potential to be atmospherically deposited onto the
snow or ice, scavenged during snow melt, and passed into the brine. The
mobile fraction (discussed in <a class="reference internal" href="#mobile-and-stationary"><span class="std std-ref">Mobile and Stationary Phases in code</span></a>) is
then transported via brine drainage processes
(Eq.&nbsp;<a class="reference internal" href="#equation-mobile-transport">(137)</a> in section&nbsp;<a class="reference internal" href="#trans-bio-grid"><span class="std std-ref">Transport along the interface bio grid</span></a>) while a
stationary fraction (discussed in <a class="reference internal" href="#mobile-and-stationary"><span class="std std-ref">Mobile and Stationary Phases in code</span></a>)
adheres to the ice crystals. Snow deposition and the process of
scavenging aerosols during snow melt is consistent with the default
aerosol scheme, though parameters have been generalized to accomadate
potential atmospheric deposition for all z-tracers. For an example, see
the scavenging parameter kscavz for z-tracers defined in
<strong>ice_zbgc_shared</strong>.</p>
<p>Within the snow, z-tracers are defined as concentrations in the snow
surface layer (<span class="math">\(h_{ssl}\)</span>) and the snow interior
(<span class="math">\(h_s-h_{ssl}\)</span>). The total snow content of z-tracers per ice area
per grid cell area, <span class="math">\(C_{snow}\)</span> is</p>
<div class="math">
\[C_{snow} = C_{ssl}h_{ssl} + C_{sint}(h_{s}-h_{ssl})\]</div>
<p>One major difference in how the two schemes model snow aerosol transport
is that the fraction scavenged from snow melt in the z-tracer scheme is
not immediately fluxed into the ocean, but rather, enters the ice as a
source of low salinity but potentially tracer rich brine. The snow melt
source is included as a surface flux condition in <strong>ice_algae.F90</strong>.</p>
<p>All the z-aerosols are nonreactive with the exception of the dust
aerosols. We assume that a small fraction of the dust flux into the ice
has soluble iron (dustFe_sol in <strong>ice_zbgc_shared.F90</strong>) and so is
passed to the dissolved iron tracer. The remaining dust passes through
the ice without reactions.</p>
<p>To use z-aerosols, tr_zaero must be set to true in <strong>ice_in</strong>, and the
number of z-aerosol species is set in <strong>comp_ice</strong>, TRZAERO. Note, the
default tracers tr_aero must be false and NTRAERO in <strong>comp_ice</strong>
should be 0. In addition, z-tracers and the brine height tracer must
also be active. These are set in <strong>ice_in</strong> with tr_brine and
z_tracer equal to true. In addition, to turn on the radiative coupling
between the aerosols and the Delta-Eddington radiative scheme, shortwave
must equal ’dEdd’ and dEdd_algae must be true in <strong>ice_in</strong>.</p>
<p><strong>Caution</strong>: For the time being, the flag dEdd_algae should not be set
true when solve_zbgc or skl_bgc is also true. This feature has not yet
been implemented.</p>
</div>
</div>
<div class="section" id="brine-height-tracer">
<h4>2.2.6.2. Brine height tracer<a class="headerlink" href="#brine-height-tracer" title="Permalink to this headline">¶</a></h4>
<p>The brine height, <span class="math">\(h_b\)</span>, is the distance from the ice-ocean
interface to the brine surface. When tr_brine is set true in
<strong>ice_in</strong> and TRBRI is set equal to 1 in <strong>comp_ice</strong>, the brine
surface can move relative to the ice surface. Physically, this occurs
when the ice is permeable and there is a nonzero pressure head: the
difference between the brine height and the equilibrium sea surface.
Brine height motion is computed in <strong>ice_brine.F90</strong> from thermodynamic
variables ( melts, meltb, meltt etc) and the ice microstructural state
deduced from internal bulk salinities and temperature. This tracer is
required for the transport of vertically resolved biogeochemical tracers
and is closely coupled to the z-salinity prognostic salinity model.</p>
<p>Vertical transport processes are, generally, a result of the brine
motion. Therefore the vertical transport equations for biogeochemical
tracers will be defined only where brine is present. This region, from
the ice-ocean interface to the brine height, defines the domain of the
vertical bio-grid. The resolution of the bio-grid is specified in
<strong>comp_ice</strong> by setting the variable NBGCLYR. A detailed description of
the bio-grid is given in section&nbsp;<a class="reference internal" href="#bio-grid"><span class="std std-ref">Bio grid</span></a>. The ice
microstructural state, determined in <strong>ice_brine.F90</strong>, is computed
from sea ice salinities and temperatures linearly interpolated to the
bio-grid. When <span class="math">\(h_b &gt; h_i\)</span>, the upper surface brine is assumed to
have the same temperature as the ice surface.</p>
<p>Brine height is transported horizontally as the fraction
<span class="math">\(f_{bri} = h_b/h_i\)</span>, a volume conserved tracer (Eq.&nbsp;15 in CICE.v5
documentation). Note that unlike the sea ice porosity, brine height
fraction may be greater than 1 when <span class="math">\(h_b &gt; h_i\)</span>.</p>
<p>Changes to <span class="math">\(h_b\)</span> occur from ice and snow melt, ice bottom boundary
changes, and from pressure adjustments. The computation of <span class="math">\(h_b\)</span>
at <span class="math">\(t+\Delta
t\)</span> is a two step process. First, <span class="math">\(h_b\)</span> is updated from changes in
ice and snow thickness, ie.</p>
<div class="math" id="equation-hb_thickness_changes">
<span class="eqno">(126)<a class="headerlink" href="#equation-hb_thickness_changes" title="Permalink to this equation">¶</a></span>\[h_b' = h_b(t) + \Delta h_b|_{h_i,h_s} .\]</div>
<p>Second, pressure driven adjustments arising from meltwater flushing and
snow loading are applied to <span class="math">\(h'_b\)</span>. Brine flow due to pressure
forces are governed by Darcy’s equation (see CICE.v5 documentation)</p>
<div class="math" id="equation-Darcy2">
<span class="eqno">(127)<a class="headerlink" href="#equation-Darcy2" title="Permalink to this equation">¶</a></span>\[w = -\frac{\Pi^* \bar{\rho} g}{\mu}\frac{h_p}{h_i}.\]</div>
<p>The vertical component of the net permeability tensor <span class="math">\(\Pi^*\)</span> is
computed as</p>
<div class="math" id="equation-netPi2">
<span class="eqno">(128)<a class="headerlink" href="#equation-netPi2" title="Permalink to this equation">¶</a></span>\[\Pi^* = \left(\frac{1}{h}\sum_{i=1}^N{\frac{\Delta
      z_i}{\Pi_i}}\right)^{-1}\]</div>
<p>where the sea ice is composed of <span class="math">\(N\)</span> vertical layers with
<span class="math">\(i\)</span>th layer thickness <span class="math">\(\Delta z_i\)</span> and permeability
<span class="math">\(\Pi_i\)</span>. The average sea ice density is <span class="math">\(\bar{\rho}\)</span>
specified in <strong>ice_zbgc_shared.F90</strong>. The hydraulic head is
<span class="math">\(h_p = h_b - h_{sl}\)</span> where <span class="math">\(h_{sl}\)</span> is the sea level given
by</p>
<div class="math">
\[h_{sl} = \frac{\bar{\rho}}{\rho_w}h_i + \frac{\rho_s}{\rho_w}h_s .\]</div>
<p>Assuming constant <span class="math">\(h_i\)</span> and <span class="math">\(h_s\)</span> during Darcy flow, the
rate of change of <span class="math">\(h_b\)</span> is</p>
<div class="math" id="equation-h_p">
<span class="eqno">(129)<a class="headerlink" href="#equation-h_p" title="Permalink to this equation">¶</a></span>\[\frac{\partial h_b}{\partial t} = -w h_p\]</div>
<p>where <span class="math">\(w_o = \Pi^* \bar{\rho}
g/(h_i\mu\phi_{top})\)</span> and <span class="math">\(\phi_{top}\)</span> is the upper surface
porosity. When the Darcy flow is downward into the ice
(<span class="math">\(w_o &lt; 0\)</span>), then <span class="math">\(\phi_{top}\)</span> equals the sea ice porosity
in the uppermost layer. However, when the flow is upwards into the snow,
then <span class="math">\(\phi_{top}\)</span> equals the snow porosity phi_snow specified in
<strong>ice_in</strong>. If a negative number is specified for phi_snow, then the
default value is used: phi_snow <span class="math">\(=1 - \rho_s/\rho_w\)</span>.</p>
<p>Since <span class="math">\(h_{sl}\)</span> remains relatively unchanged during Darcy flow,
<a class="reference internal" href="#equation-h_p">(129)</a> has the approximate solution</p>
<div class="math" id="equation-brine_height">
<span class="eqno">(130)<a class="headerlink" href="#equation-brine_height" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
h_b(t+\Delta t) \approx h_{sl}(t+\Delta t) +  [h'_b - h_{sl}(t+\Delta t)]\exp\left\{-w \Delta t\right\}.\end{aligned}\]</div>
<p>The contribution <span class="math">\(\Delta h_b|_{h_i,h_s}\)</span> arises from snow and ice
melt and bottom ice changes. Since the ice and brine bottom boundaries
coincide, changes in the ice bottom from growth or melt,
<span class="math">\((\Delta h_i)_{bot}\)</span>, equal the bottom brine boundary changes. The
surface contribution from ice and snow melt, however, is opposite in
sign. The ice contribution is as follows. If <span class="math">\(h_i &gt; h_b\)</span> and the
ice surface is melting, ie. <span class="math">\((\Delta h_i)_{top} &lt;
0\)</span>), then meltwater increases the brine height:</p>
<div class="math">
\[\begin{split}\begin{aligned}
\left(\Delta h_b\right)_{top} = \frac{\rho_i}{\rho_o} \cdot \left\{ \begin{array}{ll}
 -(\Delta h_i)_{top} &amp;  \mbox{if }
 |(\Delta h_i)_{top}| &lt; h_i-h_b  \\
 h_i-h_b &amp; \mbox{otherwise.}   \end{array} \right.  \end{aligned}\end{split}\]</div>
<p>For snowmelt (<span class="math">\(\Delta h_s &lt; 0\)</span>), it is assumed that all snow
meltwater contributes a source of surface brine. The total change from
snow melt and ice thickness changes is</p>
<div class="math" id="equation-dzdt_meltwater">
<span class="eqno">(131)<a class="headerlink" href="#equation-dzdt_meltwater" title="Permalink to this equation">¶</a></span>\[\Delta h_b|_{h_i,h_s} = \left( \Delta
h_b\right)_{top} -\left(\Delta h_i\right)_{bot} -\frac{\rho_s}{\rho_o}\Delta h_s.\]</div>
<p>The above brine height calculation is used only when <span class="math">\(h_i\)</span> and
<span class="math">\(h_b\)</span> exceed a minimum thickness, thinS, specified in
<strong>ice_zbgc_shared</strong>. Otherwise</p>
<div class="math" id="equation-thinbrine2">
<span class="eqno">(132)<a class="headerlink" href="#equation-thinbrine2" title="Permalink to this equation">¶</a></span>\[h_b(t+\Delta t) = h_b(t) + \Delta h_i\]</div>
<p>provided that <span class="math">\(|h_{sl}-h_b| \leq 0.001\)</span>. This formulation ensures
small Darcy velocities when <span class="math">\(h_b\)</span> first exceeds thinS.</p>
</div>
<div class="section" id="sea-ice-biogeochemistry">
<h4>2.2.6.3. Sea Ice Biogeochemistry<a class="headerlink" href="#sea-ice-biogeochemistry" title="Permalink to this headline">¶</a></h4>
<p>There are two options for modeling biogeochemistry in sea ice: 1) a
skeletal layer or bottom layer model (skl-model) that assumes biology
and biological molecules are restricted to a single layer at the base of
the sea ice; and 2) a vertically resolved model (zbgc) that allows for
biogeochemical processes throughout the ice column. The two models may
be run with the same suite of biogeochemical tracers and use the same
module <strong>algal_dyn</strong> in <strong>ice_algae.F90</strong> to determine the biochemical
reaction terms for the tracers at each vertical grid level. In the case
of the skl-model this is a single layer, while for zbgc there are
NBGCLYR<span class="math">\(+1\)</span> vertical layers. The primary difference between the
two schemes is in the vertical transport assumptions for each
biogeochemical tracer. This includes the parameterizations of fluxes
between ocean and ice.</p>
<p>In order to run with the skl-model, the code must be built with the
following options in <strong>comp_ice</strong>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">TRBGCS</span> <span class="mi">1</span>   <span class="c1"># set to 1 for skeletal layer tracers</span>
<span class="n">setenv</span> <span class="n">TRBGCZ</span> <span class="mi">0</span>   <span class="c1"># set to 1 for zbgc tracers</span>
</pre></div>
</div>
<p>For zbgc,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">TRBRI</span>  <span class="mi">1</span>   <span class="c1"># set to 1 for brine height tracer</span>
<span class="n">setenv</span> <span class="n">TRBGCS</span> <span class="mi">0</span>   <span class="c1"># set to 1 for skeletal layer tracers</span>
<span class="n">setenv</span> <span class="n">TRBGCZ</span> <span class="mi">1</span>   <span class="c1"># set to 1 for zbgc tracers</span>
<span class="n">setenv</span> <span class="n">NBGCLYR</span> <span class="mi">7</span>  <span class="c1"># number of zbgc layers</span>
</pre></div>
</div>
<p>There are also environmental variables in <strong>comp_ice</strong> that, in part,
specify the complexity of the ecosystem and are used for both zbgc and
the skl-model. These are 1) TRALG, the number of algal species; 2)
TRDOC, the number of dissolved organic carbon groups, 3) TRDIC, the
number of dissolved inorganic carbon groups (this is currently not yet
implemented and should be set to 0); 4) TRDON, the number of dissolved
organic nitrogen groups, 5) TRFEP , the number of particulate iron
groups; and 6) TRFED, the number of dissolved iron groups. The current
version of <strong>algal_dyn</strong> biochemistry has parameters for up to 3 algal
species (diatoms, small phytoplankton and <em>Phaeocystis</em> sp,
respectively), 2 DOC tracers (polysaccharids and lipids, respectively),
0 DIC tracers, 1 DON tracer (proteins/amino acids), 1 particulate iron
tracer and 1 dissolved iron tracer. Note, for tracers with multiple
species/groups, the order is important. For example, specifying
TRALG = 1 will compute reaction terms using parameters
specific to ice diatoms.</p>
<p>The complexity of the algal ecosystem must be specified in both
<strong>comp_ice</strong> during the build and in the namelist, <strong>ice_in</strong>. The
procedure is equivalent for both the skl-model and zbgc. The namelist
specification is described in detail in section <a class="reference internal" href="#zbgc"><span class="std std-ref">Vertical “Z” BGC</span></a></p>
<p>Biogeochemical upper ocean concentrations are initialized in the
subroutine <strong>colpkg_init_ocean_conc</strong> in <strong>ice_colpkg.F90</strong> unless
coupled to the ocean biogeochemistry. Silicate and nitrate may be read
from a file. This option is specified in the namelist by setting the
variables sil_data_type and nit_data_type to ‘ISPOL’ which is a
rectangular grid option, ‘clim’ which is a monthly climatology on the
gx1v6 grid and ‘default’ which uses the fixed value specified in
<strong>get_forcing_bgc</strong> in <strong>ice_forcing_bgc.F90</strong>. nit_data_type also
has an option ‘sss’ which equates the upper ocean nitrate concentration
with sea surface salinity. fe_data_type currently only has the
‘default’ option. The location of forcing files is specified in
bgc_data_dir and the filename is indicated in <strong>get_forcing_bgc</strong>.</p>
<p>We are currently not supporting biogeochemical forcing data files.</p>
<div class="section" id="skeletal-layer-bgc">
<h5>2.2.6.3.1. Skeletal Layer BGC<a class="headerlink" href="#skeletal-layer-bgc" title="Permalink to this headline">¶</a></h5>
<p>In the skeletal layer model, biogeochemical processing is modelled as a
single layer of reactive tracers attached to the sea ice bottom.
Optional settings are available via the <em>zbgc_nml</em> namelist in
<strong>ice_in</strong>. In particular, skl_bgc must be true and z_tracers and
solve_zbgc must both be false.</p>
<p>History fields are controlled in the <em>icefields_bgc_nml</em> namelist and
will be discussed in section&nbsp;<a class="reference internal" href="#bgc-hist"><span class="std std-ref">Biogeochemistry History Fields</span></a>. As with other CICE
history fields, the suffix _ai indicates that the field is multiplied
by ice area and is therefore a grid cell average.</p>
<p>Skeletal tracers <span class="math">\(T_b\)</span> are ice area conserved and follow the
horizontal transport Eq.&nbsp;14 (In the CICE.v5 documentation). For each
horizontal grid point, local biogeochemical tracer equations are solved
in <strong>ice_algae.F90</strong>. There are two types of ice-ocean tracer flux
formulations: 1) ‘Jin2006’ modeled after the growth rate dependent
piston velocity and 2) ‘constant’ modeled after a constant piston
velocity. The formulation is specified in <strong>ice_in</strong> by setting
bgc_flux_type equal to ‘Jin2006’ or ‘constant’.</p>
<p>In addition to horizontal advection and transport among thickness
categories, biogeochemical tracers (<span class="math">\(T_b\)</span> where
<span class="math">\(b = 1,\ldots, N_b\)</span>) satisfy a set of local coupled equations of
the form</p>
<div class="math" id="equation-bgc_Tracer">
<span class="eqno">(133)<a class="headerlink" href="#equation-bgc_Tracer" title="Permalink to this equation">¶</a></span>\[\frac{d T_b}{dt} = w_b \frac{\Delta T_b}{\Delta z} +  R_b({T_j : j = 1,\ldots,N_b})\]</div>
<p>where <span class="math">\(R_b\)</span> represents the nonlinear biochemical reaction terms
(described in section&nbsp;<a class="reference internal" href="#reactions"><span class="std std-ref">Reaction Terms</span></a>) and <span class="math">\(\Delta z\)</span> is a length
scale representing the molecular sublayer of the ice-ocean interface.
Its value is absorbed in the piston velocity parameters. The piston
velocity <span class="math">\(w_b\)</span> depends on the particular tracer and the flux
formulation.</p>
<p>For ‘Jin2006’, the piston velocity is a function of ice growth and melt
rates. All tracers (algae included) flux with the same piston velocity
during ice growth, <span class="math">\(dh/dt &gt; 0\)</span>:</p>
<div class="math" id="equation-pwJin_growth">
<span class="eqno">(134)<a class="headerlink" href="#equation-pwJin_growth" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
w_b  &amp; =  &amp; - p_g\left|m_1 + m_2 \frac{dh}{dt} - m_3
  \left(\frac{dh}{dt} \right)^2\right|\end{aligned}\]</div>
<p>with parameters <span class="math">\(m_1\)</span>, <span class="math">\(m_2\)</span>, <span class="math">\(m_3\)</span> and <span class="math">\(p_g\)</span>
defined in <strong>skl_biogeochemistry</strong> in <strong>ice_algae.F90</strong>. For ice melt,
<span class="math">\(dh/dt &lt; 0\)</span>, all tracers with the exception of ice algae flux with</p>
<div class="math" id="equation-pwJin_melt">
<span class="eqno">(135)<a class="headerlink" href="#equation-pwJin_melt" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
w_b  &amp; =  &amp; p_m\left|m_2 \frac{dh}{dt} - m_3
    \left(\frac{dh}{dt}  \right)^2\right| \end{aligned}\]</div>
<p>with <span class="math">\(p_m\)</span> defined in <strong>skl_biogeochemistry</strong>. The ‘Jin2006’
formulation also requires that for both expressions,
<span class="math">\(|w_b| \leq 0.9
h_{sk}/\Delta t\)</span>. The concentration difference at the ice-ocean boundary
for each tracer, <span class="math">\(\Delta
T_b\)</span>, depends on the sign of <span class="math">\(w_b\)</span>. For growing ice,
<span class="math">\(w_b &lt;0\)</span>, <span class="math">\(\Delta T_b  = T_b/h_{sk} - T_{io}\)</span>, where
<span class="math">\(T_{io}\)</span> is the ocean concentration of tracer <span class="math">\(i\)</span>. For
melting ice, <span class="math">\(w_b &gt; 0\)</span>, <span class="math">\(\Delta T_b = T_b/h_{sk}\)</span>.</p>
<p>In ‘Jin2006’, the algal tracer (<span class="math">\(N_a\)</span>) responds to ice melt in the
same manner as the other tracers <a class="reference internal" href="#equation-pwJin_melt">(135)</a>. However, this is
not the case for ice growth. Unlike dissolved nutrients, algae are able
to cling to the ice matrix and resist expulsion during desalination. For
this reason, algal tracers do not flux between ice and ocean during ice
growth unless the ice algal brine concentration is less than the ocean
algal concentration (<span class="math">\(N_o\)</span>). Then the ocean seeds the sea ice
concentration according to</p>
<div class="math" id="equation-seed2">
<span class="eqno">(136)<a class="headerlink" href="#equation-seed2" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
w_b \frac{\Delta N_a}{\Delta z} = \frac{N_oh_{sk}/\phi_{sk} -
  N_a}{\Delta t}\end{aligned}\]</div>
<p>The ‘constant’ formulation uses a fixed piston velocity (PVc) for
positive ice growth rates for all tracers except <span class="math">\(N_a\)</span>. As in
‘Jin2006’, congelation ice growth seeds the sea ice algal population
according to <a class="reference internal" href="#equation-seed2">(136)</a> when <span class="math">\(N_a &lt; N_o
h_{sk}/\phi_{sk}\)</span>. For bottom ice melt, all tracers follow the
prescription</p>
<div class="math">
\[\begin{split}\begin{aligned}
 w_b \frac{\Delta T_b}{\Delta z} &amp; = &amp;  \left\{ \begin{array}{ll}
   T_b   |dh_i/dt|/h_{sk} \ \ \ \ \ &amp;   \mbox{if }
 |dh_i/dt|\Delta t/h_{sk} &lt; 1  \\
 T_b/\Delta t &amp; \mbox{otherwise.}   \end{array} \right. \end{aligned}
 :label: constant_melt\end{split}\]</div>
<p>A detailed description of the biogeochemistry reaction terms is given in
section&nbsp;<a class="reference internal" href="#reactions"><span class="std std-ref">Reaction Terms</span></a>.</p>
</div>
<div class="section" id="vertical-z-bgc">
<span id="zbgc"></span><h5>2.2.6.3.2. Vertical “Z” BGC<a class="headerlink" href="#vertical-z-bgc" title="Permalink to this headline">¶</a></h5>
<p>In order to solve for the vertically resolved biogeochemistry, several
flags in <strong>ice_in</strong> must be true: a) tr_brine, b) z_tracers, and c)
solve_zbgc.</p>
<ul class="simple">
<li>a) tr_brine true, turns on the dynamic brine height tracer,
<span class="math">\(h_b\)</span>, which defines the vertical domain of the biogeochemical
tracers. z-Tracer horizontal transport is conserved on ice
volume<span class="math">\(\times\)</span>brine height fraction.</li>
<li>b) z_tracers true, indicates use of vertically resolved
biogeochemical and z-aerosol tracers. This flag alone turns on the
vertical transport scheme but not the biochemistry.</li>
<li>c) solve_zbgc true, turns on the biochemistry for the vertically
resolved tracers and automatically turns on the algal nitrogen tracer
flag tr_bgc_N. If false, tr_bgc_N is set false and any other
biogeochemical tracers in use are transported as passive tracers.
This is appropriate for the black carbon and dust aerosols specified
by tr_zaero true.</li>
</ul>
<p>In addition, a halodynamics scheme must also be on. The default
thermo-halodynamics is mushy layer ktherm set to 2. An alternative uses
the Bitz and Lipscomb thermodynamics ktherm set to 1 and solve_zsal
true (referred to as “zsalinity”).</p>
<p>With the above flags true, the default biochemistry is a simple
algal-nitrate system: tr_bgc_N and tr_bgc_Nit equal true. Options
exist in ice_in to use a more complicated ecosystem which includes up
to three algal classes, two DOC groups, one DON pool, limitation by
nitrate, silicate and dissolved iron, sulfur chemistry plus refractory
humic material.</p>
<p>The <strong>ice_in</strong> namelist options are described below.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;zbgc_nml
    tr_brine        = .true.     ! turns on the brine height tracer
                                 ! (needs TRBRI 1 in comp_ice)
  , restart_hbrine  = .false.    ! restart the brine height tracer
                                 ! (will be automatically switched on
                                 ! if restart = .true.)
  , tr_zaero        = .false.    ! turns on black carbon and
                                 ! dust aerosols
  , modal_aero      = .false.    ! turns on a modal aerosol option
                                 ! (not well tested)
  , skl_bgc         = .false.    ! turns on a single bottom layer
                                 ! biogeochemistry.  z_tracers and
                                 ! solve_zbgc must be false
                                 ! (needs TRBGCS 1 in comp_ice)
  , z_tracers       = .true.     ! turns on vertically resolved transport
                                 ! (needs TRBGCZ 1 in comp_ice)
  , dEdd_algae      = .false.    ! Include radiative impact of algae
                                 ! and aerosols in the delta-Eddington
                                 ! shortwave scheme.  Requires
                                 ! shortwave = &#39;dEdd&#39;
                                 ! (Should not be used when solve_zbgc
                                 !  of skl_bgc are true*)
  , solve_zbgc      = .true.     ! turns on the biochemistry using z_tracers
                                 ! (specify algal numbers in comp_ice TRALG)
  , bgc_flux_type   = &#39;Jin2006&#39;  ! ice-ocean flux type for bottom
                                 ! layer tracers only (skl_bgc = .true.)
  , restore_bgc     = .false.    ! restores upper ocean concentration
                                 ! fields to data values (nitrate and
                                 ! silicate)
  , restart_bgc     = .false.    ! restarts biogeochemical tracers
                                 ! (will be automatically switched on
                                 ! if restart = .true.)
  , scale_bgc       = .false.    ! Initializes biogeochemical profiles
                                 ! to scale with prognosed salinity profile
  , solve_zsal      = .false.    ! prognostic salinity tracer used with
                                 ! ktherm = 1 (zsalinity)
                                 ! (needs TRZS 1 in comp_ice)
  , restart_zsal    = .false.    ! restarts zsalinity
  , bgc_data_dir    = &#39;/nitrate_and_silicate/forcing_directory/&#39;
  , sil_data_type   = &#39;default&#39;  ! fixed, spatially homogenous
                                 ! value. &#39;clim&#39; data file
                                 ! (see ice_forcing_bgc.F90)
  , nit_data_type   = &#39;default&#39;  ! fixed, spatially homogenous
                                 ! value. &#39;clim&#39; data file
                                 ! (see ice_forcing_bgc.F90)
  , fe_data_type    = &#39;default&#39;  ! fixed, spatially homogenous
  , tr_bgc_Nit      = .true.     ! nitrate tracer
  , tr_bgc_C        = .true.     ! Dissolved organic carbon tracers
                                 ! (numbers specified in comp_ice as
                                 ! TRDOC) and dissolved inorganic
                                 ! carbon tracers (not yet implemented,
                                 ! TRDIC 0 in comp_ice)
  , tr_bgc_chl      = .false.    ! dummy variable for now.  Chl is
                                 ! simply a fixed ratio of algal Nitrogen
  , tr_bgc_Am       = .true.     ! Ammonium
  , tr_bgc_Sil      = .true.     ! Silicate
  , tr_bgc_DMS      = .true.     ! Three tracers: DMS dimethyl sulfide, DMSPp
                                 ! (assumed to be a fixed ratio of
                                 ! sulfur to algal Nitrogen) and
                                 ! DMSPd
  , tr_bgc_PON      = .false.    ! passive purely mobile ice tracer with
                                 ! ocean concentration equivalent to nitrate
  , tr_bgc_hum      = .true.     ! refractory DOC or DON (units depend
                                 ! on the ocean source)
  , tr_bgc_DON      = .true.     ! dissolved organic nitrogen (proteins)
  , tr_bgc_Fe       = .true.     ! Dissolved iron (number in comp_ice TRFED)
                                 ! particulate iron (number in comp_ice TRFEP)
  , grid_o          = 0.006      ! ice-ocean surface layer thickness
                                 ! (bgc transport scheme)
  , grid_o_t        = 0.006      ! ice-atm surface layer thickeness
                                 ! (bgc transport scheme)
  , l_sk            = 0.024      ! length scale in gravity drainage
                                 !  parameterization
                                 ! (bgc transport scheme)
  , grid_oS         = 0.0        ! ice-ocean surface layer thickness
                                 ! (zsalinity transport scheme)
  , l_skS           = 0.028      ! ice-atm surface layer thickeness
                                 ! (zsalinity transport scheme)
  , phi_snow        = -0.3       ! snow porosity at the ice-snow interface
                                 ! if &lt; 0 then phi_snow is computed
                                 ! from snow density
  , initbio_frac    = 0.8        ! For each bgc tracer, specifies the
                                 ! fraction of the ocean
                                 ! concentration that is retained in
                                 ! the ice during initial new ice formation.
  , frazil_scav     = 0.8        ! For each bgc tracer, specifies the
                                 ! fraction or multiple of the ocean
                                 ! concentration that is retained in
                                 ! the ice from frazil formation.
                                 !----------------------------------------
                                 !  Notation used below:
                                 !  _diatoms  == diatoms
                                 !  _sp       == small phytoplankton
                                 !  _phaeo    == phaeocystis
                                 !  _s        == saccharids
                                 !       (unless otherwise indicated)
                                 !  _l        == lipdids
                                 !       (unless otherwise indicated)
                                 !----------------------------------------
  , ratio_Si2N_diatoms = 1.8_dbl_kind    ! algal Si to N (mol/mol)
  , ratio_Si2N_sp      = c0
  , ratio_Si2N_phaeo   = c0
  , ratio_S2N_diatoms  = 0.03_dbl_kind   ! algal S  to N (mol/mol)
  , ratio_S2N_sp       = 0.03_dbl_kind
  , ratio_S2N_phaeo    = 0.03_dbl_kind
  , ratio_Fe2C_diatoms = 0.0033_dbl_kind ! algal Fe to C  (umol/mol)
  , ratio_Fe2C_sp      = 0.0033_dbl_kind
  , ratio_Fe2C_phaeo   = p1
  , ratio_Fe2N_diatoms = 0.023_dbl_kind  ! algal Fe to N  (umol/mol)
  , ratio_Fe2N_sp      = 0.023_dbl_kind
  , ratio_Fe2N_phaeo   = 0.7_dbl_kind
  , ratio_Fe2DON       = 0.023_dbl_kind  ! Fe to N of DON (nmol/umol)
  , ratio_Fe2DOC_s     = p1              ! Fe to C of DOC (nmol/umol)
  , ratio_Fe2DOC_l     = 0.033_dbl_kind  ! Fe to C of DOC (nmol/umol)
  , fr_resp            = 0.05_dbl_kind   ! frac of algal growth lost
                                         ! due to respiration
  , tau_min            = 5200.0_dbl_kind ! rapid mobile to stationary
                                         ! exchanges (s)
  , tau_max            = 1.73e5_dbl_kind ! long time mobile to
                                         ! stationary exchanges (s)
  , algal_vel          = 1.11e-8_dbl_kind! 0.5 cm/d(m/s)
  , R_dFe2dust         = 0.035_dbl_kind  ! g/g (3.5% content)
  , dustFe_sol         = 0.005_dbl_kind  ! solubility fraction
  , chlabs_diatoms     = 0.03_dbl_kind   ! chl absorption (1/m/(mg/m^3))
  , chlabs_sp          = 0.01_dbl_kind
  , chlabs_phaeo       = 0.05_dbl_kind
  , alpha2max_low_diatoms = 0.8_dbl_kind ! light limitation (1/(W/m^2))
  , alpha2max_low_sp      = 0.67_dbl_kind
  , alpha2max_low_phaeo   = 0.67_dbl_kind
  , beta2max_diatoms   = 0.018_dbl_kind  ! light inhibition (1/(W/m^2))
  , beta2max_sp        = 0.0025_dbl_kind
  , beta2max_phaeo     = 0.01_dbl_kind
  , mu_max_diatoms     = 1.2_dbl_kind    ! maximum growth rate (1/day)
  , mu_max_sp          = 0.851_dbl_kind
  , mu_max_phaeo       = 0.851_dbl_kind
  , grow_Tdep_diatoms  = 0.06_dbl_kind ! Temperature dependence of
                                       ! growth (1/C)
  , grow_Tdep_sp       = 0.06_dbl_kind
  , grow_Tdep_phaeo    = 0.06_dbl_kind
  , fr_graze_diatoms   = 0.01_dbl_kind ! Fraction grazed
  , fr_graze_sp        = p1
  , fr_graze_phaeo     = p1
  , mort_pre_diatoms   = 0.007_dbl_kind! Mortality (1/day)
  , mort_pre_sp        = 0.007_dbl_kind
  , mort_pre_phaeo     = 0.007_dbl_kind
  , mort_Tdep_diatoms  = 0.03_dbl_kind ! T dependence of mortality (1/C)
  , mort_Tdep_sp       = 0.03_dbl_kind
  , mort_Tdep_phaeo    = 0.03_dbl_kind
  , k_exude_diatoms    = c0            ! algal exudation (1/d)
  , k_exude_sp         = c0
  , k_exude_phaeo      = c0
  , K_Nit_diatoms      = c1            ! nitrate half saturation
                                       ! (mmol/m^3)
  , K_Nit_sp           = c1
  , K_Nit_phaeo        = c1
  , K_Am_diatoms       = 0.3_dbl_kind  ! ammonium half saturation
                                       ! (mmol/m^3)
  , K_Am_sp            = 0.3_dbl_kind
  , K_Am_phaeo         = 0.3_dbl_kind
  , K_Sil_diatoms      = 4.0_dbl_kind  ! silicate half saturation
                                       ! (mmol/m^3)
  , K_Sil_sp           = c0
  , K_Sil_phaeo        = c0
  , K_Fe_diatoms       = c1            ! iron half saturation (nM)
  , K_Fe_sp            = 0.2_dbl_kind
  , K_Fe_phaeo         = p1
  , f_don_protein      = 0.6_dbl_kind  ! fraction of spilled grazing
                                       ! to proteins
  , kn_bac_protein     = 0.03_dbl_kind ! Bacterial degredation of DON (1/d)
  , f_don_Am_protein   = 0.25_dbl_kind ! fraction of remineralized
                                       ! DON to ammonium
  , f_doc_s            = 0.4_dbl_kind  ! fraction of mortality to DOC
  , f_doc_l            = 0.4_dbl_kind  !
  , f_exude_s          = c1            ! fraction of exudation to DOC
  , f_exude_l          = c1            !
  , k_bac_s            = 0.03_dbl_kind ! Bacterial degredation of DOC (1/d)
  , k_bac_l            = 0.03_dbl_kind !
  , T_max              = c0            ! maximum temperature (C)
  , fsal               = c1            ! Salinity limitation (ppt)
  , op_dep_min         = p1            ! Light attenuates for optical
                                       ! depths exceeding min
  , fr_graze_s         = p5            ! fraction of grazing spilled
                                       ! or slopped
  , fr_graze_e         = p5            ! fraction of assimilation excreted
  , fr_mort2min        = p5            ! fractionation of mortality to Am
  , fr_dFe             = 0.3_dbl_kind  ! fraction of remineralized nitrogen
  ,                                    ! (in units of algal iron)
  , k_nitrif           = c0            ! nitrification rate (1/day)
  , t_iron_conv        = 3065.0_dbl_kind ! desorption loss pFe to dFe (day)
  , max_loss           = 0.9_dbl_kind  ! restrict uptake to % of remaining value
  , max_dfe_doc1       = 0.2_dbl_kind  ! max ratio of dFe to
                                       ! saccharides in the ice
                                       !(nM Fe/muM C)
  , fr_resp_s          = 0.75_dbl_kind ! DMSPd fraction of respiration
                                       ! loss as DMSPd
  , y_sk_DMS           = p5            ! fraction conversion given high yield
  , t_sk_conv          = 3.0_dbl_kind  ! Stefels conversion time (d)
  , t_sk_ox            = 10.0_dbl_kind ! DMS oxidation time (d)
  , algaltype_diatoms  = c0            ! ------------------
  , algaltype_sp       = p5            !
  , algaltype_phaeo    = p5            !
  , nitratetype        = -c1           ! mobility type between
  , ammoniumtype       = c1            ! stationary &lt;--&gt;  mobile
  , silicatetype       = -c1           !
  , dmspptype          = p5            !
  , dmspdtype          = -c1           !
  , humtype            = c1            !
  , doctype_s          = p5            !
  , doctype_l          = p5            !
  , dontype_protein    = p5            !
  , fedtype_1          = p5            !
  , feptype_1          = p5            !
  , zaerotype_bc1      = c1            !
  , zaerotype_bc2      = c1            !
  , zaerotype_dust1    = c1            !
  , zaerotype_dust2    = c1            !
  , zaerotype_dust3    = c1            !
  , zaerotype_dust4    = c1            !--------------------
  , ratio_C2N_diatoms  = 7.0_dbl_kind  ! algal C to N ratio (mol/mol)
  , ratio_C2N_sp       = 7.0_dbl_kind
  , ratio_C2N_phaeo    = 7.0_dbl_kind
  , ratio_chl2N_diatoms= 2.1_dbl_kind  ! algal chlorophyll to N ratio (mg/mmol)
  , ratio_chl2N_sp     = 1.1_dbl_kind
  , ratio_chl2N_phaeo  = 0.84_dbl_kind
  , F_abs_chl_diatoms  = 2.0_dbl_kind  ! scales absorbed radiation for dEdd
  , F_abs_chl_sp       = 4.0_dbl_kind
  , F_abs_chl_phaeo    = 5.0
  , ratio_C2N_proteins = 7.0_dbl_kind  ! ratio of C to N in proteins (mol/mol)
/
</pre></div>
</div>
<p>Vertically resolved z-tracers are brine volume conserved and thus depend
on both the ice volume and the brine height fraction tracer
(<span class="math">\(v_{in}f_b\)</span>). These tracers follow the conservation equations for
multiply dependent tracers (see Eq.&nbsp;18 in the CICE.v5 documentation
where <span class="math">\(a_{pnd}a_{i}\)</span> is replaced with <span class="math">\(v_{in}f_b\)</span>) The
following sections describe the vertical biological grid, the vertical
transport equation for mobile tracers, the partitioning of tracers into
mobile and stationary fractions and the biochemical reaction equations.</p>
<div class="section" id="bio-grid">
<span id="id117"></span><h6>2.2.6.3.2.1. Bio grid<a class="headerlink" href="#bio-grid" title="Permalink to this headline">¶</a></h6>
<p>The bio grid is a vertical grid used for solving the brine height
variable <span class="math">\(h_b\)</span> and descretizing the vertical transport equations
of biogeochemical tracers. The bio grid is a non-dimensional vertical
grid which takes the value zero at <span class="math">\(h_b\)</span> and one at the ice-ocean
interface. The number of grid levels is specified during compilation in
<strong>comp_ice</strong> by setting the variable NBGCLYR equal to an integer
(<span class="math">\(n_b\)</span>) .</p>
<p>Ice tracers and microstructural properties defined on the bio grid are
referenced in two ways: as 1) <span class="math">\(n_b+2\)</span> bgrid points and 2)
<span class="math">\(n_b+1\)</span> igrid points. For both bgrid and igrid, the first and last
points reference <span class="math">\(h_b\)</span> and the ice-ocean interface and so take the
values <span class="math">\(0\)</span> and <span class="math">\(1\)</span>, respectively. For bgrid, the interior
points <span class="math">\([2, n_b+1]\)</span> are spaced at <span class="math">\(1/n_b\)</span> intervals
beginning with bgrid(2) = <span class="math">\(1/(2n_b)\)</span> .
The igrid interior points <span class="math">\([2, n_b]\)</span> are also
equidistant with the same spacing, but physically coincide with points
midway between those of the bgrid.</p>
</div>
<div class="section" id="transport-along-the-interface-bio-grid">
<span id="trans-bio-grid"></span><h6>2.2.6.3.2.2. Transport along the interface bio grid<a class="headerlink" href="#transport-along-the-interface-bio-grid" title="Permalink to this headline">¶</a></h6>
<p>Purely mobile tracers are tracers which move with the brine and thus, in
the absence of biochemical reactions, evolve like salinity. For vertical
tracer transport of purely mobile tracers, the flux conserved quantity
is the bulk tracer concentration multiplied by the ice thickness, i.e.
<span class="math">\(C = h\phi
[c]\)</span>, where <span class="math">\(h\)</span> is the ice thickness, <span class="math">\(\phi\)</span> is the
porosity, and <span class="math">\([c]\)</span> is the tracer concentration in the brine.
<span class="math">\(\phi\)</span>, <span class="math">\([c]\)</span> and <span class="math">\(C\)</span> are defined on the interface bio
grid (igrid):</p>
<div class="math">
\[\mbox{igrid}(k) = \Delta (k-1) \ \ \ \mbox{for }k = 1:n_b+1\]</div>
<p>and <span class="math">\(\Delta = 1/n_b\)</span></p>
<p>The biogeochemical module solves the following equation:</p>
<div class="math" id="equation-mobile-transport">
<span class="eqno">(137)<a class="headerlink" href="#equation-mobile-transport" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
\frac{\partial C}{\partial t} &amp; =&amp; \frac{\partial }{\partial x}\left\{
\left( \frac{v}{h} + \frac{w_f}{h\phi} -
  \frac{\tilde{D}}{h^2\phi^2}\frac{\partial \phi}{\partial x} \right) C
+ \frac{\tilde{D}}{h^2\phi}\frac{\partial C}{\partial x}
\right\} + h\phi R([c])\end{aligned}\]</div>
<p>where <span class="math">\(D_{in} = \tilde{D}/h^2 =  (D + \phi D_m)/h^2\)</span> and
<span class="math">\(R([c])\)</span> is the nonlinear biogeochemical interaction term (see
<a class="reference internal" href="zreferences.html#jhe11" id="id118">[25]</a>).</p>
<p>The solution to <a class="reference internal" href="#equation-mobile-transport">(137)</a> is flux-corrected and
positive definite. This is accomplished using a finite element Gelerkin
discretization. Details are in <a class="reference internal" href="#tracer-numerics"><span class="std std-ref">Flux-Corrected, Positive Definite Transport Scheme</span></a> .</p>
</div>
</div>
</div>
<div class="section" id="splitting-tracers-zbgc-type">
<h4>2.2.6.4. Splitting tracers: zbgc_type<a class="headerlink" href="#splitting-tracers-zbgc-type" title="Permalink to this headline">¶</a></h4>
<p>In addition to purely mobile tracers, some tracers may also adsorb or
otherwise adhere to the ice crystals. These tracers exist in both the
mobile and stationary phases. In this case, their total brine
concentration is a sum <span class="math">\(c_m + c_s\)</span> where <span class="math">\(c_m\)</span> is the moble
fraction transported by equation&nbsp;<a class="reference internal" href="#equation-mobile-transport">(137)</a> and <span class="math">\(c_s\)</span>
is fixed vertically in the ice matrix. The algae are an exception,
however. We assume that algae in the stationary phase resist brine
motion, but rather than being fixed vertically, these tracers maintain
their relative position in the ice. Algae that adhere to the ice
interior (bottom, surface), remain in the ice interior (bottom, surface)
until release to the mobile phase.</p>
<p>In order to model the transfer between these fractions, we assume that
tracers adhere (are retained) to the crystals with a time-constant of
<span class="math">\(\tau_{ret}\)</span>, and release with a time constant <span class="math">\(\tau_{rel}\)</span>,
i.e.</p>
<div class="math">
\[\begin{split}\begin{aligned}
\frac{\partial c_m}{\partial t} &amp; = &amp; -\frac{c_m}{\tau_{ret}} + \frac{c_s}{\tau_{rel}} \\
\frac{\partial c_s}{\partial t} &amp; = &amp;\frac{c_m}{\tau_{ret}} - \frac{c_s}{\tau_{rel}}\end{aligned}\end{split}\]</div>
<p>We use the exponential form of these equations:</p>
<div class="math">
\[\begin{aligned}
c_m^{t+dt} &amp; = &amp;
c_m^t\exp\left(\left\{-\frac{dt}{\tau_{ret}}\right)\right\} +
c^t_s\left(1- \exp\left[-\left\{\frac{dt}{\tau_{rel}}\right\}\right]\right)\end{aligned}\]</div>
<div class="math">
\[\begin{aligned}
c_s^{t+dt} &amp; = &amp; c_s^t\exp\left(\left\{-\frac{dt}{\tau_{rel}}\right)\right\} +
c_m^t\left(1-\exp\left[-\left\{\frac{dt}{\tau_{ret}}\right\}\right]\right) \end{aligned}\]</div>
<p>The time constants are functions of the ice growth and melt rates
(<span class="math">\(dh/dt\)</span>). All tracers except algal nitrogen diatoms follow the
simple case: when <span class="math">\(dh/dt \geq 0\)</span>, then
<span class="math">\(\tau_{rel} \rightarrow \infty\)</span> and <span class="math">\(\tau_{ret}\)</span> is finite.
For <span class="math">\(dh/dt &lt; 0\)</span>, then <span class="math">\(\tau_{ret} \rightarrow \infty\)</span> and
<span class="math">\(\tau_{rel}\)</span> is finite. In other words, ice growth promotes
transitions to the stationary phase and ice melt enables transitions to
the mobile phase.</p>
<p>The exception is the diatom pool. We assume that diatoms, the first
algal nitrogen group, can actively maintain their relative position
within the ice, i.e. bottom (interior, upper) algae remain in the bottom
(interior, upper) ice, unless melt rates exceed a threshold. The
namelist parameter algal_vel sets this threshold.</p>
<div class="section" id="mobile-and-stationary-phases-in-code">
<span id="mobile-and-stationary"></span><h5>2.2.6.4.1. Mobile and Stationary Phases in code<a class="headerlink" href="#mobile-and-stationary-phases-in-code" title="Permalink to this headline">¶</a></h5>
<p>The variable bgc_tracer_type determines the mobile to stationary
transition timescales for each z-tracer. It is multi-dimensional with a
value for each z-tracer. For bgc_tracer_type(k) equal to -1, the kth
tracer remains solely in the mobile phase. For bgc_tracer_type(k)
equal to 1, the tracer has maximal rates in the retention phase and
minimal in the release. For bgc_tracer_type(k) equal to 0, the tracer
has maximal rates in the release phase and minimal in the retention.
Finally for bgc_tracer_type(k) equal to 0.5, minimum timescales are
used for both transitions. <a class="reference internal" href="#tab-phases"><span class="std std-ref">Table 3</span></a> summarizes the
transition types. The tracer types are: algaltype_diatoms,
algaltype_sp (small plankton), algaltype_phaeo (<em>phaeocystis</em>),
nitratetype, ammoniumtype, silicatetype, dmspptype, dmspdtype, humtype,
doctype_s (saccharids), doctype_l (lipids), dontype_protein,
fedtype_1, feptype_1, zaerotype_bc1 (black carbon class 1),
zaerotype_bc2 (black carbon class 2), and four dust classes,
zaerotype_dustj, where J takes values 1 to 4. These may be modified to
increase or decrease retention. Another option is to alter the minimum
tau_min and maximum tau_max timescales which would impact all the
z-tracers.</p>
<p><a class="reference internal" href="#tab-phases"><span class="std std-ref">Table 3</span></a>: <em>Types of Mobile and Stationary Transitions</em></p>
<span id="tab-phases"></span><table border="1" class="docutils" id="id125">
<caption><span class="caption-text">Table 3</span><a class="headerlink" href="#id125" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="23%" />
<col width="23%" />
<col width="34%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">bgc_tracer_type</th>
<th class="head"><span class="math">\(\tau_{ret}\)</span></th>
<th class="head"><span class="math">\(\tau_{rel}\)</span></th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>-1.0</td>
<td><span class="math">\(\infty\)</span></td>
<td>0</td>
<td>entirely in the mobile phase</td>
</tr>
<tr class="row-odd"><td>0.0</td>
<td>min</td>
<td>max</td>
<td>retention dominated</td>
</tr>
<tr class="row-even"><td>1.0</td>
<td>max</td>
<td>min</td>
<td>release dominated</td>
</tr>
<tr class="row-odd"><td>0.5</td>
<td>min</td>
<td>min</td>
<td>equal but rapid exchange</td>
</tr>
<tr class="row-even"><td>2.0</td>
<td>max</td>
<td>max</td>
<td>equal but slow exchange</td>
</tr>
</tbody>
</table>
<p>The fraction of a given tracer in the mobile phase is independent of ice
depth and stored in the tracer variable zbgc_frac. The horizontal
transport of this tracer is conserved on brine volume and so is
dependent on two tracers: brine height fraction (<span class="math">\(f_b\)</span>) and ice
volume (<span class="math">\(v_{in}\)</span>). The conservation equations are given by Eq.&nbsp;18
in the CICE.v5 documentation with <span class="math">\(a_{pnd}a_{i}\)</span> replaced by
<span class="math">\(f_bv_{in}\)</span>.</p>
<p>The tracer, zbgc_frac, is initialized to 1 during new ice formation,
because all z-tracers are initially in the purely mobile phase.
Similarly, as the ice melts, z-tracers return to the mobile phase. Very
large release timescales will prevent this transition and could result
in an unphysically large accumulation during the melt season.</p>
</div>
</div>
<div class="section" id="reaction-terms">
<span id="reactions"></span><h4>2.2.6.5. Reaction Terms<a class="headerlink" href="#reaction-terms" title="Permalink to this headline">¶</a></h4>
<p>The biogeochemical reaction terms for each biogeochemical tracer (see
table <a class="reference internal" href="#tab-bio-tracer"><span class="std std-ref">Table 4</span></a> for tracer definitions) are defined in
<strong>ice_algae.F90</strong> in the subroutine algal_dyn. The same set of
equations is used for the bottom layer model (when sk_bgc is true) and
the multi-layer biogeochemical model (when z_tracers and solve_zbgc
are true).</p>
<p><a class="reference internal" href="#tab-bio-tracer"><span class="std std-ref">Table 4</span></a>: <em>Biogeochemical Tracers</em></p>
<span id="tab-bio-tracer"></span><table border="1" class="colwidths-given docutils" id="id126">
<caption><span class="caption-text">Table 4</span><a class="headerlink" href="#id126" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="10%" />
<col width="22%" />
<col width="22%" />
<col width="22%" />
<col width="22%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Text Variable</th>
<th class="head">Variable in code</th>
<th class="head">flag</th>
<th class="head">Description</th>
<th class="head">units</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>N (1)</td>
<td>Nin(1)</td>
<td><cite>tr_bgc_N</cite></td>
<td>diatom</td>
<td><span class="math">\(mmol\)</span> <span class="math">\(N/m^3\)</span></td>
</tr>
<tr class="row-odd"><td>N (2)</td>
<td>Nin(2)</td>
<td><cite>tr_bgc_N</cite></td>
<td>small phytoplankton</td>
<td><span class="math">\(mmol\)</span> <span class="math">\(N/m^3\)</span></td>
</tr>
<tr class="row-even"><td>N (3)</td>
<td>Nin(3)</td>
<td><cite>tr_bgc_N</cite></td>
<td><em>Phaeocystis sp</em></td>
<td><span class="math">\(mmol\)</span> <span class="math">\(N/m^3\)</span></td>
</tr>
<tr class="row-odd"><td>DOC (1)</td>
<td>DOCin(1)</td>
<td><cite>tr_bgc_DOC</cite></td>
<td>polysaccharids</td>
<td><span class="math">\(mmol\)</span> <span class="math">\(C/m^3\)</span></td>
</tr>
<tr class="row-even"><td>DOC (2)</td>
<td>DOCin(2)</td>
<td><cite>tr_bgc_DOC</cite></td>
<td>lipids</td>
<td><span class="math">\(mmol\)</span> <span class="math">\(C/m^3\)</span></td>
</tr>
<tr class="row-odd"><td>DON</td>
<td>DONin(1)</td>
<td><cite>tr_bgc_DON</cite></td>
<td>proteins</td>
<td><span class="math">\(mmol\)</span> <span class="math">\(C/m^3\)</span></td>
</tr>
<tr class="row-even"><td>fed</td>
<td>Fedin(1)</td>
<td><cite>tr_bgc_Fe</cite></td>
<td>dissolved iron</td>
<td><span class="math">\(\mu\)</span> <span class="math">\(Fe/m^3\)</span></td>
</tr>
<tr class="row-odd"><td>fep</td>
<td>Fepin(1)</td>
<td><cite>tr_bgc_Fe</cite></td>
<td>particulate iron</td>
<td><span class="math">\(\mu\)</span> <span class="math">\(Fe/m^3\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\({\mbox{NO$_3$}}\)</span></td>
<td>Nitin</td>
<td><cite>tr_bgc_Nit</cite></td>
<td><span class="math">\({\mbox{NO$_3$}}\)</span></td>
<td><span class="math">\(mmol\)</span> <span class="math">\(N/m^3\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\({\mbox{NH$_4$}}\)</span></td>
<td>Amin</td>
<td><cite>tr_bgc_Am</cite></td>
<td><span class="math">\({\mbox{NH$_4$}}\)</span></td>
<td><span class="math">\(mmol\)</span> <span class="math">\(N/m^3\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\({\mbox{SiO$_3$}}\)</span></td>
<td>Silin</td>
<td><cite>tr_bgc_Sil</cite></td>
<td><span class="math">\({\mbox{SiO$_2$}}\)</span></td>
<td><span class="math">\(mmol\)</span> <span class="math">\(Si/m^3\)</span></td>
</tr>
<tr class="row-odd"><td>DMSPp</td>
<td>DMSPpin</td>
<td><cite>tr_bgc_DMS</cite></td>
<td>particulate DMSP</td>
<td><span class="math">\(mmol\)</span> <span class="math">\(S/m^3\)</span></td>
</tr>
<tr class="row-even"><td>DMSPd</td>
<td>DMSPdin</td>
<td><cite>tr_bgc_DMS</cite></td>
<td>dissolved DMSP</td>
<td><span class="math">\(mmol\)</span> <span class="math">\(S/m^3\)</span></td>
</tr>
<tr class="row-odd"><td>DMS</td>
<td>DMSin</td>
<td><cite>tr_bgc_DMS</cite></td>
<td>DMS</td>
<td><span class="math">\(mmol\)</span> <span class="math">\(S/m^3\)</span></td>
</tr>
<tr class="row-even"><td>PON</td>
<td>PON <span class="math">\(^a\)</span></td>
<td><cite>tr_bgc_PON</cite></td>
<td>passive mobile tracer</td>
<td><span class="math">\(mmol\)</span> <span class="math">\(N/m^3\)</span></td>
</tr>
<tr class="row-odd"><td>hum</td>
<td>hum <span class="math">\(^{ab}\)</span></td>
<td><cite>tr_bgc_hum</cite></td>
<td>passive sticky tracer</td>
<td><span class="math">\(mmol\)</span> <span class="math">\(/m^3\)</span></td>
</tr>
<tr class="row-even"><td>BC (1)</td>
<td>zaero(1) <span class="math">\(^a\)</span></td>
<td><cite>tr_zaero</cite></td>
<td>black carbon species 1</td>
<td><span class="math">\(kg\)</span> <span class="math">\(/m^3\)</span></td>
</tr>
<tr class="row-odd"><td>BC (2)</td>
<td>zaero(2) <span class="math">\(^a\)</span></td>
<td><cite>tr_zaero</cite></td>
<td>black carbon species 2</td>
<td><span class="math">\(kg\)</span> <span class="math">\(/m^3\)</span></td>
</tr>
<tr class="row-even"><td>dust (1)</td>
<td>zaero(3) <span class="math">\(^a\)</span></td>
<td><cite>tr_zaero</cite></td>
<td>dust species 1</td>
<td><span class="math">\(kg\)</span> <span class="math">\(/m^3\)</span></td>
</tr>
<tr class="row-odd"><td>dust (2)</td>
<td>zaero(4) <span class="math">\(^a\)</span></td>
<td><cite>tr_zaero</cite></td>
<td>dust species 2</td>
<td><span class="math">\(kg\)</span> <span class="math">\(/m^3\)</span></td>
</tr>
<tr class="row-even"><td>dust (3)</td>
<td>zaero(5) <span class="math">\(^a\)</span></td>
<td><cite>tr_zaero</cite></td>
<td>dust species 3</td>
<td><span class="math">\(kg\)</span> <span class="math">\(/m^3\)</span></td>
</tr>
<tr class="row-odd"><td>dust (4)</td>
<td>zaero(6) <span class="math">\(^a\)</span></td>
<td><cite>tr_zaero</cite></td>
<td>dust species 4</td>
<td><span class="math">\(kg\)</span> <span class="math">\(/m^3\)</span></td>
</tr>
</tbody>
</table>
<p><span class="math">\(^a\)</span> not modified in <code class="docutils literal"><span class="pre">algal_dyn</span></code></p>
<p><span class="math">\(^b\)</span> may be in C or N units depending on the ocean concentration</p>
<div class="section" id="the-reaction-equations">
<h5>2.2.6.5.1. The Reaction Equations<a class="headerlink" href="#the-reaction-equations" title="Permalink to this headline">¶</a></h5>
<p>The biochemical reaction term for each algal species has the form:</p>
<div class="math">
\[\Delta {\mbox{N}}/dt = R_{{\mbox{N}}} = \mu (1- f_{graze} - f_{res}) - M_{ort}\]</div>
<p>where <span class="math">\(\mu\)</span> is the algal growth rate, <span class="math">\(M_{ort}\)</span> is a
mortality loss, <span class="math">\(f_{graze}\)</span> is the fraction of algal growth that
is lost to predatory grazing, and <span class="math">\(f_{res}\)</span> is the fraction of
algal growth lost to respiration. Algal mortality is temperture
dependent and limited by a maximum loss rate fraction (<span class="math">\(l_{max}\)</span>):</p>
<div class="math">
\[M_{ort} = \min( l_{max}[{\mbox{N}}], m_{pre} \exp\{m_{T}(T-T_{max})\}[{\mbox{N}}])\]</div>
<p>Note, <span class="math">\([\cdots]\)</span> denotes brine concentration.</p>
<p>Nitrate and ammonium reaction terms are given by</p>
<div class="math">
\[\begin{split}\begin{aligned}
\Delta{\mbox{NO$_3$}}/dt &amp; = &amp; R_{{\mbox{NO$_3$}}} =  [{\mbox{NH$_4$}}] k_{nitr}- U^{tot}_{{\mbox{NO$_3$}}} \nonumber \\
\Delta{\mbox{NH$_4$}}/dt &amp; = &amp; R_{{\mbox{NH$_4$}}} = -[{\mbox{NH$_4$}}] k_{nitr} -U^{tot}_{{\mbox{NH$_4$}}} +
(f_{ng}f_{graze}(1-f_{gs})+f_{res})\mu^{tot} \nonumber \\
 &amp;  +  &amp; f_{nm} M_{ort}
\nonumber \\
                     &amp; = &amp;  -[{\mbox{NH$_4$}}]k_{nitr} -U^{tot}_{{\mbox{NH$_4$}}} + N_{remin}\end{aligned}\end{split}\]</div>
<p>where the uptake <span class="math">\(U^{tot}\)</span> and algal growth <span class="math">\(\mu^{tot}\)</span> are
accumulated totals for all algal species. <span class="math">\(k_{nitr}\)</span> is the
nitrification rate and <span class="math">\(f_{ng}\)</span> and <span class="math">\(f_{nm}\)</span> are the
fractions of grazing and algal mortality that are remineralized to
ammonium and <span class="math">\(f_{gs}\)</span> is the fraction of grazing spilled or lost.
Algal growth and nutrient uptake terms are described in more detail in
<a class="reference internal" href="#growth-uptake"><span class="std std-ref">Algal Growth and Nutrient Uptake</span></a>.</p>
<p>Dissolved organic nitrogen satisfies the equation</p>
<div class="math">
\[\begin{aligned}
\Delta {\mbox{DON}}/dt &amp; = &amp; R_{{\mbox{DON}}} = f_{dg}f_{gs}f_{graze}\mu^{tot} - [{\mbox{DON}}]k_{nb}\end{aligned}\]</div>
<p>With a loss from bacterial degration (rate <span class="math">\(k_{nb}\)</span>) and a gain
from spilled grazing that does not enter the <span class="math">\({\mbox{NH$_4$}}\)</span>
pool.</p>
<p>A term Z<span class="math">\(_{oo}\)</span> closes the nitrogen cycle by summing all the
excess nitrogen removed as zooplankton/bacteria in a timestep. This term
is not a true tracer, i.e. not advected horizontally with the ice
motion, but provides a diagnostic comparison of the amount of <span class="math">\(N\)</span>
removed biogeochemically from the ice
<span class="math">\({\mbox{N}}\)</span>-<span class="math">\({\mbox{NO$_3$}}\)</span>-<span class="math">\({\mbox{NH$_4$}}\)</span>-<span class="math">\({\mbox{DON}}\)</span>
cycle at each timestep.</p>
<div class="math">
\[\begin{aligned}
\mbox{Z}_{oo} &amp; = &amp; [(1-f_{ng}(1-f_{gs}) - f_{dg}f_{gs}]f_{graze}\mu^{tot}dt + (1-f_{nm})M_{ort}dt  +
[{\mbox{DON}}]k_{nb}dt \nonumber\end{aligned}\]</div>
<p>Dissolved organic carbon may be divided into polysaccharids and lipids.
Parameters are two dimensional (indicated by superscript <span class="math">\(i\)</span>) with
index 1 corresponding to polysaccharids and index 2 appropriate for
lipids. The <span class="math">\({\mbox{DOC}}^i\)</span> equation is:</p>
<div class="math">
\[\begin{aligned}
\Delta {\mbox{DOC}}^i/dt &amp; = &amp; R_{{\mbox{DOC}}} = f^i_{cg}f_{ng}\mu^{tot} + R^i_{c:n}M_{ort}-[{\mbox{DOC}}]k^i_{cb}\end{aligned}\]</div>
<p>Silicate has no biochemical source terms within the ice and is lost only
through algal uptake:</p>
<div class="math">
\[\begin{aligned}
\Delta {\mbox{SiO$_3$}}/dt &amp; = &amp; R_{{\mbox{SiO$_3$}}} = -U_{{\mbox{SiO$_3$}}}^{tot}\end{aligned}\]</div>
<p>Dissolved iron has algal uptake and remineralization pathways. In
addition, <span class="math">\({\mbox{fed}}\)</span> may be converted to or released from the
particulate iron pool depending on the dissolve iron
(<span class="math">\({\mbox{fed}}\)</span>) to polysaccharid (<span class="math">\({\mbox{DOC}}(1)\)</span>)
concentration ratio. If this ratio exceeds a maximum value
<span class="math">\(r^{max}_{fed:doc}\)</span> then the change in concentration for dissolved
and particulate iron is</p>
<div class="math">
\[\begin{split}\begin{aligned}
\Delta_{fe}{\mbox{fed}}/dt &amp; = &amp; -[{\mbox{fed}}]/\tau_{fe} \nonumber \\
\Delta_{fe}{\mbox{fep}}/dt &amp; = &amp; [{\mbox{fed}}]/\tau_{fe}\end{aligned}\end{split}\]</div>
<p>For values less than <span class="math">\(r^{max}_{fed:doc}\)</span></p>
<div class="math">
\[\begin{split}\begin{aligned}
\Delta_{fe}{\mbox{fed}}/dt &amp; = &amp; [{\mbox{fep}}]/\tau_{fe} \nonumber \\
\Delta_{fe}{\mbox{fep}}/dt &amp; = &amp; -[{\mbox{fep}}]/\tau_{fe}\end{aligned}\end{split}\]</div>
<p>Very long timescales <span class="math">\(\tau_{fe}\)</span> will remove this source/sink
term. The default value is currently set at 3065 days to turn off this
dependency. 61-65 days is a more realistic option (Parekh et al., 2004).</p>
<p>The full equation for <span class="math">\({\mbox{fed}}\)</span> including uptake and
remineralization is</p>
<div class="math">
\[\begin{aligned}
\Delta {\mbox{fed}}/dt &amp; = &amp; R_{{\mbox{fed}}} = -U^{tot}_{{\mbox{fed}}} + f_{fa}R_{fe:n}N_{remin}
+ \Delta_{fe}{\mbox{fed}}/dt\end{aligned}\]</div>
<p>Particulate iron also includes a source term from algal mortality and
grazing that is not immediately bioavailable. The full equation for
<span class="math">\({\mbox{fep}}\)</span> is</p>
<div class="math">
\[\begin{aligned}
\Delta {\mbox{fep}}/dt &amp; = &amp; R_{{\mbox{fep}}} =  R_{fe:n}[\mbox{Z}_{oo}/dt + (1-f_{fa})]N_{remin}
+ \Delta_{fe}{\mbox{fep}}/dt\end{aligned}\]</div>
<p>The sulfur cycle includes <span class="math">\({\mbox{DMS}}\)</span> and dissolved DMSP
(<span class="math">\({\mbox{DMSPd}}\)</span>). Particulate DMSP is assumed to be proportional
to the algal concentration, i.e.
<span class="math">\({\mbox{DMSPp}}= R^i_{s:n}{\mbox{N}}^i\)</span> for algal species
<span class="math">\(i\)</span>. For <span class="math">\({\mbox{DMSP}}\)</span> and <span class="math">\({\mbox{DMS}}\)</span>,</p>
<div class="math">
\[\begin{split}\begin{aligned}
\Delta {\mbox{DMSPd}}/dt &amp; = &amp; R_{{\mbox{DMSPd}}} = R_{s:n}[ f_{sr}f_{res}\mu^{tot}
+f_{nm}M_{ort} ] - [{\mbox{DMSPd}}]/\tau_{dmsp} \nonumber \\
\Delta {\mbox{DMS}}/dt &amp; = &amp; R_{{\mbox{DMS}}} =  y_{dms}[{\mbox{DMSPd}}]/\tau_{dmsp} - [{\mbox{DMS}}]/\tau_{dms}\end{aligned}\end{split}\]</div>
<p>See <a class="reference internal" href="#tuning"><span class="std std-ref">BGC Tuning Parameters</span></a> and Table&nbsp;<a class="reference internal" href="#tab-bio-tracers2"><span class="std std-ref">Table 5</span></a> for a more
complete list and description of biogeochemical parameters.</p>
<div class="section" id="algal-growth-and-nutrient-uptake">
<span id="growth-uptake"></span><h6>2.2.6.5.1.1. Algal Growth and Nutrient Uptake<a class="headerlink" href="#algal-growth-and-nutrient-uptake" title="Permalink to this headline">¶</a></h6>
<p>Nutrient limitation terms are defined, in the simplest ecosystem, for
<span class="math">\({\mbox{NO$_3$}}\)</span>. If the appropriate tracer flags are true, then
limitation terms may also be found for <span class="math">\({\mbox{NH$_4$}}\)</span>,
<span class="math">\({\mbox{SiO$_3$}}\)</span>, and <span class="math">\({\mbox{fed}}\)</span></p>
<div class="math">
\[\begin{split}\begin{aligned}
{\mbox{NO$_3$}}_{lim} &amp; = &amp; \frac{[{\mbox{NO$_3$}}]}{[{\mbox{NO$_3$}}] + K_{{\mbox{NO$_3$}}}} \nonumber \\
{\mbox{NH$_4$}}_{lim} &amp; = &amp; \frac{[{\mbox{NH$_4$}}]}{[{\mbox{NH$_4$}}] + K_{{\mbox{NH$_4$}}}}\nonumber \\
N_{lim} &amp; = &amp;\mbox{min}(1,{\mbox{NO$_3$}}_{lim} + {\mbox{NH$_4$}}_{lim}) \nonumber \\
{\mbox{SiO$_3$}}_{lim} &amp; = &amp; \frac{[{\mbox{SiO$_3$}}]}{[{\mbox{SiO$_3$}}] + K_{{\mbox{SiO$_3$}}}} \nonumber \\
{\mbox{fed}}_{lim} &amp; = &amp; \frac{[{\mbox{fed}}]}{[{\mbox{fed}}] + K_{{\mbox{fed}}}} \end{aligned}\end{split}\]</div>
<p>Light limitation <span class="math">\(L_{lim}\)</span> is defined in the following way:
<span class="math">\(I
_{sw}(z)\)</span> (in <span class="math">\(W/m^2\)</span>) is the shortwave radiation at the ice level
and the optical depth is proportional to the chlorophyll concentration,
<span class="math">\(op_{dep} = chlabs [{\mbox{Chl}a}]\)</span> . If ( <span class="math">\(op_{dep} &gt; op_{min}\)</span>) then</p>
<div class="math">
\[I_{avg} = I_{sw}(1- \exp(-op_{dep}))/op_{dep}\]</div>
<p>otherwise <span class="math">\(I_{avg} = I_{sw}\)</span>.</p>
<div class="math">
\[L_{lim} = (1 - \exp(-\alpha\cdot I_{avg}))\exp(-\beta \cdot I_{avg})\]</div>
<p>The maximal algal growth rate before limitation is</p>
<div class="math">
\[\begin{split}\begin{aligned}
\mu_o &amp; = &amp; \mu_{max}\exp(\mu_T\Delta T)f_{sal}[{\mbox{N}}] \\
\mu' &amp; = &amp; min(L_{lim},N_{lim},{\mbox{SiO$_3$}}_{lim},{\mbox{fed}}_{lim}) \mu_o\end{aligned}\end{split}\]</div>
<p>where <span class="math">\(\mu'\)</span> is the initial estimate of algal growth rate for a
given algal species and <span class="math">\(\Delta T\)</span> is the difference between the
local tempurature and the maximum (in this case
T<span class="math">\(_{max} = 0^o\)</span>C).</p>
<p>The initial estimate of the uptake rate for silicate and iron is</p>
<div class="math">
\[\begin{split}\begin{aligned}
\tilde{U}_{{\mbox{SiO$_3$}}} &amp; = &amp; R_{si:n}\mu' \\
\tilde{U}_{{\mbox{fed}}} &amp; = &amp; R_{fe:n}\mu' \end{aligned}\end{split}\]</div>
<p>For nitrogen uptake, we assume that ammonium is preferentially acquired
by algae. To determine the nitrogen uptake needed for each algal growth
rate of <span class="math">\(\mu\)</span>, first determine the “potential” uptake rate of
ammonium:</p>
<div class="math">
\[U'_{{\mbox{NH$_4$}}} = {\mbox{NH$_4$}}_{lim}\mu_o\]</div>
<p>Then</p>
<div class="math">
\[\begin{split}\begin{aligned}
\tilde{U}_{{\mbox{NH$_4$}}} &amp; = &amp; \min(\mu', U'_{{\mbox{NH$_4$}}}) \\
\tilde{U}_{{\mbox{NO$_3$}}} &amp; = &amp; \mu' - \tilde{U}_{{\mbox{NH$_4$}}}\end{aligned}\end{split}\]</div>
<p>We require that each rate not exceed a maximum loss rate
<span class="math">\(l_{max}/dt\)</span>.This is particularly important when multiple species
are present. In this case, the accumulated uptake rate for each nutrient
is found and the fraction (<span class="math">\(fU^i\)</span>) of uptake due to algal species
<span class="math">\(i\)</span> is saved. Then the total uptake rate is compared with the
maximum loss condition. For example, the net uptake of nitrate when
there are three algal species is</p>
<div class="math">
\[\tilde{U}^{tot}_{{\mbox{NO$_3$}}} = \sum^{3}_{i=1}\tilde{U}^i_{{\mbox{NO$_3$}}}\ \ \ .\]</div>
<p>Then the uptake fraction for species <span class="math">\(i\)</span> and the adjusted total
uptake is</p>
<div class="math">
\[\begin{split}\begin{aligned}
fU^i_{{\mbox{NO$_3$}}} &amp; = &amp; \frac{\tilde{U}^i_{{\mbox{NO$_3$}}}}{\tilde{U}^{tot}_{{\mbox{NO$_3$}}}} \nonumber \\
U^{tot}_{{\mbox{NO$_3$}}} &amp; = &amp; \min(\tilde{U}^{tot}_{{\mbox{NO$_3$}}}, l_{max}[{\mbox{NO$_3$}}]/dt)\end{aligned}\end{split}\]</div>
<p>Now, for each algal species the nitrate uptake is</p>
<div class="math">
\[U^i_{{\mbox{NO$_3$}}} = fU^i_{{\mbox{NO$_3$}}} U^{tot}_{{\mbox{NO$_3$}}}\]</div>
<p>Similar expressions are found for all potentially limiting nutrients.
Then the true growth rate for each algal species <span class="math">\(i\)</span> is</p>
<div class="math">
\[\begin{aligned}
\mu^i &amp; = &amp; \min(U^i_{{\mbox{SiO$_3$}}}/R_{si:n}, U^i_{{\mbox{NO$_3$}}} + U^i_{{\mbox{NH$_4$}}}, U^i_{{\mbox{fed}}}/R_{fe:n})\end{aligned}\]</div>
<p>Preferential ammonium uptake is assumed once again and the remaining
nitrogen is taken from the nitrate pool.</p>
</div>
<div class="section" id="bgc-tuning-parameters">
<span id="tuning"></span><h6>2.2.6.5.1.2. BGC Tuning Parameters<a class="headerlink" href="#bgc-tuning-parameters" title="Permalink to this headline">¶</a></h6>
<p>Biogeochemical tuning parameters are specified as namelist options in
<strong>ice_in</strong>. Table&nbsp;<a class="reference internal" href="#tab-bio-tracers2"><span class="std std-ref">Table 5</span></a> provides a list of parameters
used in the reaction equations, their representation in the code, a
short description of each and the default values. Please keep in mind
that there has only been minimal tuning of the model.</p>
<p><a class="reference internal" href="#tab-bio-tracers2"><span class="std std-ref">Table 5</span></a> :<em>Biogeochemical Reaction Parameters</em></p>
<span id="tab-bio-tracers2"></span><table border="1" class="colwidths-given docutils" id="id127">
<caption><span class="caption-text">Table 5</span><a class="headerlink" href="#id127" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="10%" />
<col width="28%" />
<col width="21%" />
<col width="21%" />
<col width="21%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Text Variable</th>
<th class="head">Variable in code</th>
<th class="head">Description</th>
<th class="head">Value</th>
<th class="head">units</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><span class="math">\(f_{graze}\)</span></td>
<td>fr_graze(1:3)</td>
<td>fraction of growth grazed</td>
<td>0, 0.1, 0.1</td>
<td>1</td>
</tr>
<tr class="row-odd"><td><span class="math">\(f_{res}\)</span></td>
<td>fr_resp</td>
<td>fraction of growth respired</td>
<td>0.05</td>
<td>1</td>
</tr>
<tr class="row-even"><td><span class="math">\(l_{max}\)</span></td>
<td>max_loss</td>
<td>maximum tracer loss fraction</td>
<td>0.9</td>
<td>1</td>
</tr>
<tr class="row-odd"><td><span class="math">\(m_{pre}\)</span></td>
<td>mort_pre(1:3)</td>
<td>maximum mortality rate</td>
<td>0.007, 0.007, 0.007</td>
<td>day<span class="math">\(^{-1}\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(m_{T}\)</span></td>
<td>mort_Tdep(1:3)</td>
<td>mortality temperature decay</td>
<td>0.03, 0.03, 0.03</td>
<td><span class="math">\(^o\)</span>C<span class="math">\(^{-1}\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(T_{max}\)</span></td>
<td>T_max</td>
<td>maximum brine temperature</td>
<td>0</td>
<td><span class="math">\(^o\)</span>C</td>
</tr>
<tr class="row-even"><td><span class="math">\(k_{nitr}\)</span></td>
<td>k_nitrif</td>
<td>nitrification rate</td>
<td>0</td>
<td>day<span class="math">\(^{-1}\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(f_{ng}\)</span></td>
<td>fr_graze_e</td>
<td>fraction of grazing excreted</td>
<td>0.5</td>
<td>1</td>
</tr>
<tr class="row-even"><td><span class="math">\(f_{gs}\)</span></td>
<td>fr_graze_s</td>
<td>fraction of grazing spilled</td>
<td>0.5</td>
<td>1</td>
</tr>
<tr class="row-odd"><td><span class="math">\(f_{nm}\)</span></td>
<td>fr_mort2min</td>
<td>fraction of mortality to <span class="math">\({\mbox{NH$_4$}}\)</span></td>
<td>0.5</td>
<td>1</td>
</tr>
<tr class="row-even"><td><span class="math">\(f_{dg}\)</span></td>
<td>f_don</td>
<td>frac. spilled grazing to <span class="math">\({\mbox{DON}}\)</span></td>
<td>0.6</td>
<td>1</td>
</tr>
<tr class="row-odd"><td><span class="math">\(k_{nb}\)</span></td>
<td>kn_bac <span class="math">\(^a\)</span></td>
<td>bacterial degradation of <span class="math">\({\mbox{DON}}\)</span></td>
<td>0.03</td>
<td>day<span class="math">\(^{-1}\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(f_{cg}\)</span></td>
<td>f_doc(1:3)</td>
<td>fraction of mortality to <span class="math">\({\mbox{DOC}}\)</span></td>
<td>0.4, 0.4, 0.2</td>
<td>1</td>
</tr>
<tr class="row-odd"><td><span class="math">\(R_{c:n}^c\)</span></td>
<td>R_C2N(1:3)</td>
<td>algal carbon to nitrogen ratio</td>
<td>7.0, 7.0, 7.0</td>
<td>mol/mol</td>
</tr>
<tr class="row-even"><td><span class="math">\(k_{cb}\)</span></td>
<td>k_bac1:3<span class="math">\(^a\)</span></td>
<td>bacterial degradation of DOC</td>
<td>0.03, 0.03, 0.03</td>
<td>day<span class="math">\(^{-1}\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\tau_{fe}\)</span></td>
<td>t_iron_conv</td>
<td>conversion time pFe <span class="math">\(\leftrightarrow\)</span> dFe</td>
<td>3065.0</td>
<td>day</td>
</tr>
<tr class="row-even"><td><span class="math">\(r^{max}_{fed:doc}\)</span></td>
<td>max_dfe_doc1</td>
<td>max ratio of dFe to saccharids</td>
<td>0.1852</td>
<td>nM Fe<span class="math">\(/\mu\)</span>M C</td>
</tr>
<tr class="row-odd"><td><span class="math">\(f_{fa}\)</span></td>
<td>fr_dFe</td>
<td>fraction of remin. N to dFe</td>
<td>0.3</td>
<td>1</td>
</tr>
<tr class="row-even"><td><span class="math">\(R_{fe:n}\)</span></td>
<td>R_Fe2N(1:3)</td>
<td>algal Fe to N ratio</td>
<td>0.023, 0.023, 0.7</td>
<td>mmol/mol</td>
</tr>
<tr class="row-odd"><td><span class="math">\(R_{s:n}\)</span></td>
<td>R_S2N(1:3)</td>
<td>algal S to N ratio</td>
<td>0.03, 0.03, 0.03</td>
<td>mol/mol</td>
</tr>
<tr class="row-even"><td><span class="math">\(f_{sr}\)</span></td>
<td>fr_resp_s</td>
<td>resp. loss as DMSPd</td>
<td>0.75</td>
<td>1</td>
</tr>
<tr class="row-odd"><td><span class="math">\(\tau_{dmsp}\)</span></td>
<td>t_sk_conv</td>
<td>Stefels rate</td>
<td>3.0</td>
<td>day</td>
</tr>
<tr class="row-even"><td><span class="math">\(\tau_{dms}\)</span></td>
<td>t_sk_ox</td>
<td>DMS oxidation rate</td>
<td>10.0</td>
<td>day</td>
</tr>
<tr class="row-odd"><td><span class="math">\(y_{dms}\)</span></td>
<td>y_sk_DMS</td>
<td>yield for DMS conversion</td>
<td>0.5</td>
<td>1</td>
</tr>
<tr class="row-even"><td><span class="math">\(K_{{\mbox{NO$_3$}}}\)</span></td>
<td>K_Nit(1:3)</td>
<td><span class="math">\({\mbox{NO$_3$}}\)</span> half saturation constant</td>
<td>1,1,1</td>
<td>mmol/m<span class="math">\(^{3}\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(K_{{\mbox{NH$_4$}}}\)</span></td>
<td>K_Am(1:3)</td>
<td><span class="math">\({\mbox{NH$_4$}}\)</span> half saturation constant</td>
<td>0.3, 0.3, 0.3</td>
<td>mmol/m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(K_{{\mbox{SiO$_3$}}}\)</span></td>
<td>K_Sil(1:3)</td>
<td>silicate half saturation constant</td>
<td>4.0, 0, 0</td>
<td>mmol/m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(K_{{\mbox{fed}}}\)</span></td>
<td>K_Fe(1:3)</td>
<td>iron half saturation constant</td>
<td>1.0, 0.2, 0.1</td>
<td><span class="math">\(\mu\)</span>mol/m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(op_{min}\)</span></td>
<td>op_dep_min</td>
<td>boundary for light attenuation</td>
<td>0.1</td>
<td>1</td>
</tr>
<tr class="row-odd"><td><span class="math">\(chlabs\)</span></td>
<td>chlabs(1:3)</td>
<td>light absorption length per chla conc.</td>
<td>0.03, 0.01, 0.05</td>
<td>1<span class="math">\(/\)</span>m<span class="math">\(/\)</span>(mg:math:<cite>/</cite>m<span class="math">\(^{3}\)</span>)</td>
</tr>
<tr class="row-even"><td><span class="math">\(\alpha\)</span></td>
<td>alpha2max_low(1:3)</td>
<td>light limitation factor</td>
<td>0.25, 0.25, 0.25</td>
<td>m<span class="math">\(^2\)</span>/W</td>
</tr>
<tr class="row-odd"><td><span class="math">\(\beta\)</span></td>
<td>beta2max(1:3)</td>
<td>light inhibition factor</td>
<td>0.018, 0.0025, 0.01</td>
<td>m<span class="math">\(^2\)</span>/W</td>
</tr>
<tr class="row-even"><td><span class="math">\(\mu_{max}\)</span></td>
<td>mu_max(1:3)</td>
<td>maximum algal growth rate</td>
<td>1.44, 0.851, 0.851</td>
<td>day<span class="math">\(^{-1}\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\mu_T\)</span></td>
<td>grow_Tdep(1:3)</td>
<td>temperature growth factor</td>
<td>0.06, 0.06, 0.06</td>
<td>day<span class="math">\(^{-1}\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(f_{sal}\)</span></td>
<td>fsal</td>
<td>salinity growth factor</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="row-odd"><td><span class="math">\(R_{si:n}\)</span></td>
<td>R_Si2N(1:3)</td>
<td>algal silicate to nitrogen</td>
<td>1.8, 0, 0</td>
<td>mol/mol</td>
</tr>
</tbody>
</table>
<p><span class="math">\(^a\)</span> only (1:2) of DOC and DOC parameters have physical meaning</p>
</div>
<div class="section" id="biogeochemistry-history-fields">
<span id="bgc-hist"></span><h6>2.2.6.5.1.3. Biogeochemistry History Fields<a class="headerlink" href="#biogeochemistry-history-fields" title="Permalink to this headline">¶</a></h6>
<p>The biogeochemical history fields specified in icefields_bgc_nml are
written when ‘x’ is replaced with a time interval: step (‘1’), daily
(‘d’), monthly (‘m’), or yearly (‘y’). Several of these flags turn on
multiple history variables according to the particular ecosystem
prescribed in <strong>ice_in</strong>. For example, biogeochemical fluxes from the
ice to ocean will be saved monthly in the history output if</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">f_fbio</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>
</pre></div>
</div>
<p>However, only the biogeochemical tracers which are active will be saved.
This includes at most fNit nitrate, fAm ammonium, fN algal nitrogen,
fDOC dissolved organic carbon, fDON dissolved organic nitrogen, fFep
particulate iron, fFed dissolved iron, fSil silicate, fhum humic matter,
fPON passive mobile tracer, fDMS DMS, fDMSPd dissolved DMSP and fDMSPp
particulate DMSP.</p>
<p><a class="reference internal" href="#tab-bio-history"><span class="std std-ref">Table 6</span></a> lists the
biogeochemical tracer history flags along with a short description and
the variable or variables saved. Not listed are flags appended with
_ai, i.e.&nbsp;f_fbio_ai. These fields are identical to their counterpart.
i.e.&nbsp;f_fbio, except they are averaged by ice area.</p>
<p><a class="reference internal" href="#tab-bio-history"><span class="std std-ref">Table 6</span></a> :<em>Biogeochemical History variables</em></p>
<span id="tab-bio-history"></span><table border="1" class="colwidths-given docutils" id="id128">
<caption><span class="caption-text">Table 6</span><a class="headerlink" href="#id128" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="15%" />
<col width="38%" />
<col width="31%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">History Flag</th>
<th class="head">Definition</th>
<th class="head">Variable(s)</th>
<th class="head">Units</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>f_faero_atm</td>
<td>atmospheric aerosol deposition flux</td>
<td>faero_atm</td>
<td>kg m<span class="math">\(^{-2}\)</span> s<span class="math">\(^{-1}\)</span></td>
</tr>
<tr class="row-odd"><td>f_faero_ocn</td>
<td>aerosol flux from ice to ocean</td>
<td>faero_ocn</td>
<td>kg m<span class="math">\(^{-2}\)</span> s<span class="math">\(^{-1}\)</span></td>
</tr>
<tr class="row-even"><td>f_aero</td>
<td>aerosol mass (snow and ice ssl and int)</td>
<td>aerosnossl, aerosnoint,aeroicessl, aeroiceint</td>
<td>kg/kg</td>
</tr>
<tr class="row-odd"><td>f_fbio</td>
<td>biological ice to ocean flux</td>
<td>fN, fDOC, fNit, fAm,fDON,fFep<span class="math">\(^a\)</span>, fFed<span class="math">\(^a\)</span>, fSil,fhum, fPON, fDMSPd,fDMS, fDMSPp, fzaero</td>
<td>mmol m<span class="math">\(^{-2}\)</span> s<span class="math">\(^{-1}\)</span></td>
</tr>
<tr class="row-even"><td>f_zaero</td>
<td>bulk z-aerosol mass fraction</td>
<td>zaero</td>
<td>kg/kg</td>
</tr>
<tr class="row-odd"><td>f_bgc_S</td>
<td>bulk z-salinity</td>
<td>bgc_S</td>
<td>ppt</td>
</tr>
<tr class="row-even"><td>f_bgc_N</td>
<td>bulk algal N concentration</td>
<td>bgc_N</td>
<td>mmol m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-odd"><td>f_bgc_C</td>
<td>bulk algal C concentration</td>
<td>bgc_C</td>
<td>mmol m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-even"><td>f_bgc_DOC</td>
<td>bulk DOC concentration</td>
<td>bgc_DOC</td>
<td>mmol m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-odd"><td>f_bgc_DON</td>
<td>bulk DON concentration</td>
<td>bgc_DON</td>
<td>mmol m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-even"><td>f_bgc_DIC</td>
<td>bulk DIC concentration</td>
<td>bgc_DIC</td>
<td>mmol m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-odd"><td>f_bgc_chl</td>
<td>bulk algal chlorophyll concentration</td>
<td>bgc_chl</td>
<td>mg chl m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-even"><td>f_bgc_Nit</td>
<td>bulk nitrate concentration</td>
<td>bgc_Nit</td>
<td>mmol m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-odd"><td>f_bgc_Am</td>
<td>bulk ammonium concentration</td>
<td>bgc_Am</td>
<td>mmol m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-even"><td>f_bgc_Sil</td>
<td>bulk silicate concentration</td>
<td>bgc_Sil</td>
<td>mmol m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-odd"><td>f_bgc_DMSPp</td>
<td>bulk particulate DMSP concentration</td>
<td>bgc_DMSPp</td>
<td>mmol m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-even"><td>f_bgc_DMSPd</td>
<td>bulk dissolved DMSP concentration</td>
<td>bgc_DMSPd</td>
<td>mmol m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-odd"><td>f_bgc_DMS</td>
<td>bulk DMS concentration</td>
<td>bgc_DMS</td>
<td>mmol m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-even"><td>f_bgc_Fe</td>
<td>bulk dissolved and particulate iron conc.</td>
<td>bgc_Fed, bgc_Fep</td>
<td><span class="math">\(\mu\,\)</span>mol m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-odd"><td>f_bgc_hum</td>
<td>bulk humic matter concentration</td>
<td>bgc_hum</td>
<td>mmol m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-even"><td>f_bgc_PON</td>
<td>bulk passive mobile tracer conc.</td>
<td>bgc_PON</td>
<td>mmol m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-odd"><td>f_upNO</td>
<td>Total algal <span class="math">\({\mbox{NO$_3$}}\)</span> uptake rate</td>
<td>upNO</td>
<td>mmol m<span class="math">\(^{-2}\)</span> d<span class="math">\(^{-1}\)</span></td>
</tr>
<tr class="row-even"><td>f_upNH</td>
<td>Total algal <span class="math">\({\mbox{NH$_4$}}\)</span> uptake rate</td>
<td>upNH</td>
<td>mmol m<span class="math">\(^{-2}\)</span> d<span class="math">\(^{-1}\)</span></td>
</tr>
<tr class="row-odd"><td>f_bgc_ml</td>
<td>upper ocean tracer concentrations</td>
<td>ml_N, ml_DOC, ml_Nit,ml_Am, ml_DON, ml_Fep<span class="math">\(^b\)</span>,ml_Fed<span class="math">\(^b\)</span>, ml_Sil, ml_hum, ml_PON,ml_DMS, ml_DMSPd, ml_DMSPp</td>
<td>mmol m<span class="math">\(^{-3}\)</span></td>
</tr>
<tr class="row-even"><td>f_bTin</td>
<td>ice temperature on the bio grid</td>
<td>bTizn</td>
<td><span class="math">\(^o\)</span>C</td>
</tr>
<tr class="row-odd"><td>f_bphi</td>
<td>ice porosity on the bio grid</td>
<td>bphizn</td>
<td>%</td>
</tr>
<tr class="row-even"><td>f_iDin</td>
<td>brine eddy diffusivity on the interface bio grid</td>
<td>iDin</td>
<td>m<span class="math">\(^{2}\)</span> d<span class="math">\(^{-1}\)</span></td>
</tr>
<tr class="row-odd"><td>f_iki</td>
<td>ice permeability on the interface bio grid</td>
<td>ikin</td>
<td>mm<span class="math">\(^{2}\)</span></td>
</tr>
<tr class="row-even"><td>f_fbri</td>
<td>ratio of brine tracer height to ice thickness</td>
<td>fbrine</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>f_hbri</td>
<td>brine tracer height</td>
<td>hbrine</td>
<td>m</td>
</tr>
<tr class="row-even"><td>f_zfswin</td>
<td>internal ice PAR on the interface bio grid</td>
<td>zfswin</td>
<td>W m<span class="math">\(^{-2}\)</span></td>
</tr>
<tr class="row-odd"><td>f_bionet</td>
<td>brine height integrated tracer concentration</td>
<td>algalN_net, algalC_net, chl_net, pFe<span class="math">\(^c\)</span>_net, dFe<span class="math">\(^c\)</span>_net, Sil_net, Nit_net, Am_net, hum_net, PON_net, DMS_net, DMSPd_net, DMSPp_net, DOC_net, zaero_net, DON_net</td>
<td>mmol m<span class="math">\(^{-2}\)</span></td>
</tr>
<tr class="row-even"><td>f_biosnow</td>
<td>snow integrated tracer concentration”</td>
<td>algalN_snow, algalC_snow,chl_snow, pFe<span class="math">\(^c\)</span>_snow, dFe<span class="math">\(^c\)</span>_snow,Sil_snow, Nit_snow, Am_snow, hum_snow, PON_snow, DMS_snow, DMSPd_snow, DMSPp_snow, DOC_snow, zaero_snow, DON_snow</td>
<td>mmol m<span class="math">\(^{-2}\)</span></td>
</tr>
<tr class="row-odd"><td>f_grownet</td>
<td>Net specific algal growth rate</td>
<td>grow_net</td>
<td>m d<span class="math">\(^{-1}\)</span></td>
</tr>
<tr class="row-even"><td>f_PPnet</td>
<td>Net primary production</td>
<td>PP_net</td>
<td>mgC m<span class="math">\(^{-2}\)</span> d<span class="math">\(^{-1}\)</span></td>
</tr>
<tr class="row-odd"><td>f_algalpeak</td>
<td>interface bio grid level of peak chla</td>
<td>peak_loc</td>
<td>1</td>
</tr>
<tr class="row-even"><td>f_zbgc_frac</td>
<td>mobile fraction of tracer</td>
<td>algalN_frac, chl_frac, pFe_frac,dFe_frac, Sil_frac, Nit_frac,Am_frac, hum_frac, PON_frac,DMS_frac, DMSPd_frac, DMSPp_frac,DOC_frac, zaero_frac, DON_frac</td>
<td>1</td>
</tr>
</tbody>
</table>
<p><span class="math">\(^a\)</span> units are <span class="math">\(\mu\)</span>mol m<span class="math">\(^{-2}\)</span> s<span class="math">\(^{-1}\)</span></p>
<p><span class="math">\(^b\)</span> units are <span class="math">\(\mu\)</span>mol m<span class="math">\(^{-3}\)</span></p>
<p><span class="math">\(^c\)</span> units are <span class="math">\(\mu\)</span>mol m<span class="math">\(^{-2}\)</span></p>
</div>
</div>
</div>
<div class="section" id="flux-corrected-positive-definite-transport-scheme">
<span id="tracer-numerics"></span><h4>2.2.6.6. Flux-Corrected, Positive Definite Transport Scheme<a class="headerlink" href="#flux-corrected-positive-definite-transport-scheme" title="Permalink to this headline">¶</a></h4>
<p>Numerical solution of the vertical tracer transport equation is
accomplished using the finite element Galerkin discretization. Multiply
[eqn:mobile_transport] by “w” and integrate by parts</p>
<div class="math">
\[\begin{split}\begin{aligned}
&amp; &amp; \int_{h}\left[ w\frac{\partial C}{\partial t} -   \frac{\partial
    w}{\partial x} \left(-\left[\frac{v}{h} + \frac{w_f}{h\phi}\right]C + \frac{D_{in}}{\phi^2}\frac{\partial
      \phi}{\partial x}C  -  \frac{D_{in}}{\phi}\frac{\partial C}{\partial
      x} \right) \right]dx \nonumber \\
&amp; + &amp;  w\left.\left(
    -\left[\frac{1}{h}\frac{dh_b}{dt}+  \frac{w_f}{h\phi}\right]C + \frac{D_{in}}{\phi^2}\frac{\partial \phi}{\partial
    x}C -\frac{D_{in}}{\phi}\frac{\partial C}{\partial
    x}\right)\right|_{bottom} + w\left[\frac{1}{h}\frac{dh_t}{dt} +
\frac{w_f}{h\phi}\right]C|_{top}  =  0\end{aligned}\end{split}\]</div>
<p>The bottom boundary condition indicated by <span class="math">\(|_{bottom}\)</span> satisfies</p>
<div class="math">
\[\begin{split}\begin{aligned}
-w\left.\left(
    -\left[\frac{1}{h}\frac{dh_b}{dt}+  \frac{w_f}{h\phi}\right]C + \frac{D_{in}}{\phi^2}\frac{\partial \phi}{\partial
    x}C -\frac{D_{in}}{\phi}\frac{\partial C}{\partial
    x}\right)\right|_{bottom} &amp; = &amp; \nonumber \\
 w\left[\frac{1}{h}\frac{dh_b}{dt} +
\frac{w_f}{h \phi_{N+1}}\right](C_{N+2} \mbox{ or }C_{N+1}) -
w\frac{D_{in}}{\phi_{N+1}(\Delta h+g_o)}\left(C_{N+1} - C_{N+2}\right) &amp; &amp; \end{aligned}\end{split}\]</div>
<p>where <span class="math">\(C_{N+2} = h\phi_{N+1}[c]_{ocean}\)</span> and <span class="math">\(w = 1\)</span> at the
bottom boundary and the top. The component <span class="math">\(C_{N+2}\)</span> or
<span class="math">\(C_{N+1}\)</span> depends on the sign of the advection boundary term. If
<span class="math">\(dh_b + w_f/\phi &gt; 0\)</span> then use <span class="math">\(C_{N+2}\)</span> otherwise
<span class="math">\(C_{N+1}\)</span>.</p>
<p>Define basis functions as linear piecewise, with two nodes (boundary
nodes) in each element. Then for <span class="math">\(i &gt; 1\)</span> and <span class="math">\(i &lt; N+1\)</span></p>
<div class="math">
\[\begin{split}\begin{aligned}
w_i(x) &amp; = &amp; \left\{ \begin{array}{llll}
0 &amp; x &lt; x_{i-1} \\
(x - x_{i-1})/\Delta &amp; x_{i-1}&lt; x \leq x_{i} \\
1 - (x-x_i)/\Delta &amp; x_i \leq x &lt; x_{i+1} \\
0, &amp; x \geq x_{i+1}
\end{array}
\right.\end{aligned}\end{split}\]</div>
<p>For <span class="math">\(i=1\)</span></p>
<div class="math">
\[\begin{split}\begin{aligned}
w_1(x) &amp; = &amp; \left\{ \begin{array}{ll}
1 - x/\Delta &amp; x &lt; x_{2} \\
0, &amp; x \geq x_{2}
\end{array}
\right.\end{aligned}\end{split}\]</div>
<p>and <span class="math">\(i = N+1\)</span></p>
<div class="math">
\[\begin{split}\begin{aligned}
w_{N+1}(x) &amp; = &amp; \left\{ \begin{array}{ll}
0, &amp; x &lt; x_{N} \\
(x-x_{N})/\Delta &amp; x \geq x_{N}
\end{array}
\right.\end{aligned}\end{split}\]</div>
<p>Now assume a form</p>
<div class="math">
\[C_h =  \sum_j^{N+1} c_j w_j\]</div>
<p>Then</p>
<div class="math">
\[\begin{split}\begin{aligned}
\int_h C_h dx &amp; = &amp; c_1\int_0^{x_{2}}\left(1-\frac{x}{\Delta}\right)dx
  +  c_{N+1}\int_{x_N}^{x_{N+1}}\frac{x-x_{N}}{\Delta}dx  \nonumber \\
&amp; + &amp;
  \sum_{j=2}^{N}c_j\left\{\int_{j-1}^{j}\frac{x-x_{j-1}}{\Delta}dx +
    \int_{j}^{j+1}\left[1 - \frac{(x-x_j)}{\Delta}\right]dx\right\}
  \nonumber \\
&amp; = &amp; \Delta \left[\frac{c_1}{2} + \frac{c_{N+1}}{2} + \sum_{j = 2}^{N}c_{j}\right]\end{aligned}\end{split}\]</div>
<p>Now this approximate solution form is substituted into the variational
equation with <span class="math">\(w = w_h \in \{w_j\}\)</span></p>
<div class="math">
\[\begin{split}\begin{aligned}
0 &amp;= &amp; \int_{h}\left[ w_h\frac{\partial C_h}{\partial t} -   \frac{\partial
    w_h}{\partial x} \left(\left[-\frac{v}{h} - \frac{w_f}{h\phi}+ \frac{D_{in}}{\phi^2}\frac{\partial
      \phi}{\partial x}\right]C_h  -  \frac{D_{in}}{\phi}\frac{\partial C_h}{\partial
      x} \right) \right]dx \nonumber \\
&amp; + &amp;  w_h\left.\left(
    -\left[\frac{1}{h}\frac{dh_b}{dt}+  \frac{w_f}{h\phi}\right]C_h + \frac{D_{in}}{\phi^2}\frac{\partial \phi}{\partial
    x}C -\frac{D_{in}}{\phi}\frac{\partial C_h}{\partial
    x}\right)\right|_{bottom} + w_h\left[\frac{1}{h}\frac{dh_t}{dt} +
\frac{w_f}{h\phi}\right]C_h|_{top} \end{aligned}\end{split}\]</div>
<p>The result is a linear matrix equation</p>
<div class="math">
\[M_{jk}\frac{\partial C_k(t)}{\partial t} = [K_{jk}+S_{jk}] C_k(t) + q_{in}\]</div>
<p>where</p>
<div class="math">
\[\begin{split}\begin{aligned}
M_{jk} &amp; = &amp; \int_h w_j(x)w_k(x)dx \nonumber \\
K_{jk} &amp; = &amp; \left[-\frac{v}{h} - \frac{w_f}{h\phi}+ \frac{D_{in}}{\phi^2}\frac{\partial
      \phi}{\partial x}\right]\int_h \frac{\partial w_j}{\partial x}
  w_k dx \nonumber \\
&amp;-&amp;
\left. w_j\left(-\left[\frac{v}{h} + \frac{w_f}{h\phi_k}\right]w_k +
    \frac{D_{in}}{\phi^2}\frac{\partial \phi_k}{\partial x} w_k - \frac{D_{in}}{\phi_k}\frac{\partial w_k}{\partial
      x}\right)\right|_{bot} \nonumber \\
&amp; = &amp; -V_k\int_h \frac{\partial w_j}{\partial x} w_k dx -
\left. w_j\left(-V_kw_k - \frac{D_{in}}{\phi_k}\frac{\partial w_k}{\partial
      x}\right)\right|_{bot} \nonumber \\
S_{jk} &amp; = &amp; -\frac{D_{in}}{\phi_k}\int_h \frac{\partial w_j}{\partial x} \cdot
\frac{\partial w_k}{\partial x}dx \nonumber \\
q_{in} &amp; = &amp; -V C_{t} w_j(x)|_{t}\end{aligned}\end{split}\]</div>
<p>And <span class="math">\(C_{N+2} = h\phi_{N+1}[c]_{ocean}\)</span></p>
<p>For the top condition <span class="math">\(q_{in}\)</span> is applied to the upper value
<span class="math">\(C_2\)</span> when <span class="math">\(VC_t &lt; 0\)</span>, i.e. <span class="math">\(q_{in}\)</span> is a source.</p>
<p>Compute the <span class="math">\(M_{jk}\)</span> integrals:</p>
<div class="math">
\[\begin{split}\begin{aligned}
M_{jj} &amp; = &amp; \int_{x_{j-1}}^{x_j}\frac{(x- x_{j-1})^2}{\Delta^2}dx +
\int_{x_{j}}^{x_{j+1}}\left[ 1-\frac{(x- x_{j})}{\Delta}\right]^2dx =
\frac{2\Delta}{3} \ \ \ \mbox{for }1 &lt; j &lt; N+1 \nonumber \\
M_{11} &amp; = &amp; \int_{x_{1}}^{x_{2}}\left[ 1-\frac{(x- x_{2})}{\Delta}\right]^2dx =
\frac{\Delta}{3}   \nonumber \\
M_{N+1,N+1} &amp; = &amp;\int_{x_{N}}^{x_{N+1}}\frac{(x- x_{N})^2}{\Delta^2}dx
= \frac{\Delta}{3}\nonumber \end{aligned}\end{split}\]</div>
<p>Off diagonal components:</p>
<div class="math">
\[\begin{split}\begin{aligned}
M_{j,j+1} &amp; = &amp;  \int_{x_{j}}^{x_{j+1}}\left[1 - \frac{(x-
    x_{j})}{\Delta}\right]\left[ \frac{x-x_{j}}{\Delta}\right]dx =
\frac{\Delta}{6} \ \ \ \mbox{for }j &lt; N+1 \nonumber \\
M_{j,j-1} &amp; = &amp;  \int_{x_{j-1}}^{x_{j}}\left[ \frac{x-x_{j-1}}{\Delta}\right]\left[1 - \frac{(x-
    x_{j-1})}{\Delta}\right]dx =
\frac{\Delta}{6} \ \ \ \mbox{for }j &gt; 1 \nonumber \\\end{aligned}\end{split}\]</div>
<p>Compute the <span class="math">\(K_{jk}\)</span> integrals:</p>
<div class="math">
\[\begin{split}\begin{aligned}
K_{jj} &amp;=&amp; k'_{jj}\left[ \int_{x_{j-1}}^{x_j} \frac{\partial w_j}{\partial x}
w_j dx + \int_{x_{j}}^{x_{j+1}} \frac{\partial w_j}{\partial x}
w_j dx \right] \nonumber \\
&amp;  = &amp;  \frac{1}{2} + -\frac{1}{2} = 0  \ \ \ \mbox{for } 1 &lt; j &lt; N+1 \nonumber \\
K_{11} &amp; = &amp;  -\frac{k'_{11}}{2} = \frac{1}{2}\left[\frac{v}{h} +
  \frac{w_f}{h\phi}\right] \nonumber \\
K_{N+1,N+1}  &amp; = &amp; \frac{k'_{N+1,N+1}}{2} +\min\left[0, \left(\frac{1}{h}\frac{dh_b}{dt} +
\frac{w_f}{h \phi_{N+1}}\right)\right] -
\frac{D_{in}}{\phi_{N+1}(g_o/h)} \nonumber \\
&amp; = &amp; \left[-\frac{v}{h} - \frac{w_f}{h\phi}+ \frac{D_{in}}{\phi^2}\frac{\partial
      \phi}{\partial x}\right]\frac{1}{2} +\min\left[0, \left(\frac{1}{h}\frac{dh_b}{dt} +
\frac{w_f}{h \phi_{N+1}}\right)\right] -
\frac{D_{in}}{\phi_{N+1}(g_o/h)} \end{aligned}\end{split}\]</div>
<p>Off diagonal components:</p>
<div class="math">
\[\begin{split}\begin{aligned}
K_{j(j+1)} &amp;=&amp; k'_{j(j+1)}\int_{x_{j}}^{x_{j+1}} \frac{\partial w_j}{\partial x}
w_{j+1} dx  =
-k'_{j(j+1)}\int_{x_{j}}^{x_{j+1}}\frac{(x-x_j)}{\Delta^2}dx \nonumber
\\
&amp; = &amp; -\frac{k'_{j(j+1)}}{\Delta^2}\frac{\Delta^2}{2} =
-\frac{k'_{j(j+1)}}{2}  = p5*\left[\frac{v}{h} + \frac{w_f}{h\phi}- \frac{D_{in}}{\phi^2}\frac{\partial
      \phi}{\partial x}\right]_{(j+1)} \ \ \ \mbox{for }  j &lt; N+1 \nonumber \\
K_{j(j-1)} &amp;=&amp; k'_{j(j-1)}\int_{x_{j-1}}^{x_{j}} \frac{\partial w_j}{\partial x}
w_{j-1} dx  =
k'_{j(j-1)}\int_{x_{j-1}}^{x_{j}}\left[1 -
  \frac{(x-x_{j-1})}{\Delta^2}\right] dx \nonumber
\\
&amp; = &amp; \frac{k'_{j(j-1)}}{\Delta^2}\frac{\Delta^2}{2} =
\frac{k'_{j(j-1)}}{2}  = -p5*\left[\frac{v}{h} + \frac{w_f}{h\phi}- \frac{D_{in}}{\phi^2}\frac{\partial
      \phi}{\partial x}\right]_{(j-1)} \ \ \ \ \ \mbox{for }  j &gt; 1 \end{aligned}\end{split}\]</div>
<p>for <span class="math">\(K_{N+1,N}\)</span>, there’s a boundary contribution .</p>
<div class="math">
\[K_{N+1,N} = \frac{k'_{N+1(N)}}{2} - \frac{D_N}{\Delta \phi_{N}}\]</div>
<p>Note. The bottom condition works if <span class="math">\(C_{bot} = h
\phi_{N+2}[c]_{ocean}\)</span>, <span class="math">\(\phi^2\)</span> is <span class="math">\(\phi_{N+1}\phi_{N+2}\)</span>
and</p>
<div class="math">
\[\begin{aligned}
\left. \frac{\partial \phi}{\partial x}\right|_{bot} &amp; = &amp;
\frac{\phi_{N+2} - \phi_{N}}{2\Delta}\end{aligned}\]</div>
<p>Then the <span class="math">\(D_{N+1}/\phi_{N+1}/\Delta\)</span> cancels properly with the
porosity gradient. In general</p>
<div class="math">
\[\begin{aligned}
\left. \frac{\partial \phi}{\partial x}\right|_{k} &amp; = &amp;
\frac{\phi_{k+2} - \phi_{k}}{2\Delta}\end{aligned}\]</div>
<p>When evaluating the integrals for the diffusion term, we will assume
that <span class="math">\(D/\phi\)</span> is constant in an element. For <span class="math">\(D_{in}/i\phi\)</span>
defined on interface points, <span class="math">\(D_1 = 0\)</span> for <span class="math">\(j = 2,...,N\)</span>
<span class="math">\(D_j/b\phi_j = (D_{in}(j) + D_{in}(j+1))/(i\phi_j + i\phi_{j+1})\)</span>.
Then the above integrals will be modified as follows:</p>
<p>Compute the <span class="math">\(S_{jk}\)</span> integrals:</p>
<div class="math">
\[\begin{split}\begin{aligned}
S_{jj} &amp; = &amp; - \left[\frac{D_{j-1}}{b\phi_{j-1}} \int_{x_{j-1}}^{x_j}\left( \frac{\partial
      w_j}{\partial x}\right)^2 dx + \frac{D_{j}}{b\phi_{j}} \int_{x_{j}}^{x_{j+1}}
  \left(\frac{\partial w_j}{\partial x}\right)^2 dx \right] \nonumber
\\
&amp; = &amp; -\frac{1}{\Delta}\left[\frac{D_{j-1}}{b\phi_{j-1}} + \frac{D_{j}}{b\phi{j}}\right]\ \ \mbox{for }1 &lt; j &lt; N+1 \nonumber \\
S_{11} &amp; = &amp; \frac{s'_{11}}{\Delta}  = 0 \nonumber \\
S_{N+1,N+1} &amp; = &amp; \frac{s'_{N+1,N+1}}{\Delta} = -\frac{(D_{N})}{b\phi_{N}\Delta}\end{aligned}\end{split}\]</div>
<p>Compute the off-diagonal components of <span class="math">\(S_{jk}\)</span>:</p>
<div class="math">
\[\begin{split}\begin{aligned}
S_{j(j+1)} &amp; = &amp; s'_{j(j+1)}\int_{x_j}^{x_{j+1}}\frac{\partial
  w_j}{\partial x} \frac{\partial w_{j+1}}{\partial x} dx =
-\frac{s'_{j(j+1)}}{\Delta} =
\frac{D_{j}}{b\phi_{j}\Delta} \ \ \ \mbox{for } j &lt; N+1
\nonumber \\
S_{j(j-1)} &amp; = &amp; s'_{j(j-1)}\int_{x_{j-1}}^{x_{j}}\frac{\partial
  w_j}{\partial x} \frac{\partial w_{j-1}}{\partial x} dx =
-\frac{s'_{j(j-1)}}{\Delta} =
\frac{D_{j-1}}{b\phi_{j-1}} \ \ \ \mbox{for } j &gt; 1\end{aligned}\end{split}\]</div>
<p>We assume that <span class="math">\(D/\phi^2 \partial \phi/\partial x\)</span> is constant in
the element <span class="math">\(i\)</span>. If <span class="math">\(D/\phi_j\)</span> is constant, and
<span class="math">\(\partial \phi/\partial x\)</span> is constant then both the Darcy and
<span class="math">\(D\)</span> terms go as <span class="math">\(\phi^{-1}\)</span>. Then <span class="math">\(\phi = (\phi_j -
\phi_{j-1})(x-x_j)/\Delta + \phi_j\)</span> and <span class="math">\(m = (\phi_j -
\phi_{j-1})/\Delta\)</span> and <span class="math">\(b = \phi_j - mx_j\)</span>.</p>
<p>The first integral contribution to the Darcy term is:</p>
<div class="math">
\[\begin{split}\begin{aligned}
K^1_{jj} &amp; = &amp;
\frac{-1}{\Delta ^2}\left(\frac{w_f}{h}-\frac{D}{\phi}\frac{\partial
    \phi}{\partial x}\right)\int_{j-1}^{j}(x-x_{j-1})\frac{1}{mx
  + b}dx \nonumber \\
&amp; = &amp;-\left(\frac{w_f}{h}-\frac{D}{\phi}\frac{\partial
    \phi}{\partial x}\right) \frac{1}{\Delta^2}\left[ \int_{j-1}^{j}\frac{x}{mx + b}dx - x_{j-1}\int_{j-1}^{j}\frac{1}{mx
  + b}dx  \right] \nonumber \\
&amp; = &amp;- \left(\frac{w_f}{h}-\frac{D}{\phi}\frac{\partial
    \phi}{\partial x}\right) \frac{1}{\Delta^2}\left[ \frac{mx - b\log(b + mx)}{m^2} -
  x_{j-1}\frac{\log(b+mx)}{m}\right]^{x_j}_{x_{j-1}} \nonumber \\
&amp; = &amp; -\left(\frac{w_f}{h}-\frac{D}{\phi}\frac{\partial
    \phi}{\partial x}\right)\frac{1}{\Delta_{\phi}}\left[ 1 + \log \left( \frac{\phi_j}{\phi_{j-1}} \right) -
  \frac{\phi_j}{\Delta_{\phi_j}}\log \left(
    \frac{\phi_j}{\phi_{j-1}} \right)\right] \nonumber \\
&amp; = &amp; -\left(\frac{w_f}{h}-\frac{D}{\phi}\frac{\partial
    \phi}{\partial x}\right)\frac{1}{\Delta_{\phi}}\left[ 1 +  \frac{\phi_{j-1}}{\Delta_{\phi}}\log \left( \frac{\phi_j}{\phi_{j-1}} \right) \right]\end{aligned}\end{split}\]</div>
<div class="math">
\[\begin{split}\begin{aligned}
K^2_{jj} &amp; = &amp; \left(\frac{w_f}{h}-\frac{D}{\phi}\frac{\partial
    \phi}{\partial x}\right)\frac{1}{\Delta}\int_{x_{j}}^{x_{j+1}}\left[1 -
  \frac{(x-x_{j})}{\Delta}\right]\frac{1}{mx+b} dx \nonumber \\
&amp; = &amp; \left(\frac{w_f}{h}-\frac{D}{\phi}\frac{\partial
    \phi}{\partial x}\right)\frac{1}{\Delta}\left[\frac{
    (b+m(x_j+\Delta))\log(b+mx)-mx}{\Delta
    m^2}\right]_{x_{j}}^{x_{j+1}} \nonumber \\
&amp; = &amp; \left(\frac{w_f}{h}-\frac{D}{\phi}\frac{\partial
    \phi}{\partial x}\right)\frac{1}{\Delta_{\phi}}\left[ 1 -  \frac{\phi_{j+1}}{\Delta_{\phi}}\log \left( \frac{\phi_{j+1}}{\phi_{j}} \right) \right]\end{aligned}\end{split}\]</div>
<p>Now <span class="math">\(m = (\phi_{j+1}-\phi_{j})/\Delta\)</span> and
<span class="math">\(b = \phi_{j+1} -
mx_{j+1}\)</span>.</p>
<p>Source terms <span class="math">\(q_{bot} = q_{N+1}\)</span> and <span class="math">\(q_{top} = q_{1}\)</span> (both
positive)</p>
<div class="math">
\[\begin{split}\begin{aligned}
q_{bot} &amp; = &amp;\max\left[0, \left(\frac{1}{h}\frac{dh_b}{dt} +
\frac{w_f}{h \phi_{N+1}}\right)\right]C|_{bot} +
\frac{D_{in}}{\phi_{N+1}(g_o/h)}C|_{bot} \nonumber \\
  C|_{bot}&amp;= &amp; \phi_{N+1}[c]_{ocean}\end{aligned}\end{split}\]</div>
<p>where <span class="math">\(g_o\)</span> is not zero.</p>
<div class="math">
\[\begin{split}\begin{aligned}
q_{in}&amp;  = &amp; -\min\left[ 0, \left(\frac{1}{h}\frac{dh_t}{dt} +
\frac{w_f}{h\phi}\right)C|_{top} \right]  \nonumber \\
C|_{top}&amp; = &amp; h [c]_o\phi_{min}\end{aligned}\end{split}\]</div>
<p>Calculating the low order solution: 1) Find the lumped mass matrix
<span class="math">\(M_l = diag\{m_i\}\)</span></p>
<div class="math">
\[\begin{split}\begin{aligned}
m_j &amp; = &amp; \sum_i m_{ji} = m_{j(j+1)} + m_{j(j-1)} + m_{jj} \\
 &amp; = &amp; \frac{\Delta}{6} + \frac{\Delta}{6} + \frac{2\Delta}{3} =
 \Delta \ \ \ \mbox{for }1 &lt; j &lt; N+1 \\
m_1 &amp; = &amp; m_{11} + m_{12} = \frac{\Delta}{3} + \frac{\Delta}{6} =
\frac{\Delta}{2} \\
m_{N+1} &amp; = &amp; m_{N+1,N} + m_{N+1,N+1} = \frac{\Delta}{6} + \frac{\Delta}{3} =
\frac{\Delta}{2}\end{aligned}\end{split}\]</div>
<ol class="arabic simple" start="2">
<li>Define artificial diffusion <span class="math">\(D_a\)</span></li>
</ol>
<div class="math">
\[\begin{split}\begin{aligned}
d_{j,(j+1)} &amp; = &amp; \max\{ -k_{j(j+1)},0,-k_{(j+1)j}\} = d_{(j+1)j} \\
d_{jj} &amp; = &amp; -\sum_{i\neq j} d_{ji}\end{aligned}\end{split}\]</div>
<p>3) Add artificial diffusion to <span class="math">\(K\)</span>: <span class="math">\(L = K + D_a\)</span>. 4) Solve
for the low order predictor solution:</p>
<div class="math">
\[(M_l -\Delta t [L+S])C^{n+1} = M_l C^{n} + \Delta t q\]</div>
<p>Conservations terms for the low order solution are:</p>
<div class="math">
\[\begin{split}\begin{aligned}
\int \left[C^{n+1} -C^{n}\right] w(x)dx &amp; = &amp;
 \Delta \left[\frac{c^{n+1}_1-c^{n}_1}{2} +
   \frac{c^{n+1}_{N+1}-c^{n}_{N+1}}{2} + \sum_{j =
     2}^{N}(c^{n+1}_{j}-c^{n}_{j})\right] \nonumber \\
&amp;  = &amp;   \Delta t \left[ q_{bot} +
q_{in} + (K_{N+1,N+1}+ K_{N,N+1} )C^{n+1}_{N+1} + (K_{1,1} +
K_{2,1})C^{n+1}_{1}\right]  \nonumber \end{aligned}\end{split}\]</div>
<p>Now add the antidiffusive flux: 1) compute the F matrix using the low
order solution <span class="math">\(c^{n+1}\)</span>. Diagonal components are zero. For
<span class="math">\(i \neq j\)</span></p>
<div class="math">
\[\begin{aligned}
f_{ij} &amp; = &amp; m_{ij}\left[\frac{\Delta c_i}{\Delta t} - \frac{\Delta
    c_j}{\Delta t} + d_{ij}(c^{n+1}_i - c^{n+1}_j\right]\end{aligned}\]</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">2. Science Guide</a><ul>
<li><a class="reference internal" href="#coupling-with-host-models">2.1. Coupling with host models</a><ul>
<li><a class="reference internal" href="#the-column-physics-code-interface">2.1.1. The column physics code interface</a></li>
<li><a class="reference internal" href="#atmosphere-and-ocean-boundary-forcing">2.1.2. Atmosphere and ocean boundary forcing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#model-components">2.2. Model components</a><ul>
<li><a class="reference internal" href="#tracers">2.2.1. Tracers</a></li>
<li><a class="reference internal" href="#transport-in-thickness-space">2.2.2. Transport in thickness space</a></li>
<li><a class="reference internal" href="#mechanical-redistribution">2.2.3. Mechanical redistribution</a></li>
<li><a class="reference internal" href="#thermodynamics">2.2.4. Thermodynamics</a></li>
<li><a class="reference internal" href="#biogeochemistry-ech">2.2.5. Biogeochemistry - ECH</a></li>
<li><a class="reference internal" href="#biogeochemistry-nj">2.2.6. Biogeochemistry - NJ</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="icepack_1_introduction.html"
                        title="previous chapter">1. Introduction - Icepack</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="icepack_3_user_guide.html"
                        title="next chapter">3. User Guide</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/icepack_2_science_guide.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="icepack_3_user_guide.html" title="3. User Guide"
             >next</a></li>
        <li class="right" >
          <a href="icepack_1_introduction.html" title="1. Introduction - Icepack"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CICE-Consortium Icepack 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Los Alamos National Security, LLC (code) and National Center for Atmospheric Research (documentation).
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>